(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{548:function(e,t,n){},549:function(e,t,n){"use strict";n.r(t);var r=n(316),c=n.n(r),i=n(0),a=n.n(i),o=n(21),s=n.n(o),l=n(93),d=n(35),u=n(75),j=n(622),h=n(31),b=n(12),f=n(51),p=(n(300),n(15)),x=n(185),O={apiKey:"AIzaSyB8jzc6Gck2Rt-rrw-ZbACudr5VqESRNRY",authDomain:"reusing-intent.firebaseapp.com",projectId:"reusing-intent",storageBucket:"reusing-intent.appspot.com",messagingSenderId:"290275127628",appId:"1:290275127628:web:e332ddfe7bada09cff5fe9",measurementId:"G-K9KB7W1VM3"};function m(e,t){var n=e.root,r=t[t.length-1],c={};return c[e.root]=e.nodes[e.root],t.forEach((function(t,r,i){var a=e.nodes[t];if(Object(h.isChildNode)(a))if(0===r)a.parent=n,c[n].children=[],c[n].children.push(t);else{var o=i[r-1];a.parent=o,c[o].children=[],c[o].children.push(t)}c[t]=a})),{current:r,root:n,nodes:c}}var g=n(24),v=n(53),y=function(){function e(t){Object(f.a)(this,e),this.rootStore=void 0,this.updatedActions=void 0,this.rootStore=t,Object(p.makeAutoObservable)(this)}return Object(v.a)(e,[{key:"compDataset",get:function(){return this.rootStore.projectStore.currentComparisonDatasets[1]}},{key:"selectedPointsComparison",get:function(){var e=this.rootStore.exploreStore.selectedPoints;return Array.from(new Set(e))}},{key:"updatedFilterPoints",get:function(){return this.rootStore.exploreStore.filteredPoints}},{key:"isBelowCurrent",value:function(e,t){var n=this.rootStore.exploreStore.provenance.graph;if(0===n.nodes[t].children.length||e===t)return!1;if(n.nodes[t].children.includes(e))return!0;var r,c=!1,i=Object(g.a)(n.nodes[t].children);try{for(i.s();!(r=i.n()).done;){var a=r.value;c||(c=this.isBelowCurrent(e,a))}}catch(o){i.e(o)}finally{i.f()}return c}}]),e}(),k=n(28),w=n(60),S=n.n(w);var C=function(e){return JSON.parse(JSON.stringify(e))};function D(){return"plot".concat((new Date).getTime().toString())}var N="https://reusing.sci.utah.edu";var M=function(){function e(t){var n=this;Object(f.a)(this,e),this.rootStore=void 0,this.isLoadingData=!1,this.isLoadingPredictions=!1,this.hoveredPrediction=null,this.multiBrushBehaviour="Union",this.showCategories=!1,this.brushType="Rectangular",this.stateRecord={},this.isComparison=!1,this.predictions=[],this.currBrushed=[],this.workflows={},this.currentWorkflow=null,this.workflowSyncStatus={},this.isImporting=!1,this.updateBrushed=function(e){n.currBrushed=e},this.addWorkflow=function(e){var t=Object.values(n.workflows).filter((function(e){return e.name.startsWith("Workflow #")})),r=1;if(t.length>0){var c=t[t.length-1].name.split("#");r=parseInt(c[c.length-1])+1}var i={id:"workflow".concat((new Date).getTime().toString()),project:n.currentProject.key,name:e||"Workflow #".concat(r),graph:[]};n.workflows[i.id]=i,n.currentWorkflow=i.id},this.renameWorkflow=function(e,t){n.workflows[e].name=t},this.removeWorkflow=function(e){if(delete n.workflows[e],n.currentWorkflow===e&&Object.values(n.workflows).length>0){var t=Object.values(n.workflows);n.currentWorkflow=t[t.length-1].id}else n.workflows[e]||(n.currentWorkflow=null)},this.setCurrentWorkflow=function(e){n.currentWorkflow=e},this.addToWorkflow=function(e){if(n.currentWorkflow&&n.workflows[n.currentWorkflow]){var t=n.workflows[n.currentWorkflow].graph;if(!t.includes(e)){for(var r=n.provenance.graph.nodes[e];"Root"!==r.label&&Object(h.isChildNode)(r);)t.includes(r.id)||t.push(r.id),r=n.provenance.graph.nodes[r.parent];t.sort((function(e,t){return(n.provenance.graph.nodes[e].metadata.createdOn||-1)-(n.provenance.graph.nodes[t].metadata.createdOn||-1)})),n.workflows[n.currentWorkflow].graph=Object(k.a)(t)}}},this.removeFromWorkflow=function(e){n.currentWorkflow&&(n.workflows[n.currentWorkflow].graph=n.workflows[n.currentWorkflow].graph.filter((function(t){return t!==e})))},this.setSyncStatus=function(e,t){n.workflowSyncStatus[e]=t},this.addPlot=function(e){if(n.currentDatasetKey){var t=n.rootStore.actions.addPlotAction;t.setLabel("Add Plot");var r=n.state;n.provenance.apply(t(e)),r.plots[e.id]=e,n.stateRecord[n.currentNode]=r,n.rootStore.currentNodes.push(n.provenance.graph.current)}},this.removePlot=function(e){var t=n.rootStore.actions.removePlotAction;t.setLabel("Remove plot: ".concat(e.x," - ").concat(e.y));var r=n.state;n.provenance.apply(t(e)),delete r.plots[e.id],e.id in r.brushes&&delete r.brushes[e.id],e.id in r.pointSelection&&delete r.pointSelection[e.id],n.stateRecord[n.currentNode]=r,n.rootStore.currentNodes.push(n.provenance.graph.current)},this.filter=function(e){var t=n.rootStore.actions.filterAction;t.setLabel("Filter: ".concat(e));var r=n.state,c={type:e,points:n.selectedPoints};n.provenance.apply(t(e)),r.brushes={},r.brushSelections={},r.pointSelection={},r.prediction=null,r.filter=c,n.stateRecord[n.currentNode]=r,n.rootStore.currentNodes.push(n.provenance.graph.current)},this.switchBrush=function(e){n.brushType=e},this.setFreeformSelection=function(e,t){n.addPointSelection(e,t,!0)},this.addPointSelection=function(e,t){var r,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==t.length){var i=n.state,a=n.rootStore.actions.pointSelectionAction;a.setLabel(c?"P. Brush: ".concat(t.length):"Add Point Selection"),n.provenance.apply(a(e,t)),e.id in i.pointSelection||(i.pointSelection[e.id]=[]),(r=i.pointSelection[e.id]).push.apply(r,Object(k.a)(t)),n.stateRecord[n.currentNode]=i,n.rootStore.currentNodes.push(n.provenance.graph.current),n.addPredictions()}},this.setBrushSelection=function(e,t,r,c){var i=n.rootStore.actions,a=i.addBrushAction,o=i.updateBrushAction,s=i.removeBrushAction,l=n.state;switch(r){case"Add":a.setLabel("Added brush to: ".concat(e.x,"-").concat(e.y)),n.provenance.apply(a(e,t[c])),l.brushSelections[c]=t[c].points,l.brushes[e.id]=t;break;case"Update":o.setLabel("Updated brush in: ".concat(e.x,"-").concat(e.y)),n.provenance.apply(o(e,t[c])),l.brushSelections[c]=t[c].points,l.brushes[e.id]=t;break;case"Remove":s.setLabel("Removed brush in: ".concat(e.x,"-").concat(e.y)),n.provenance.apply(s(e,c)),delete l.brushSelections[c],delete t[c],l.brushes[e.id]=t}n.stateRecord[n.currentNode]=l,n.addPredictions()},this.setPredictionSelection=function(e){var t=n.rootStore.actions.predictionSelectionAction,r=n.state;e.original_id=n.currentDatasetKey||"",t.setLabel("".concat(e.intent," Selection")),n.provenance.apply(t(e)),r.brushes={},r.brushSelections={},r.pointSelection={},r.prediction=e,n.stateRecord[n.currentNode]=r,n.addPredictions()},this.setHoveredPrediction=function(e){n.hoveredPrediction=e},this.setComparison=function(e){n.isComparison=e},this.addPredictions=function(){n.hoveredPrediction=null;var e=[];0!==n.selectedPoints.length&&(n.isLoadingPredictions=!0,Object.values(n.state.plots).forEach((function(t){e.push.apply(e,[t.x,t.y])})),S.a.post("".concat(N,"/").concat(n.currentProject.key,"/dataset/predict/").concat(n.currentDatasetKey),{selections:n.selectedPoints,dimensions:e}).then(Object(p.action)((function(e){var t=e.data,r=void 0===t?[]:t;n.predictions=r,n.isLoadingPredictions=!1}))))},this.goToNode=function(e){n.provenance.goToNode(e)},this.rootStore=t,Object(p.makeAutoObservable)(this),Object(p.reaction)((function(){return n.state}),(function(){n.addPredictions()})),Object(p.reaction)((function(){return Object.values(n.provenance.graph.nodes).length}),(function(e,t){if(!n.isImporting&&(1!==t||2===e)){var r={};n.currentProject.datasets.forEach((function(e){r[e.key]=n.currentDatasetKey===e.key?"Accepted":"Unknown"})),n.provenance.addArtifact({original_dataset:n.currentDatasetKey,status_record:r})}}))}return Object(v.a)(e,[{key:"state",get:function(){return this.currentNode&&this.currentNode in this.stateRecord?C(this.stateRecord[this.currentNode]):{plots:{},brushes:{},brushSelections:{},pointSelection:{},prediction:null,filter:null}}},{key:"currentNode",get:function(){return this.provenance.current.id}},{key:"currentDatasetKey",get:function(){return this.rootStore.projectStore.currentDatasetKey}},{key:"currentDataset",get:function(){var e=this.rootStore.projectStore.loadedDataset;if(!e)throw new Error("Dataset not loaded");return e}},{key:"showSkylineLegend",get:function(){return this.hoveredPrediction&&"Skyline"===this.hoveredPrediction.intent}},{key:"showMatchesLegend",get:function(){return!!this.hoveredPrediction}},{key:"provenance",get:function(){return this.rootStore.provenance}},{key:"currentProject",get:function(){var e=this.rootStore.projectStore.currentProject;if(!e)throw new Error;return e}},{key:"n_plots",get:function(){return this.plots.length}},{key:"plots",get:function(){return Object.values(this.state.plots)}},{key:"selectedPoints",get:function(){var e=[],t=this.state.brushSelections;return Object.values(t).forEach((function(t){e.push.apply(e,Object(k.a)(t))})),Object.values(this.state.pointSelection).forEach((function(t){return e.push.apply(e,Object(k.a)(t))})),this.state.prediction&&e.push.apply(e,Object(k.a)(this.state.prediction.memberIds)),C(Array.from(new Set(e)))}},{key:"filteredPoints",get:function(){var e=[],t=this.state.filter;return t?(Object.values(t.points).forEach((function(t){e.push(t)})),C(Array.from(new Set(e)))):[]}},{key:"workingValues",get:function(){var e=this.state.filter;if(!e)return this.loadedDataset.values;var t=e.type,n=e.points;return"In"===t?this.loadedDataset.values.filter((function(e){return n.includes(e.id)})):this.loadedDataset.values.filter((function(e){return!n.includes(e.id)}))}},{key:"artifact",get:function(){var e=this.provenance.getLatestArtifact();return e?e.artifact:{original_dataset:null,status_record:{}}}},{key:"loadedDataset",get:function(){var e=this.rootStore.projectStore.loadedDataset;if(!e){var t=window.localStorage.getItem("dataset");if(!t)throw new Error("Dataset not loaded");return e=JSON.parse(t)}return window.localStorage.setItem("dataset",JSON.stringify(e)),e}},{key:"compDataset",get:function(){var e=this.rootStore.projectStore.currentComparisonDatasets[1];if(!e){var t=window.localStorage.getItem("dataset");if(!t)throw new Error("Dataset not loaded");return e=JSON.parse(t)}return window.localStorage.setItem("dataset",JSON.stringify(e)),e}},{key:"origCompDataset",get:function(){var e=this.rootStore.projectStore.currentComparisonDatasets[0];if(!e){var t=window.localStorage.getItem("dataset");if(!t)throw new Error("Dataset not loaded");return e=JSON.parse(t)}return window.localStorage.setItem("dataset",JSON.stringify(e)),e}}]),e}(),P=n(8),z=n(26),A=function(){function e(t){var n=this;Object(f.a)(this,e),this.rootStore=void 0,this.currentProject=null,this.projects=[],this.loadedDataset=null,this.workingDataset=null,this.currentDatasetKey=null,this.currentComparisonDatasets=[],this.comparisonKeys=[],this.isReapplying=!1,this.versionFromDatasetKey=function(e){var t="";if(n.currentProject&&e){var r=n.currentProject.datasets.find((function(t){return t.key===e}));r&&(t=r.version)}return t},this.projectByKey=function(e){return n.projects.find((function(t){return t.key===e}))},this.fetchCurrentDataset=function(){n.currentProject&&n.currentDatasetKey&&S.a.get("".concat(N,"/").concat(n.currentProject.key,"/dataset/").concat(n.currentDatasetKey)).then(Object(p.action)((function(e){n.loadedDataset=e.data,n.workingDataset=e.data})))},this.approveNode=function(e){var t=(n.provenance.getLatestArtifact(e)||{}).artifact,r=void 0===t?null:t;r&&((r=C(r)).status_record[n.currentDatasetKey||""]="Accepted",n.provenance.addArtifact(r,e))},this.rejectNode=function(e){if(n.currentDatasetKey){var t=(n.provenance.getLatestArtifact(e)||{}).artifact,r=void 0===t?null:t;r&&((r=C(r)).status_record[n.currentDatasetKey||""]="Rejected",n.provenance.addArtifact(r,e),n.loadDatasetWithReapply(n.currentDatasetKey))}},this.loadProjects=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;S.a.get("".concat(N,"/project")).then(Object(p.action)((function(t){if(n.projects=t.data,!e&&n.rootStore.debug)n.loadProjectByKey(n.rootStore.defaultProject);else if(e){var r=n.projects.find((function(t){return t.key===e}));r&&n.loadProjectByKey(r.key)}})))},this.loadProjectByKey=function(e){var t=n.projectByKey(e);t&&(n.loadedDataset=null,n.rootStore.exploreStore=new M(n.rootStore),S.a.get("".concat(N,"/").concat(e,"/dataset")).then(Object(p.action)((function(e){if(n.currentProject=Object(z.a)(Object(z.a)({},t),{},{datasets:e.data}),n.rootStore.debug&&n.rootStore.loadDefaultDataset){var r=n.rootStore.defaultDatasetKey;r&&n.currentProject.datasets.map((function(e){return e.key})).includes(r)?n.loadDataset(r):n.loadDataset(n.currentProject.datasets[0].key)}}))).then((function(){n.rootStore.loadedWorkflowId?n.loadFromWorkflow():n.rootStore.loadSavedProject&&n.loadSavedProject()})))},this.loadComparisonDataset=function(e){n.currentProject&&(n.currentComparisonDatasets.length<1&&n.loadedDataset&&(n.comparisonKeys=[n.currentDatasetKey||""],n.currentComparisonDatasets=[n.loadedDataset]),console.log(e),S.a.get("".concat(N,"/").concat(n.currentProject.key,"/dataset/").concat(e)).then(Object(p.action)((function(t){n.currentComparisonDatasets.length>1&&(n.currentComparisonDatasets[0]=n.currentComparisonDatasets[1],n.comparisonKeys[0]=n.comparisonKeys[1],n.currentComparisonDatasets.pop(),n.comparisonKeys.pop()),n.currentComparisonDatasets.push(t.data),n.comparisonKeys.push(e),console.log(Object(p.toJS)(n.currentComparisonDatasets)),console.log(Object(p.toJS)(n.comparisonKeys))}))),n.loadDatasetWithReapply(e))},this.loadComparisonFilter=function(e){var t,r=null===(t=n.workingDataset)||void 0===t?void 0:t.values.filter((function(t){return e.includes(t.id)})),c=[];if(n.workingDataset&&r){n.workingDataset.values=r;var i,a=Object(g.a)(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;c.push(o.id)}}catch(s){a.e(s)}finally{a.f()}}return c},this.loadOnlyFilter=function(e){var t,r=(null===(t=n.workingDataset)||void 0===t?void 0:t.values.filter((function(t){return!e.includes(t.id)})))||[],c=[];if(n.workingDataset&&r){n.workingDataset.values=r;var i,a=Object(g.a)(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;c.push(o.id)}}catch(s){a.e(s)}finally{a.f()}}return c},this.loadDataset=function(e){n.currentDatasetKey=e},this.loadDatasetWithReapply=function(e){if(n.currentProject&&n.currentDatasetKey){n.isReapplying=!0;var t=n.provenance.graph;Object.entries(t.nodes).forEach((function(e){var r=Object(P.a)(e,2),c=r[0],i=r[1];Object(h.isChildNode)(i)&&(i.state=n.provenance.getState(i)),t.nodes[c]=i})),S.a.post("".concat(N,"/project/").concat(n.currentProject.key,"/reapply"),{base:n.currentDatasetKey,target:e,provenance:t}).then(Object(p.action)((function(t){n.currentDatasetKey=e,n.rootStore.exploreStore.stateRecord=t.data,setTimeout(Object(p.action)((function(){return n.isReapplying=!1})),200)})))}},this.rootStore=t,Object(p.makeAutoObservable)(this),this.loadProjects(),Object(p.reaction)((function(){return n.currentDatasetKey}),(function(){return n.fetchCurrentDataset()}))}return Object(v.a)(e,[{key:"loadFromWorkflow",value:function(){var e=this,t=this.rootStore.loadedWorkflowId;t&&function(e,t){return e.ref(t).once("value")}(this.rootStore.db,t).then(Object(p.action)((function(t){var n=t.val();if(e.rootStore.exploreStore.isImporting=!0,e.currentProject&&e.currentDatasetKey){var r=n.graph,c=Object(z.a)(Object(z.a)({},n),{},{graph:[]});for(var i in e.rootStore.exploreStore.workflows[c.id]=c,e.rootStore.exploreStore.setCurrentWorkflow(c.id),r.nodes)r.nodes[i].children||(r.nodes[i].children=[]);for(var a in e.provenance.importProvenanceGraph(r),e.loadDatasetWithReapply(e.currentDatasetKey),r.nodes)Object(h.isChildNode)(r.nodes[a])&&e.rootStore.exploreStore.addToWorkflow(a)}e.rootStore.exploreStore.isImporting=!1})))}},{key:"loadSavedProject",value:function(){var e=this,t=this.rootStore.loadSavedProject,n=this.currentDatasetKey;t&&n&&function(e,t){return e.ref(t).once("value")}(this.rootStore.provDb,t).then(Object(p.action)((function(t){var r=t.val(),c=r.graph,i=r.wf;for(var a in c.nodes)c.nodes[a].children||(c.nodes[a].children=[]);e.provenance.importProvenanceGraph(c),e.loadDatasetWithReapply(n),e.rootStore.exploreStore.workflows=i,Object.values(i).length>0&&(e.rootStore.exploreStore.currentWorkflow=Object.values(i)[0].id)})))}},{key:"provenance",get:function(){return this.rootStore.provenance}},{key:"loadedDatasetKey",get:function(){return this.currentDatasetKey||""}},{key:"nodeCreationMap",get:function(){var e=this,t={};return Object.values(this.provenance.graph.nodes).forEach((function(n){var r=e.provenance.getLatestArtifact(n.id);if(r){var c=r.artifact,i=c.original_dataset,a={createdIn:e.versionFromDatasetKey(i),approvedIn:Object.entries(c.status_record).filter((function(e){return"Accepted"===e[1]})).map((function(t){return e.versionFromDatasetKey(t[0])})),rejectedIn:Object.entries(c.status_record).filter((function(e){return"Rejected"===e[1]})).map((function(t){return e.versionFromDatasetKey(t[0])}))};t[n.id]=a}})),t}},{key:"compDatasetValues",get:function(){var e=this;return this.currentComparisonDatasets.length<2?[]:this.currentComparisonDatasets[1].values.filter((function(t){return!e.rootStore.compareStore.updatedFilterPoints.includes(t.id)}))}},{key:"originaCompValues",get:function(){var e=this;return this.currentComparisonDatasets.length<2?[]:this.currentComparisonDatasets[0].values.filter((function(t){return!e.rootStore.compareStore.updatedFilterPoints.includes(t.id)}))}}]),e}(),L=Object(h.createAction)((function(e,t){e.interaction={type:"AddPlot",plot:t}})).saveStateMode("Complete").setEventType("Add Plot"),W=Object(h.createAction)((function(e,t){e.interaction={type:"RemovePlot",plot:t.id}})).saveStateMode("Complete").setEventType("Add Plot"),B=Object(h.createAction)((function(e,t,n){e.interaction={type:"PointSelection",action:"Add",plot:t.id,selected:n}})).saveStateMode("Complete").setEventType("Point Selection"),F=Object(h.createAction)((function(e,t,n){e.interaction={type:"Brush",action:"Add",plot:t.id,brush:n}})).saveStateMode("Complete").setEventType("Add Brush"),E=Object(h.createAction)((function(e,t,n){e.interaction={type:"Brush",action:"Update",plot:t.id,brush:n}})).saveStateMode("Complete").setEventType("Update Brush"),R=Object(h.createAction)((function(e,t,n){e.interaction={type:"Brush",action:"Remove",plot:t.id,brush:n}})).saveStateMode("Complete").setEventType("Remove Brush"),G=Object(h.createAction)((function(e,t){e.interaction={type:"SelectPrediction",prediction:t}})).saveStateMode("Complete").setEventType("Prediction Selection"),I={addPlotAction:L,removePlotAction:W,filterAction:Object(h.createAction)((function(e,t){e.interaction={type:"Filter",filterType:t}})).saveStateMode("Complete").setEventType("Filter"),pointSelectionAction:B,predictionSelectionAction:G,addBrushAction:F,updateBrushAction:E,removeBrushAction:R},T=Object(i.createContext)(new function e(){var t=this;Object(f.a)(this,e),this.debug=!0,this.search="",this.defaultProject="cluster",this.loadDefaultDataset=!1,this.loadSavedProject=null,this.defaultDatasetKey=null,this.redirectPath=null,this.loadedWorkflowId=null,this.db=void 0,this.provDb=void 0,this.dims=[],this.projectStore=void 0,this.exploreStore=void 0,this.compareStore=void 0,this.provenance=void 0,this.actions=I,this.currentNodes=void 0,this.bundledNodes=void 0,this.setQueryParams=function(e){if(t.search!==e){t.search=e;var n=new URLSearchParams(e),r=n.get("debug"),c=n.get("project"),i=n.get("data"),a=n.get("demo"),o=n.get("redirect"),s=n.get("workflow"),l=n.get("dims");t.debug=!!r||(!!s||!!a),t.defaultProject=c||(a||"cluster"),t.loadDefaultDataset=!(!i&&!a),t.defaultDatasetKey="true"!==i?i:null,t.loadSavedProject=a||null,t.loadedWorkflowId=s,t.redirectPath=s||a?"explore":o,t.dims=l?l.split(","):[]}},this.provenance=Object(h.initProvenance)({interaction:{type:"Root"}},{loadFromUrl:!1}),this.provenance.done(),this.projectStore=new A(this),this.exploreStore=new M(this),this.compareStore=new y(this),this.currentNodes=[],this.bundledNodes=[];var n=function(){var e=0===x.a.apps.length?x.a.initializeApp(O):x.a.app(),t=x.a.database(e),n=e.database("https://reusing-demos.firebaseio.com/");return{config:O,app:e,db:t,provDb:n}}(),r=n.db,c=n.provDb;this.db=r,this.provDb=c,Object(p.makeAutoObservable)(this,{actions:!1,provenance:!1})}),K=n(315),_=n(36),H=n(552),V=n(621),J=n(186),U=n(138),Y=n(88),X=n.n(Y),Z=n(1),q=Object(u.a)((function(e){return Object(K.a)({root:{flexGrow:1,padding:e.spacing(2),overflow:"auto"},grid:{height:"100%"},closeIcon:{position:"absolute"}})})),Q=Object(b.a)((function(){var e=Object(i.useContext)(T).exploreStore,t=e.plots,n=e.removePlot,r=e.isLoadingData,c=e.n_plots,a=Object(i.useContext)(T).projectStore.currentProject,o=(null===a||void 0===a||a.datasets.map((function(e){return{key:e.key,desc:e.version}})),Object(i.useContext)(T).exploreStore.selectedPoints,q()),s=(Object(_.a)(),1===c?"auto":6),l=Object(Z.jsx)(H.a,{}),d=t.map((function(e){return Object(Z.jsx)(V.a,{xs:s,item:!0,children:Object(Z.jsxs)(J.a,{elevation:3,children:[c>1&&Object(Z.jsx)(U.a,{className:o.closeIcon,onClick:function(){return n(e)},children:Object(Z.jsx)(X.a,{})}),Object(Z.jsx)("div",{})]})},e.id)}));return Object(Z.jsx)("div",{className:o.root,children:Object(Z.jsx)(V.a,{alignItems:"center",className:o.grid,justify:"center",spacing:2,container:!0,children:r?l:d})})})),$=Object(u.a)((function(){return{root:{".red":{backgroundColor:"#ff8080"},".green":{backgroundColor:"#90EE90"},".yellow":{backgroundColor:"#ffff8b"},display:"grid",height:"100vh",width:"100vw",gridTemplateRows:"min-content 1fr",overflow:"hidden"},layout:{display:"grid",gridTemplateColumns:"5fr 2fr",overflow:"hidden"}}})),ee=Object(b.a)((function(e){var t=e.location,n=Object(i.useContext)(T),r=n.exploreStore,c=r.n_plots,a=r.addPlot,o=n.projectStore.loadedDataset,s=n.provenance,l=n.setQueryParams,d=n.loadedWorkflowId,u=n.loadSavedProject;Object(i.useEffect)((function(){l(t.search)}),[t.search,l]),Object(i.useEffect)((function(){var e=s.current;if(!(Object(h.isChildNode)(e)&&e.children.length>0)&&!(c>0||!o||d||u)){var t=o.numericColumns,n={id:D(),x:t[0],y:t[1]};a(n)}}));var b=$();return Object(Z.jsxs)("div",{className:b.root,children:[Object(Z.jsx)(j.a,{}),Object(Z.jsx)("div",{className:b.layout,children:Object(Z.jsx)(Q,{})})]})})),te=n(22),ne=n(95),re=n(649),ce=n(651),ie=n(136);function ae(e,t){var n=[];for(var r in t)t[r].bunchedNodes.includes(e)&&n.push(r);return n}function oe(e,t){return"translate(".concat(e,", ").concat(t,")")}function se(e,t,n){var r=function(e,t,n){var r=[];return le(e,t,n,r),[t].concat(Object(k.a)(r.reverse()))}(e,n,t);return function(e,t,n,r){var c=new Set,i=[],a=0;i.push(e[t]);for(;i.length>0;){var o=i.pop();c.has(o.id)?o.width=n[o.id]:(o.width=a,n[o.id]=o.width,c.add(o.id)),o.children?i.push.apply(i,Object(k.a)(o.children.sort((function(e,t){return(r.includes(e.id)?1:0)-(r.includes(t.id)?1:0)})))):a+=1}}(e,n,{},r),r}function le(e,t,n,r){if(!e[t])return!1;if(t===n)return r.push(t),!0;var c,i=e[t].children||[],a=Object(g.a)(i);try{for(a.s();!(c=a.n()).done;){var o=c.value;if(le(e,o.id,n,r))return r.push(o.id),!0}}catch(s){a.e(s)}finally{a.f()}return!1}var de=n(654),ue=n(172),je=n(650),he=n(623),be=n(325),fe=function(e){return Object(ie.a)({fill:e?"rgb(33, 133, 208)":"white",stroke:"rgb(33, 133, 208)"})};var pe=function(e){var t,n,r=e.prov,c=e.first,a=e.iconOnly,o=e.current,s=e.node,l=e.duration,d=e.radius,u=e.strokeWidth,j=e.addToWorkflow,h=e.textSize,b=e.nodeMap,f=e.annotationOpen,p=e.bookmark,x=e.setAnnotationOpen,O=e.exemptList,m=e.setExemptList,g=e.setAnnotationHeight,v=e.bundleMap,y=e.eventConfig,k=e.popupContent,w=e.editAnnotations,S=e.annotationContent,C=e.approvedFunction,D=e.rejectedFunction,N=e.currentDataset,M=e.nodeCreationMap,z=e.expandedClusterList,A={cursor:"pointer"},L=Object(i.useState)(s.artifacts&&s.artifacts.annotations&&(null===(t=r.getLatestAnnotation(s.id))||void 0===t?void 0:t.annotation)?null===(n=r.getLatestAnnotation(s.id))||void 0===n?void 0:n.annotation:""),W=Object(P.a)(L,2),B=W[0],F=W[1],E=function(){var e=r.getLatestAnnotation(s.id);(null===e||void 0===e?void 0:e.annotation)!==B.trim()&&(r.addAnnotation(B,s.id),F(B),x(-1))},R=function(){var e;F(null===(e=r.getLatestAnnotation(s.id))||void 0===e?void 0:e.annotation),x(-1)},G=function(e){F(e.target.value)},I=Object(Z.jsx)("circle",{className:fe(o),r:d,strokeWidth:u,style:A}),T=!1;if(y){var K=s.metadata.eventType;if(K&&K in y&&"Root"!==K){var _=y[K],H=_.bundleGlyph,V=_.currentGlyph,J=_.backboneGlyph;v&&Object.keys(v).includes(s.id)&&(T=!0,I=Object(Z.jsx)("g",{fontWeight:"none",style:A,children:H})),o?I=Object(Z.jsx)("g",{fontWeight:"none",style:A,children:V}):T||(I=Object(Z.jsx)("g",{fontWeight:"none",style:A,children:J}))}}var U="",Y="";if(U=v&&Object.keys(v).includes(s.id)&&"Ephemeral"===s.actionType&&z&&!z.includes(s.id)?s.metadata&&s.metadata.eventType?"[".concat(v[s.id].bunchedNodes.length,"] ").concat(s.metadata.eventType):"[".concat(v[s.id].bunchedNodes.length,"]"):s.label,s.artifacts&&s.artifacts.annotations&&s.artifacts.annotations.length>0&&f!==b[s.id].depth&&(Y=s.artifacts.annotations[0].annotation),!b[s.id])return null;Y.length>20&&(Y="".concat(Y.substr(0,20),"..")),U.length>20&&(U="".concat(U.substr(0,20),".."));var X=Object(Z.jsxs)("g",{style:{opacity:1},transform:oe(25,0),children:[M[s.id]?Object(Z.jsxs)("g",{children:[Object(Z.jsxs)("g",{transform:oe(0,-20),children:[Object(Z.jsx)("circle",{fill:"white",opacity:"1",r:"7"}),Object(Z.jsx)("text",{alignmentBaseline:"middle",fill:M[s.id]&&M[s.id].createdIn===N?"green":"grey",fontSize:10,fontWeight:"bold",style:A,textAnchor:"start",x:T?10:0,y:0,children:M[s.id]?M[s.id].createdIn:""})]}),Object(Z.jsxs)("g",{transform:oe(-10,10),children:[Object(Z.jsx)("circle",{fill:"white",opacity:"1",r:"7"}),Object(Z.jsx)("text",{alignmentBaseline:"middle",fill:M[s.id]&&M[s.id].approvedIn.includes(N)?"green":M[s.id].rejectedIn.includes(N)?"red":"black",fontFamily:"Icons",fontSize:10,style:A,textAnchor:"middle",x:0,y:0,children:M[s.id]&&M[s.id].approvedIn.includes(N)?"\uf00c":M[s.id].rejectedIn.includes(N)?"\uf00d":"\uf128"})]})]}):null,!M[s.id]||M[s.id].rejectedIn.includes(N)||M[s.id].approvedIn.includes(N)?"Root"!==s.label&&!M[s.id].rejectedIn.includes(N)&&Object(Z.jsx)("g",{transform:oe(-10,10),children:Object(Z.jsx)("foreignObject",{height:"100",width:"50",x:"-45",y:"-20",children:Object(Z.jsx)("div",{style:{maxWidth:"20"},children:Object(Z.jsx)(de.a,{style:{margin:"1px",padding:"1px",maxHeight:"20px",maxWidth:"20px"},onClick:function(e){e.stopPropagation(),j(s.id)},children:Object(Z.jsx)(ue.a,{color:"green",name:"add",size:"small",style:{margin:"0px"}})})})})}):Object(Z.jsx)("g",{transform:oe(-10,10),children:Object(Z.jsxs)("foreignObject",{height:"100",width:"50",x:"-45",y:"-30",children:[Object(Z.jsx)("div",{style:{maxWidth:"20"},children:Object(Z.jsx)(de.a,{style:{margin:"1px",padding:"1px",maxHeight:"15px",maxWidth:"15px"},onClick:function(e){e.stopPropagation(),C(s.id)},children:Object(Z.jsx)(ue.a,{color:"green",name:"check",size:"small",style:{margin:"0px"}})})}),Object(Z.jsx)("div",{style:{maxWidth:"20"},children:Object(Z.jsx)(de.a,{style:{margin:"1px",padding:"1px",maxHeight:"15px",maxWidth:"15px"},onClick:function(e){e.stopPropagation(),D(s.id)},children:Object(Z.jsx)(ue.a,{color:"red",name:"close",size:"small",style:{margin:"0px"}})})})]})}),a?Object(Z.jsx)("g",{children:T?Object(Z.jsx)("text",{alignmentBaseline:"middle",fill:"rgb(248, 191, 132)",fontFamily:"Icons",fontSize:17,style:A,textAnchor:"middle",x:1,y:0,onClick:function(e){return Q(s,e)},children:z&&z.includes(s.id)?"\uf0d8":"\uf0d7"}):Object(Z.jsx)("g",{})}):Object(Z.jsxs)("g",{children:[T?Object(Z.jsx)("text",{alignmentBaseline:"middle",fill:"rgb(248, 191, 132)",fontFamily:"Icons",fontSize:17,style:A,textAnchor:"middle",x:1,y:0,onClick:function(e){return Q(s,e)},children:z&&z.includes(s.id)?"\uf0d8":"\uf0d7"}):Object(Z.jsx)("g",{}),w?Object(Z.jsxs)("button",{children:[Object(Z.jsx)("i",{className:"fas fa-undo marginRight"}),"Undo"]}):Object(Z.jsx)("g",{}),Object(Z.jsx)("text",{dominantBaseline:"middle",fill:"black",fontSize:h,fontWeight:"bold",textAnchor:"start",x:T?10:0,y:0===Y.length?0:-7,onClick:function(){return q(s)},children:U}),",",Object(Z.jsx)("text",{dominantBaseline:"middle",fill:"black",fontSize:h,fontWeight:"regular",textAnchor:"start",x:T?10:0,y:7,onClick:function(){return q(s)},children:Y}),",",Object(Z.jsx)("text",{alignmentBaseline:"middle",className:"fas fa",fill:r.getBookmark(s.id)?"#2185d0":"#cccccc",fontFamily:"Icons",fontSize:17,opacity:p===s.id||r.getBookmark(s.id)?1:0,style:A,textAnchor:"middle",x:175,y:0,onClick:function(e){r.setBookmark(s.id,!r.getBookmark(s.id)),e.stopPropagation()},children:"\uf02e"}),",",Object(Z.jsx)("text",{alignmentBaseline:"middle",fill:f===b[s.id].depth?"#2185d0":"#cccccc",fontFamily:"Icons",fontSize:17,opacity:p===s.id||f===b[s.id].depth?1:0,style:A,textAnchor:"middle",x:210,y:0,onClick:function(){-1===f||b[s.id].depth!==f?x(b[s.id].depth):x(-1)},children:"\uf044"})]})]});return Object(Z.jsx)(ne.a,{enter:{opacity:[1],timing:{duration:100,delay:c?0:l}},start:{opacity:0},children:function(){return Object(Z.jsxs)(Z.Fragment,{children:[void 0!==k&&b[s.id].depth>0?Object(Z.jsx)(re.a,{content:k(s),trigger:I}):I,void 0!==k&&b[s.id].depth>0?Object(Z.jsx)(re.a,{content:k(s),trigger:X}):X,-1!==f&&b[s.id].depth===f?Object(Z.jsx)("g",{transform:"translate(15, 25)",children:Object(Z.jsx)("foreignObject",{height:"400",width:"250",x:"0",y:"0",children:Object(Z.jsx)("div",{children:Object(Z.jsx)(je.a,{children:Object(Z.jsxs)(be.a,{onResize:function(e,t){return g(t?t+15:50)},children:[Object(Z.jsx)(he.a,{defaultValue:B,placeholder:"Tell us more",rows:2,style:{width:"170px",marginRight:"1px"},onInput:G}),Object(Z.jsx)(de.a,{style:{margin:"1px",padding:"5px",maxWidth:"30px"},onClick:E,children:Object(Z.jsx)(ue.a,{color:"green",name:"check",style:{margin:"0px"}})}),Object(Z.jsx)(de.a,{style:{margin:"1px",padding:"5px",maxWidth:"30px"},onClick:R,children:Object(Z.jsx)(ue.a,{color:"red",name:"close",style:{margin:"0px"}})})]})})})})}):Object(Z.jsx)("g",{})]})}});function q(e){f===b[e.id].depth&&S?x(-1):S&&x(b[e.id].depth)}function Q(e,t){if(v&&Object.keys(v).includes(e.id)){var n=Array.from(O);n.includes(e.id)?n.splice(n.findIndex((function(t){return t===e.id})),1):n.push(e.id),m(n)}t.stopPropagation()}};var xe=function(e){var t=e.current,n=e.node,r=e.eventConfig,c={cursor:"pointer"},i=Object(Z.jsx)("circle",{className:fe(t),r:5,strokeWidth:2,style:c}),a=n.metadata.eventType;if(r){var o=r[a],s=o.currentGlyph,l=o.backboneGlyph;i=t?Object(Z.jsx)("g",{fontWeight:"none",style:c,children:s}):Object(Z.jsx)("g",{fontWeight:"none",style:c,children:l})}var d="",u="";return n.artifacts&&n.artifacts.annotations.length>0&&n.artifacts.annotations[0].annotation.length>0&&(u=n.artifacts.annotations[0].annotation),d=n.label,u.length>20&&(u="".concat(u.substr(0,20),"..")),d.length>20&&(d="".concat(d.substr(0,20),"..")),Object(Z.jsx)(ne.a,{enter:{opacity:[1]},start:{opacity:0},children:function(){return Object(Z.jsx)(Z.Fragment,{children:Object(Z.jsxs)("g",{style:{opacity:1},children:[i,Object(Z.jsx)("text",{dominantBaseline:"middle",fontSize:15,fontWeight:"bold",textAnchor:"start",x:20,y:0,children:d}),Object(Z.jsx)("text",{dominantBaseline:"middle",fontSize:15,fontWeight:"regular",textAnchor:"start",x:0,y:20,children:u})]})})}})};var Oe=function(e){var t=e.graph,n=e.eventConfig,r=e.currentNode;if(void 0===t)return null;var c=[];for(var i in t.nodes)t.nodes[i].bookmarked&&c.push(t.nodes[i]);return Object(Z.jsx)(ne.b,Object(z.a)(Object(z.a)({data:c,keyAccessor:function(e){return e.label}},function(e,t,n){e=-e;var r=function(e){return{x:0,y:40*n.findIndex((function(t){return t.id===e.id}))-t,opacity:0}};return{enter:function(e){return{x:[0],y:[40*n.findIndex((function(t){return t.id===e.id}))],opactiy:1}},leave:r,update:function(e){return{x:[0],y:[40*n.findIndex((function(t){return t.id===e.id}))],opactiy:1}},start:r}}(15,50,c)),{},{children:function(e){return Object(Z.jsx)(Z.Fragment,{children:e.map((function(t){var c=t.data,i=t.key,a=t.state;return Object(Z.jsx)("g",{transform:oe(a.x,a.y),children:Object(Z.jsx)(xe,{current:r===c.id,editAnnotations:!1,eventConfig:n,node:c,nodeMap:e})},i)}))})}}))};function me(e,t,n,r){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:500,i=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0;e=-e,r=-r;var o=function(){return{x1:0,x2:0,y1:0,y2:0,opacity:0}},s=function(o){var s=0;s=0===s?s:s-1;var l=o.source,d=o.target,u=ge(l.width,e,r),j=ge(d.width,e,r),h=t*l.depth-(t-n)*s,b=t*d.depth-(t-n)*s;return-1!==i&&l.depth>i&&0===l.width&&(h+=a),-1!==i&&d.depth>i&&0===d.width&&(b+=a),{x1:u,x2:j,y1:h,y2:b,opacity:1,timing:{duration:c}}},l=function(o){var s=0;s=0===s?s:s-1;var l=o.source,d=o.target,u=ge(l.width,e,r),j=ge(d.width,e,r),h=t*l.depth-(t-n)*s,b=t*d.depth-(t-n)*s;return-1!==i&&l.depth>i&&0===l.width&&(h+=a),-1!==i&&d.depth>i&&0===d.width&&(b+=a),{x1:[u],y1:[h],x2:[j],y2:[b],opacity:1,timing:{duration:c}}};return{enter:s,leave:o,update:l,start:o}}function ge(e,t,n){return e>1?(t+n)*e-n:(t+n)*e}function ve(e,t,n,r){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:500,i=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,o=arguments.length>8?arguments[8]:void 0,s=arguments.length>9?arguments[9]:void 0,l=arguments.length>10?arguments[10]:void 0;e=-e,r=-r;var d=function(){return{x:0,y:0,opacity:0}},u=function(d){var u=ge(a[d].width,e,r),j=a[d].depth,h=a[d].depth;if(l&&i.includes(d))for(var b=0;b<l[d].bunchedNodes.length;b++)a[l[d].bunchedNodes[b]]&&a[l[d].bunchedNodes[b]].depth<j&&(j=a[l[d].bunchedNodes[b]].depth),a[l[d].bunchedNodes[b]]&&a[l[d].bunchedNodes[b]].depth>h&&(h=a[l[d].bunchedNodes[b]].depth);var f=t*j;-1!==o&&j>o&&(f+=s);var p=0;for(var x in l[d].bunchedNodes)a[l[d].bunchedNodes[x]]&&p++;return p*=n,i.includes(d)||(p=10),-1!==o&&o>=j&&o<=h&&(p+=s),{x:[u],y:[f],opacity:[i.includes(d)?1:0],timing:{duration:c},validity:!0,height:p}},j=function(d){var u=ge(a[d].width,e,r),j=a[d].depth,h=a[d].depth;if(l&&i.includes(d))for(var b=0;b<l[d].bunchedNodes.length;b++)a[l[d].bunchedNodes[b]]&&a[l[d].bunchedNodes[b]].depth<j&&(j=a[l[d].bunchedNodes[b]].depth),a[l[d].bunchedNodes[b]]&&a[l[d].bunchedNodes[b]].depth>h&&(h=a[l[d].bunchedNodes[b]].depth);var f=t*j;-1!==o&&j>o&&(f+=s);var p=0;for(var x in l[d].bunchedNodes)a[l[d].bunchedNodes[x]]&&p++;return p*=n,i.includes(d)||(p=10),-1!==o&&o>=j&&o<=h&&(p+=s),{x:[u],y:[f],opacity:[i.includes(d)?1:0],timing:{duration:c},validity:!0,height:[p]}};return{enter:u,leave:d,update:j,start:d}}var ye=function(e){return Object(Z.jsx)("line",Object(z.a)({},e))};function ke(e,t,n,r){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:500,i=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0;e=-e,r=-r;var o=function(c){var o=0,s=ge(c.width,e,r);o=0===o?o:o-1;var l=t*c.depth-(t-n)*o;return-1!==i&&c.depth>i&&0===c.width&&(l+=a),{x:s,y:l-t,opacity:0}},s=function(o){var s=0,l=ge(o.width,e,r);s=0===s?s:s-1;var d=t*o.depth-(t-n)*s;return-1!==i&&o.depth>i&&0===o.width&&(d+=a),{x:[l],y:[d],opactiy:1,timing:{duration:c}}},l=function(o){var s=0,l=ge(o.width,e,r);s=0===s?s:s-1;var d=t*o.depth-(t-n)*s;return-1!==i&&o.depth>i&&0===o.width&&(d+=a),{x:[l],y:[d],opactiy:1,timing:{duration:c}}};return{enter:s,leave:o,update:l,start:o}}var we=Object(ie.a)({marginTop:"2px",borderRadius:"2px",display:"inline-block",cursor:"pointer",fontFamily:"Lato,Helvetica Neue,Arial,Helvetica,sans-serif",fontSize:"14px",marginRight:"1px",$nest:{"&:hover":{backgroundColor:"#6c7c7c"},"&:active":{backgroundColor:"#6c7c7c"}}}),Se=Object(ie.a)({marginTop:"2px",borderRadius:"2px",display:"inline-block",cursor:"pointer",fontFamily:"Lato,Helvetica Neue,Arial,Helvetica,sans-serif",fontSize:"14px",$nest:{"&:hover":{backgroundColor:"#6c7c7c"},"&:active":{backgroundColor:"#6c7c7c"}}});var Ce=function(e){var t=e.graph,n=e.undoCallback,r=e.redoCallback;if(void 0===t)return null;var c=t.root===t.current,i=0===t.nodes[t.current].children.length,a={marginRight:"3px"};return Object(Z.jsxs)("div",{children:[Object(Z.jsxs)(de.a,{className:we,disabled:c,variant:"outlined",onClick:n,children:[Object(Z.jsx)("i",{className:"fas fa-undo marginRight",style:a}),"Undo"]}),Object(Z.jsxs)(de.a,{className:Se,disabled:i,variant:"outlined",onClick:r,children:[Object(Z.jsx)("i",{className:"fas fa-redo marginRight",style:a}),"Redo"]})]})},De=Object(ie.a)({alignItems:"center",justifyContent:"center",overflow:"auto"});var Ne=Object(b.a)((function(e){var t=e.nodeMap,n=e.root,r=e.current,c=e.changeCurrent,a=e.width,o=void 0===a?400:a,s=e.height,l=void 0===s?800:s,d=e.iconOnly,u=void 0!==d&&d,j=e.gutter,b=void 0===j?15:j,f=e.backboneGutter,p=void 0===f?20:f,x=e.verticalSpace,O=void 0===x?50:x,m=e.clusterVerticalSpace,v=void 0===m?50:m,y=e.regularCircleRadius,k=void 0===y?4:y,w=e.backboneCircleRadius,S=void 0===w?5:w,C=e.regularCircleStroke,D=void 0===C?3:C,N=e.backboneCircleStroke,M=void 0===N?3:N,A=e.sideOffset,L=void 0===A?200:A,W=e.topOffset,B=void 0===W?30:W,F=e.textSize,E=void 0===F?15:F,R=e.linkWidth,G=void 0===R?4:R,I=e.duration,T=void 0===I?600:I,K=e.clusterLabels,_=void 0===K||K,H=e.bundleMap,V=void 0===H?{}:H,J=e.eventConfig,U=(e.brushCallback,e.popupContent),Y=e.annotationContent,X=e.approvedFunction,q=e.rejectedFunction,Q=e.addToWorkflow,$=e.currentDataset,ee=e.nodeCreationMap,ie=e.editAnnotations,le=void 0!==ie&&ie,de=e.prov,ue=e.ephemeralUndo,je=void 0!==ue&&ue,he=Object(i.useState)(!0),be=Object(P.a)(he,2),xe=be[0],ge=be[1],we=Object(i.useState)(null),Se=Object(P.a)(we,2),Ne=Se[0],Me=Se[1],Pe=Object(i.useState)(-1),ze=Object(P.a)(Pe,2),Ae=ze[0],Le=ze[1],We=Object(i.useState)(35),Be=Object(P.a)(We,2),Fe=Be[0],Ee=Be[1],Re=[],Ge=new Set;for(var Ie in t){var Te=t[Ie];if(Object(h.isChildNode)(Te)&&(Te.metadata.eventType&&Ge.add(Te.metadata.eventType),"Ephemeral"===Te.actionType&&1===Te.children.length&&("Ephemeral"!==t[Te.parent].actionType||t[Te.parent].children.length>1))){for(var Ke=[],_e=Te;"Ephemeral"===_e.actionType&&(Ke.push(_e.id),1===_e.children.length&&"Ephemeral"===t[_e.children[0]].actionType);)_e=t[_e.children[0]];V[Te.id]={metadata:"",bundleLabel:"",bunchedNodes:Ke}}}V&&(Re=Re.concat(Object.keys(V)));var He=Object(i.useState)(Object.keys(V)),Ve=Object(P.a)(He,2),Je=Ve[0],Ue=Ve[1];!J&&Ge.size>0&&Ge.size<8&&(J=function(e){var t,n=[te.k().type(te.p).size(50),te.k().type(te.n),te.k().type(te.q),te.k().type(te.l),te.k().type(te.m),te.k().type(te.o),te.k().type(te.r)],r={},c=0,i=Object(g.a)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;r[a]={},r[a].backboneGlyph=Object(Z.jsx)("path",{className:fe(!1),d:n[c](),strokeWidth:2}),r[a].bundleGlyph=Object(Z.jsx)("path",{className:fe(!1),d:n[c](),strokeWidth:2}),r[a].currentGlyph=Object(Z.jsx)("path",{className:fe(!0),d:n[c](),strokeWidth:2}),r[a].regularGlyph=Object(Z.jsx)("path",{className:fe(!1),d:n[c](),strokeWidth:2}),c+=1}}catch(o){i.e(o)}finally{i.f()}return r}(Ge)),Object(i.useEffect)((function(){ge(!1)}),[]);var Ye=Object.values(t).filter((function(){return!0})),Xe=Array.from(Ye),Ze=V?Object.keys(V):[],qe=[];if(V){var Qe,$e=Object(g.a)(Ze);try{for($e.s();!(Qe=$e.n()).done;){var et=Qe.value;(qe=qe.concat(V[et].bunchedNodes)).push(et)}}catch(yt){$e.e(yt)}finally{$e.f()}}for(var tt=te.j().id((function(e){return e.id})).parentId((function(e){if(e.id===n)return null;if(Object(h.isChildNode)(e)){if(V&&Object.keys(V).includes(e.id)&&!Je.includes(e.id))for(var t=e,r=function(){var e=t;if(!qe.includes(e.parent)||Object.keys(V).includes(e.parent))return{v:e.parent};var n=Xe.filter((function(t){return t.id===e.parent}))[0];Object(h.isChildNode)(n)&&(t=n)};;){var c=r();if("object"===typeof c)return c.v}var i,a=ae(e.parent,V),o=!0;for(var s in a)if(!Je.includes(a[s])){o=!1,i=a[s];break}return qe.includes(e.parent)&&V&&!Object.keys(V).includes(e.parent)&&!o?i:e.parent}return null})),nt=0;nt<Ye.length;nt++){var rt=ae(Ye[nt].id,V),ct=!0;for(var it in rt)if(!Je.includes(rt[it])){ct=!1;break}qe.includes(Ye[nt].id)&&!ct&&V&&!Object.keys(V).includes(Ye[nt].id)&&(Ye.splice(nt,1),nt--)}var at=tt(Ye),ot=at.descendants(),st={};ot.forEach((function(e){st[e.id]=e})),se(st,r,n);var lt=0,dt=0;for(var ut in ot)ot[ut].depth>lt&&(lt=ot[ut].depth),ot[ut].width>dt&&(dt=ot[ut].width);var jt=at.links(),ht=b,bt=O;function ft(e){if(J){var t=e.metadata.eventType;if(t&&t in J&&"Root"!==t&&J[t].regularGlyph)return J[t].regularGlyph}return Object(Z.jsx)("circle",{className:fe(!1),r:k,strokeWidth:D})}function pt(e){if(J){var t=e.metadata.eventType;if(t&&t in J&&"Root"!==t)return J[t].bundleGlyph}return Object(Z.jsx)("circle",{className:fe(!1),r:k,strokeWidth:D})}var xt=0;0===dt?xt=30:1===dt?xt=52:dt>1&&(xt=74);var Ot=o,mt=Object(Z.jsx)("svg",{height:lt<l?l:lt,id:"bookmarkView",style:{overflow:"visible"},width:Ot,children:Object(Z.jsx)("g",{id:"globalG",transform:oe(xt,B),children:Object(Z.jsx)(Oe,{currentNode:r,eventConfig:J,graph:de?de.graph:void 0})})}),gt=Object(Z.jsxs)("div",{children:[Object(Z.jsx)("div",{id:"undoRedoDiv",children:Object(Z.jsx)(Ce,{graph:de?de.graph:void 0,redoCallback:function(){de&&(je?de.goForwardToNonEphemeral():de.goForwardOneStep())},undoCallback:function(){de&&(je?de.goBackToNonEphemeral():de.goBackOneStep())}})}),Object(Z.jsxs)("svg",{height:lt<l?l:lt,id:"topSvg",style:{overflow:"visible"},width:Ot,children:[Object(Z.jsx)("rect",{fill:"none",height:l,stroke:"none",width:o}),Object(Z.jsxs)("g",{id:"globalG",transform:oe(xt,B),children:[Object(Z.jsx)(ne.b,Object(z.a)(Object(z.a)({data:jt,keyAccessor:function(e){return"".concat(e.source.id).concat(e.target.id)}},me(ht,bt,v,p-b,T,Ae,Fe)),{},{children:function(e){return Object(Z.jsx)(Z.Fragment,{children:e.map((function(e){var t=e.key,n=e.state;return Object(Z.jsx)("g",{children:Object(Z.jsx)(ye,Object(z.a)(Object(z.a)({},n),{},{fill:"#ccc",stroke:"#ccc",strokeWidth:G}))},t)}))})}})),Object(Z.jsx)(ne.b,Object(z.a)(Object(z.a)({data:ot,keyAccessor:function(e){return e.id}},ke(ht,bt,v,p-b,T,Ae,Fe)),{},{children:function(e){return Object(Z.jsx)(Z.Fragment,{children:e.map((function(e){var t=e.data,n=e.key,i=e.state;return Object(Z.jsx)("g",{transform:(t.width,oe(i.x,i.y)),onClick:function(){c&&c(t.id)},onMouseOut:function(){Me(null)},onMouseOver:function(){Me(t.id)},children:0===t.width&&de?Object(Z.jsxs)("g",{children:[Object(Z.jsx)("rect",{height:"25",opacity:"0",transform:"translate(0, -12.5)",width:"200"}),",",Object(Z.jsx)(pe,{addToWorkflow:Q,annotationContent:Y,annotationOpen:Ae,approvedFunction:X,bookmark:Ne,bundleMap:V,clusterLabels:_,current:r===t.id,currentDataset:$,duration:T,editAnnotations:le,eventConfig:J,exemptList:Je,expandedClusterList:Je,first:xe,iconOnly:u,node:t.data,nodeCreationMap:ee,nodeMap:st,popupContent:U,prov:de,radius:S,rejectedFunction:q,setAnnotationHeight:Ee,setAnnotationOpen:Le,setBookmark:Me,setExemptList:Ue,strokeWidth:M,textSize:E})]}):void 0!==U?Object(Z.jsx)(re.a,{content:U(t.data),trigger:Object(Z.jsx)("g",{onClick:function(){Le(-1)},children:Ze.includes(t.id)?pt(t.data):ft(t.data)})}):Object(Z.jsx)("g",{onClick:function(){Le(-1)},children:ft(t.data)})},n)}))})}})),Object(Z.jsx)(ne.b,Object(z.a)(Object(z.a)({data:Ze,keyAccessor:function(e){return"".concat(e)}},ve(ht,O,v,p-b,T,Je,st,ot,Ae,Fe,V)),{},{children:function(e){return Object(Z.jsx)(Z.Fragment,{children:e.map((function(e){var t=e.key,n=e.state;return void 0===V||0!==st[e.key].width||!1===n.validity?null:Object(Z.jsx)("g",{transform:oe(n.x-b+5,n.y-v/2),children:Object(Z.jsx)("rect",{fill:"none",height:n.height,rx:"10",ry:"10",stroke:"rgb(248, 191, 132)",strokeWidth:"2px",style:{opacity:n.opacity},width:u?42:L-15})},t)}))})}}))]})]})]}),vt=[{menuItem:{key:"Graph",icon:"share alternate",content:"Graph"},render:function(){return Object(Z.jsx)(ce.a.Pane,{attached:!1,children:gt})}},{menuItem:{key:"Bookmarks",icon:"bookmark",content:"Bookmarks"},render:function(){return Object(Z.jsx)(ce.a.Pane,{attached:!1,children:mt})}}];return Object(Z.jsx)("div",{className:De,id:"prov-vis",style:{overflowX:"auto",overflowY:"auto"},children:Object(Z.jsx)(ce.a,{menu:{secondary:!0,pointing:!0},panes:vt})})}));function Me(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return"translate(".concat(e,", ").concat(t,")")}function Pe(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{transform:Me(-n/2,-n/2),children:Object(Z.jsx)("svg",{height:n,viewBox:"0 0 141.75 141.75",width:n,children:Object(Z.jsxs)("g",{id:"Layer 1",children:[Object(Z.jsx)("path",{d:"M0+141.75L141.069+0.305731",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),Object(Z.jsx)("path",{d:"M76.2578+103.486L90.5601+114.114C90.5601+114.114+99.8156+137.498+74.2147+137.498C53.7829+137.498+48.8808+110.711+49.6965+109.863C49.6965+109.863+60.7858+122.325+61.9556+116.24C63.9988+105.611+76.2578+103.486+76.2578+103.486ZM127.585+49.613C127.308+49.6166+127.031+49.6388+126.751+49.6794C124.356+50.0268+121.717+51.7745+118.137+55.3776L84.3591+88.0407C84.3585+88.0411+84.3578+88.0402+84.3573+88.0407C82.4109+89.8348+81.776+93.0922+82.5535+96.6415C83.3425+100.243+85.4619+103.608+88.3851+105.635C91.2896+107.65+95.1882+108.221+99.2129+107.403C103.001+106.633+106.521+104.693+108.654+102.179C108.654+102.179+108.653+102.178+108.654+102.177C108.654+102.177+108.655+102.178+108.655+102.177L134.486+66.7279C134.487+66.7273+134.486+66.7266+134.486+66.726C136.375+63.9384+137.395+61.4407+137.462+59.166C137.537+56.6101+136.4+54.3632+133.911+52.4215C131.424+50.4808+129.522+49.5881+127.585+49.613Z",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),Object(Z.jsx)("path",{d:"M17.5647+7.49443L61.7224+7.49443C66.5892+7.49443+70.5345+12.5807+70.5345+18.8549L70.5345+50.7774C70.5345+57.0516+66.5892+62.1379+61.7224+62.1379L17.5647+62.1379C12.6979+62.1379+8.75258+57.0516+8.75258+50.7774L8.75258+18.8549C8.75258+12.5807+12.6979+7.49443+17.5647+7.49443Z",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"})]})})})]})}function ze(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{children:Object(Z.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf0b0"})})]})}function Ae(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{children:Object(Z.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf057"})})]})}function Le(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{children:Object(Z.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf044"})})]})}function We(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{children:Object(Z.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf042"})})]})}function Be(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{transform:Me(-n/2,-n/2),children:Object(Z.jsx)("svg",{height:n,viewBox:"0 0 141.75 141.75",width:n,children:Object(Z.jsxs)("g",{id:"Layer 1",children:[Object(Z.jsx)("path",{d:"M11.34-11.34L11.6801+130.41L153.09+130.41",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"miter",strokeWidth:"25"}),Object(Z.jsx)("path",{d:"M41.0944+103.248C41.0944+96.3307+46.8061+90.7234+53.8519+90.7234C60.8977+90.7234+66.6094+96.4351+66.6094+103.481C66.6094+110.527+60.8977+116.238+53.8519+116.238C46.8061+116.238+41.0944+110.165+41.0944+103.248Z",fill:c,opacity:"1"}),Object(Z.jsx)("path",{d:"M28.3369+70.6417C28.3369+63.7248+34.0486+58.1175+41.0944+58.1175C48.1402+58.1175+53.8519+63.8292+53.8519+70.875C53.8519+77.9208+48.1402+83.6325+41.0944+83.6325C34.0486+83.6325+28.3369+77.5587+28.3369+70.6417Z",fill:c,opacity:"1"}),Object(Z.jsx)("path",{d:"M66.6094+83.3992C66.6094+76.4823+72.3211+70.875+79.3669+70.875C86.4127+70.875+92.1244+76.5867+92.1244+83.6325C92.1244+90.6783+86.4127+96.39+79.3669+96.39C72.3211+96.39+66.6094+90.3162+66.6094+83.3992Z",fill:c,opacity:"1"}),Object(Z.jsx)("path",{d:"M53.8519+57.8842C53.8519+50.9673+59.5636+45.36+66.6094+45.36C73.6552+45.36+79.3669+51.0717+79.3669+58.1175C79.3669+65.1633+73.6552+70.875+66.6094+70.875C59.5636+70.875+53.8519+64.8012+53.8519+57.8842Z",fill:c,opacity:"1"}),Object(Z.jsx)("path",{d:"M101.341+31.4476C101.341+24.5307+107.053+18.9234+114.098+18.9234C121.144+18.9234+126.856+24.6352+126.856+31.6809C126.856+38.7267+121.144+44.4384+114.098+44.4384C107.053+44.4384+101.341+38.3646+101.341+31.4476Z",fill:c,opacity:"1"}),Object(Z.jsx)("path",{d:"M90.001+31.2403C90.001+18.175+100.79+7.58342+114.098+7.58342C127.407+7.58342+138.196+18.3722+138.196+31.6809C138.196+44.9896+127.407+55.7784+114.098+55.7784C100.79+55.7784+90.001+44.3056+90.001+31.2403Z",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"})]})})})]})}function Fe(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{children:Object(Z.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf0eb"})})]})}function Ee(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{children:Object(Z.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf5cb"})})]})}function Re(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{children:Object(Z.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf12d"})})]})}function Ge(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{children:Object(Z.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf1fc"})})]})}function Ie(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{transform:Me(-n/2,-n/2),children:Object(Z.jsx)("svg",{height:n,viewBox:"0 0 141.75 141.75",width:n,children:Object(Z.jsxs)("g",{id:"Layer 1",children:[Object(Z.jsx)("path",{d:"M11.34-11.34L11.6801+130.41L153.09+130.41",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"miter",strokeWidth:"25"}),Object(Z.jsx)("path",{d:"M77.7957+28.35L77.7957+99.225",fill:"none",opacity:"1",stroke:c,strokeLinecap:"butt",strokeLinejoin:"round",strokeWidth:"25"}),Object(Z.jsx)("path",{d:"M113.4+63.8289L42.525+63.7875",fill:"none",opacity:"1",stroke:c,strokeLinecap:"butt",strokeLinejoin:"round",strokeWidth:"25"})]})})})]})}function Te(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{children:Object(Z.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf0ce"})})]})}function Ke(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{transform:Me(-n/2,-n/2),children:Object(Z.jsx)("svg",{height:n,viewBox:"0 0 141.75 141.75",width:n,children:Object(Z.jsxs)("g",{id:"Layer 1",children:[Object(Z.jsx)("path",{d:"M70.875+133.084C94.2246+133.264+117.574+113.829+117.574+87.3323C117.574+60.8354+117.574+0+117.574+0",fill:"none",opacity:"1",stroke:c,strokeLinecap:"butt",strokeLinejoin:"round",strokeWidth:"15"}),Object(Z.jsx)("path",{d:"M70.875+133.084C47.5254+133.264+24.1758+113.829+24.1758+87.3323C24.1758+60.8354+24.1758+0+24.1758+0",fill:"none",opacity:"1",stroke:c,strokeLinecap:"butt",strokeLinejoin:"round",strokeWidth:"15"})]})})})]})}function _e(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{children:Object(Z.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf61f"})})]})}function He(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{transform:Me(-n/2,-n/2),children:Object(Z.jsx)("svg",{height:n,viewBox:"0 0 141.75 141.75",width:n,children:Object(Z.jsxs)("g",{id:"Layer 1",children:[Object(Z.jsx)("path",{d:"M76.8252+103.165L90.6711+113.451C90.6711+113.451+99.6313+136.08+74.8472+136.08C55.0673+136.08+50.3216+110.158+51.1113+109.337C51.1113+109.337+61.8468+121.397+62.9792+115.508C64.9572+105.222+76.8252+103.165+76.8252+103.165ZM126.515+51.0305C126.247+51.0339+125.979+51.0555+125.708+51.0948C123.388+51.431+120.834+53.1223+117.368+56.6091L84.6679+88.2186C84.6674+88.219+84.6667+88.2181+84.6662+88.2186C82.7819+89.9548+82.1673+93.1071+82.92+96.5419C83.6838+100.027+85.7355+103.283+88.5655+105.246C91.3773+107.195+95.1515+107.748+99.0478+106.956C102.715+106.212+106.122+104.333+108.187+101.901C108.188+101.9+108.187+101.9+108.187+101.899C108.188+101.899+108.189+101.9+108.189+101.899L133.196+67.5932C133.196+67.5927+133.195+67.592+133.196+67.5915C135.024+64.8937+136.012+62.4766+136.077+60.2753C136.149+57.8019+135.048+55.6274+132.639+53.7484C130.231+51.8702+128.39+51.0064+126.515+51.0305Z",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),Object(Z.jsx)("path",{d:"M7.0875+29.2572L49.6125+29.2572",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12.58"}),Object(Z.jsx)("path",{d:"M28.4705+8.505L28.35+51.03",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12.58"}),Object(Z.jsx)("path",{d:"M28.4705+72.2925L70.9955+29.7675",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"5"}),Object(Z.jsx)("path",{d:"M58.1175+62.3878L58.1175+62.3878L70.0025+62.3878L93.555+62.3878",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12.58"})]})})})]})}function Ve(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("circle",{fill:"white",r:n-n/4}),Object(Z.jsx)("g",{children:Object(Z.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf61f"})})]})}Object(p.configure)({isolateGlobalState:!0});var Je=n(627),Ue=n(628),Ye=n(629),Xe=n(187),Ze=n(128),qe=n(329),Qe=n.n(qe),$e=n(240),et=n.n($e),tt=n(659),nt=n(630),rt=n(340),ct=n(127),it=n(626),at=n(222),ot=n.n(at),st=n(328),lt=n.n(st),dt=n(272),ut=n(271),jt=Object(u.a)((function(e){return Object(K.a)({formControl:{margin:e.spacing(1),width:200}})}));var ht=function(e,t,n,r,c,a){var o=jt(),s=Object(i.useState)(n),l=Object(P.a)(s,2),d=l[0],u=l[1],j=function(e){var t=e.target.value;a?a(t):u(t)};return{selected:d,Dropdown:function(){return Object(Z.jsxs)(Xe.a,{className:o.formControl,variant:"outlined",children:[Object(Z.jsx)(dt.a,{id:e,children:t}),Object(Z.jsx)(ut.a,{id:"".concat(e,"-select"),label:t,labelId:e,value:c||d,onChange:j,children:r.map((function(e){return Object(Z.jsx)(ct.a,{value:e.key,children:e.desc},e.key)}))})]})},setSelected:u}},bt=Object(u.a)((function(e){return Object(K.a)({divSpacing:{margin:e.spacing(1)},center:{justifyContent:"center"}})})),ft=Object(b.a)((function(){var e=bt(),t=Object(i.useState)(null),n=Object(P.a)(t,2),r=n[0],c=n[1],a=Object(i.useContext)(T).exploreStore,o=a.loadedDataset,s=a.addPlot,l=(null===o||void 0===o?void 0:o.numericColumns.map((function(e){return{key:e,desc:"".concat((null===o||void 0===o?void 0:o.columnInfo[e].fullname)||""," (").concat((null===o||void 0===o?void 0:o.columnInfo[e].unit)||"",")")}})))||[],d=ht("x-axis-dropdown","X Axis","",l),u=d.selected,j=d.Dropdown,h=d.setSelected,b=ht("y-axis-dropdown","Y Axis","",l),f=b.selected,p=b.Dropdown,x=b.setSelected,O=Object(i.useCallback)((function(){c(null)}),[]),m=Object(i.useCallback)((function(){var e={id:D(),x:u,y:f};s(e),h(""),x(""),O()}),[h,x,u,f,s,O]);return Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)("div",{className:e.divSpacing,children:Object(Z.jsx)(Ze.a,{color:"primary",startIcon:Object(Z.jsx)(ot.a,{}),variant:"contained",onClick:function(e){c(e.currentTarget)},children:"Add Plot"})}),Object(Z.jsxs)(rt.a,{anchorEl:r,open:Boolean(r),onClose:O,children:[Object(Z.jsx)(ct.a,{button:!1,children:Object(Z.jsx)(j,{})}),Object(Z.jsx)(ct.a,{button:!1,children:Object(Z.jsx)(p,{})}),Object(Z.jsx)(ct.a,{button:!1,selected:!1,divider:!0}),Object(Z.jsx)(ct.a,{alignItems:"center",button:!1,children:Object(Z.jsxs)(it.a,{className:e.center,fullWidth:!0,children:[Object(Z.jsx)(U.a,{color:"primary",disabled:!(u&&f),onClick:m,children:Object(Z.jsx)(lt.a,{})}),Object(Z.jsx)(U.a,{color:"secondary",onClick:function(){h(""),x(""),c(null)},children:Object(Z.jsx)(X.a,{})})]})})]})]})})),pt=Object(u.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120},formControlwoWidth:{margin:e.spacing(1)}}})),xt=function(){var e=pt(),t=Object(i.useContext)(T).exploreStore,n=t.brushType,r=t.switchBrush,c=t.filter;return Object(Z.jsx)("div",{children:Object(Z.jsx)(Je.a,{color:"transparent",position:"static",children:Object(Z.jsxs)(Ue.a,{children:[Object(Z.jsx)(ft,{}),Object(Z.jsx)(Ye.a,{orientation:"vertical",flexItem:!0}),Object(Z.jsx)(Xe.a,{className:e.formControl,children:Object(Z.jsxs)(tt.a,{value:n,exclusive:!0,onChange:function(e,t){r(t)},children:[Object(Z.jsx)(nt.a,{value:"Rectangular",children:Object(Z.jsx)(Qe.a,{})}),Object(Z.jsx)(nt.a,{value:"Freeform Small",children:Object(Z.jsx)(et.a,{fontSize:"small"})}),Object(Z.jsx)(nt.a,{value:"Freeform Medium",children:Object(Z.jsx)(et.a,{})}),Object(Z.jsx)(nt.a,{value:"Freeform Large",children:Object(Z.jsx)(et.a,{fontSize:"large"})})]})}),Object(Z.jsx)(Ye.a,{}),Object(Z.jsx)(Ze.a,{color:"primary",variant:"outlined",onClick:function(){c("Out")},children:"Filter Out"}),Object(Z.jsx)(Ze.a,{color:"primary",variant:"outlined",onClick:function(){c("In")},children:"Filter In"})]})})})};xt.whyDidYouRender={logOnDifferentValues:!0};var Ot=Object(b.a)(xt),mt=n(139),gt=n(631),vt=n(632),yt=n(633),kt=n(634),wt=n(635),St=n(636),Ct=n(268),Dt=n(332),Nt=n.n(Dt),Mt=n(330),Pt=n.n(Mt),zt=n(3),At="rgb(254, 95, 85)",Lt="rgb(89, 205, 144)",Wt="rgb(250, 192, 94)",Bt="rgb(244,106,15)",Ft=Object(u.a)((function(){return Object(K.a)({common:{fill:"rgb(168,211,238)"},foreground:{opacity:.9},background:{opacity:.3},label:{fill:"black"}})})),Et=Object(b.a)((function(e){var t=e.rank,n=e.height,r=void 0===n?45:n,c=e.label,a=void 0===c?t.toFixed(2):c,o=Ft(),s=Object(i.useRef)(null),l=Object(i.useState)(0),d=Object(P.a)(l,2),u=d[0],j=d[1];Object(i.useEffect)((function(){if(s.current){var e=s.current.getBoundingClientRect();u!==e.width&&j(e.width)}}),[u]);var h=Object(i.useMemo)((function(){return Object(te.h)().domain([0,1]).range([0,u])}),[u]);return Object(Z.jsxs)("svg",{ref:s,height:r,width:"100%",children:[Object(Z.jsx)("rect",{className:Object(zt.a)(o.common,o.background),height:r,width:u}),Object(Z.jsx)("rect",{className:Object(zt.a)(o.common,o.foreground),height:r,width:h(t)}),Object(Z.jsx)(mt.a,{className:o.label,component:"text",dominantBaseline:"middle",textAnchor:"start",transform:Me(.05*u,r/2),variant:"button",children:a})]})})),Rt=Object(u.a)((function(){return Object(K.a)({centerContainer:{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},table:{tableLayout:"auto"}})})),Gt=Object(b.a)((function(){var e=Rt(),t=Object(i.useContext)(T).exploreStore,n=t.predictions,r=t.setPredictionSelection,c=t.setHoveredPrediction,a=t.isLoadingPredictions,o=Object(i.useMemo)((function(){return Pt()(c,500)}),[c]);return a?Object(Z.jsxs)("div",{className:e.centerContainer,children:[Object(Z.jsx)(H.a,{}),Object(Z.jsx)(mt.a,{variant:"button",children:"Computing Predictions"})]}):0===n.length?Object(Z.jsx)("div",{className:e.centerContainer,children:Object(Z.jsx)(mt.a,{variant:"button",children:"Please make a selection"})}):Object(Z.jsx)("div",{style:{overflow:"scroll",padding:"1em"},children:Object(Z.jsx)(gt.a,{component:J.a,children:Object(Z.jsxs)(vt.a,{className:e.table,children:[Object(Z.jsx)(yt.a,{children:Object(Z.jsxs)(kt.a,{children:[Object(Z.jsx)(wt.a,{align:"center",style:{fontWeight:"bold",fill:"#F2",fontSize:"18px",fontFamily:"Lato, Helvetica Neue,Arial,Helvetica,sans-serif"},width:"90%",children:"Selection Predictions"}),Object(Z.jsx)(wt.a,{width:"10%"})]})}),Object(Z.jsx)(St.a,{children:n.map((function(e){return Object(Z.jsxs)(kt.a,{hover:!0,onMouseOut:function(){o(null)},onMouseOver:function(){o(e)},children:[Object(Z.jsx)(Ct.a,{title:e.description,children:Object(Z.jsx)(wt.a,{width:"90%",children:Object(Z.jsx)(Et,{label:"".concat(e.intent," (").concat(e.rank.toFixed(2),")"),rank:e.rank})})}),Object(Z.jsx)(wt.a,{width:"10%",children:Object(Z.jsx)(U.a,{onClick:function(){return r(e)},children:Object(Z.jsx)(Nt.a,{})})})]},e.hash)}))})]})})})})),It=n(656),Tt=n(558),Kt=n(559),_t=Object(u.a)((function(){return Object(K.a)({base:{fill:"green",opacity:.1,stroke:"black",strokeWidth:2,cursor:"move","&:hover":{strokeWidth:5}},closeIconText:{fontWeight:"bolder",fontFamily:"FontAwesome",fontSize:"1.5rem",fill:"red"},closeIconBackground:{cursor:"pointer",fill:"#777",opacity:"0.1"},resizeBase:{pointerEvents:"all",fill:"none",stroke:"none"},ns:{cursor:"ns-resize"},ew:{cursor:"ew-resize"},nwse:{cursor:"nwse-resize"},nesw:{cursor:"nesw-resize"}})})),Ht=function(e){var t=e.id,n=e.x,r=e.y,c=e.height,a=e.width,o=e.onMouseDown,s=e.onResizeStart,l=e.closeHandler,d=e.resizeHandlerSize,u=void 0===d?10:d,j=Object(i.useState)(!1),h=Object(P.a)(j,2),b=h[0],f=h[1],p=Object(i.useState)(-1),x=Object(P.a)(p,2),O=x[0],m=x[1],g=_t(),v=g.base,y=g.resizeBase,k=g.ns,w=g.ew,S=g.nwse,C=g.nesw,D=g.closeIconText,N=g.closeIconBackground;Object(i.useEffect)((function(){return function(){return clearInterval(O)}}));var M=Object(Z.jsx)("rect",{className:v,height:c,width:a,onMouseDown:function(e){o(e,t)},onMouseEnter:function(){clearInterval(O),f(!0)},onMouseLeave:function(){var e=setTimeout((function(){f(!1)}),900);m(e)}}),z=Object(Z.jsx)("rect",{className:Object(zt.a)(y,k),height:u,width:a-u,x:u/2,y:-u/2,onMouseDown:function(){return s(t,"N")}}),A=Object(Z.jsx)("rect",{className:Object(zt.a)(y,k),height:u,width:a-u,x:u/2,y:c-u/2,onMouseDown:function(){return s(t,"S")}}),L=Object(Z.jsx)("rect",{className:Object(zt.a)(y,w),height:c-u,width:u,x:-u/2,y:u/2,onMouseDown:function(){return s(t,"W")}}),W=Object(Z.jsx)("rect",{className:Object(zt.a)(y,w),height:c-u,width:u,x:a-u/2,y:u/2,onMouseDown:function(){return s(t,"E")}}),B=Object(Z.jsx)("rect",{className:Object(zt.a)(y,S),height:u,width:u,x:-u/2,y:-u/2,onMouseDown:function(){return s(t,"NW")}}),F=Object(Z.jsx)("rect",{className:Object(zt.a)(y,C),height:u,width:u,x:a-u/2,y:-u/2,onMouseDown:function(){return s(t,"NE")}}),E=Object(Z.jsx)("rect",{className:Object(zt.a)(y,C),height:u,width:u,x:-u/2,y:c-u/2,onMouseDown:function(){return s(t,"SW")}}),R=Object(Z.jsx)("rect",{className:Object(zt.a)(y,S),height:u,width:u,x:a-u/2,y:c-u/2,onMouseDown:function(){return s(t,"SE")}});return Object(Z.jsxs)("g",{transform:Me(n,r),children:[M,z,A,L,W,B,F,E,R,Object(Z.jsxs)("g",{display:b?"visible":"none",transform:Me(a,-10),children:[Object(Z.jsx)("text",{className:D,dominantBaseline:"middle",dy:"1",textAnchor:"middle",children:"\uf05e"}),Object(Z.jsx)("circle",{className:N,fill:"none",r:"10",stroke:"black",onClick:function(){return l(t)}})]})]})};var Vt=function(e){var t=e.left,n=e.right,r=e.top,c=e.bottom,a=e.brushes,o=e.xScale,s=e.yScale,l=e.data,d=e.onBrushHandler,u=e.disableBrush,j=void 0!==u&&u,h=Object(i.useRef)(null),b=Object(i.useState)(!1),f=Object(P.a)(b,2),p=f[0],x=f[1],O=Object(i.useState)(!1),m=Object(P.a)(O,2),g=m[0],v=m[1],y=Object(i.useState)(!1),k=Object(P.a)(y,2),w=k[0],S=k[1],C=Object(i.useState)(null),D=Object(P.a)(C,2),N=D[0],M=D[1],A=Object(i.useState)(null),L=Object(P.a)(A,2),W=L[0],B=L[1],F=Object(i.useState)(null),E=Object(P.a)(F,2),R=E[0],G=E[1],I=[Math.abs(r-c),Math.abs(t-n)],T=I[0],K=I[1],_=Object(i.useMemo)((function(){var e=s.copy().domain(s.domain()).range(s.range()),t=function(e){return o(e)},n=function(t){return e(t)},r=function(e){return o.invert(e)},c=function(t){return e.invert(t)};return{dataX:r,dataY:c,pixelX:t,pixelY:n,extentToPixel:function(e){var r=e.x1,c=e.x2,i=e.y1,a=e.y2;return{x1:t(r),x2:t(c),y1:n(i),y2:n(a)}},extentToData:function(e){var t=e.x1,n=e.y1,i=e.x2,a=e.y2;return{x1:r(t),x2:r(i),y1:c(n),y2:c(a)}}}}),[o,s]),H=_.pixelX,V=_.pixelY,J=_.extentToData,U=_.extentToPixel,Y=function(e,t,n,r){var c=e.left,a=e.top,o=e.right,s=e.bottom,l=Object(i.useMemo)((function(){return Object(te.g)().extent([[c-1,a-1],[o+1,s+1]]).x((function(e){return n(e.x)})).y((function(e){return r(e.y)})).addAll(t)}),[c,a,o,s,t,n,r]);return{search:function(e,t,c,i){var a=[];return l.visit((function(o,s,l,d,u){var j,h,b,f;if(h=[[s,l],[d,u]],!((j=[[e,t],[c,i]])[0][0]<=h[1][0]&&h[0][0]<=j[1][0]&&j[0][1]<=h[1][1]&&h[0][1]<=j[1][1]))return!0;if(!o.length){var p=o;do{var x=p.data;f=[n(x.x),r(x.y)],(b=[[e,t],[c,i]])[0][0]<=f[0]&&f[0]<=b[1][0]&&b[0][1]<=f[1]&&f[1]<=b[1][1]&&a.push(x.id)}while(p=p.next)}return!1})),a}}}({left:t,top:r,right:n,bottom:c},l,o,s).search,X=Object(i.useCallback)((function(e,t,n){if(!j){var r={};Object.values(e).forEach((function(e){var t=e.extents,n=t.x1,c=t.x2,i=t.y1,a=t.y2,o=Y(H(n),V(a),H(c),V(i));r[e.id]=o})),d(r,e,t,n)}}),[d,Y,j,H,V]),q=Object(i.useCallback)((function(e){if(!a[e])throw new Error("Brush does not exist");delete a[e],X(Object(z.a)({},a),"Remove",e)}),[a,X]),Q=Object(i.useCallback)((function(e){var t=e.currentTarget.getBoundingClientRect(),n=J({x1:e.clientX-t.left,x2:e.clientX-t.left,y1:e.clientY-t.top,y2:e.clientY-t.top}),r={id:"brush".concat((new Date).getTime().toString()),extents:n};x(!0),B(r)}),[J]),$=Object(i.useCallback)((function(e){var t=h.current;if(t&&W){var n=t.getBoundingClientRect(),r=n.left,c=n.top,i=U(W.extents),a=i.x1,o=i.y2,s=e.clientX-r,l=e.clientY-c;W.extents=J({x1:a,x2:s,y1:l,y2:o}),B(Object(z.a)({},W))}}),[W,J,U]),ee=Object(i.useCallback)((function(){if(W){var e=W.extents,t=e.x1,n=e.x2,r=e.y1,c=e.y2;if(!(Math.abs(t-n)<1e-5||Math.abs(r-c)<1e-5)){if(t>n){var i=[n,t];t=i[0],n=i[1]}if(r>c){var o=[c,r];r=o[0],c=o[1]}W.extents=Jt({x1:t,x2:n,y1:r,y2:c}),a[W.id]=W,X(Object(z.a)({},a),"Add",W.id)}B(null),x(!1)}}),[W,a,X]),ne=Object(i.useCallback)((function(e,t){var n=h.current;if(n&&!p){var r=a[t];if(!r)throw new Error("Something went wrong! Brush does not exist.");var c=n.getBoundingClientRect(),i=c.left,o=c.top,s=U(r.extents),l=s.x1,d=s.y2,u=e.clientX-i,j=e.clientY-o,b=[Math.abs(u-l),Math.abs(j-d)];G({x:b[0],y:b[1]}),B(r),v(!0)}}),[a,p,U]),re=Object(i.useCallback)((function(e){var t=h.current;if(t&&W&&R){var n=U(W.extents),r=n.x1,c=n.x2,i=n.y1,a=n.y2,o=[Math.abs(a-i),Math.abs(c-r)],s=o[0],l=o[1],d=R.x,u=R.y,j=t.getBoundingClientRect(),b=j.left,f=j.top,p=e.clientX-b-d,x=e.clientY-f-u;p<0&&(p=0),p+l>K&&(p=K-l),x<0&&(x=0),x+s>T&&(x=T-s),r=p,c=p+l,a=x,i=x+s,B(Object(z.a)(Object(z.a)({},W),{},{extents:J({x1:r,x2:c,y1:i,y2:a})}))}}),[W,R,U,J,T,K]),ce=Object(i.useCallback)((function(){W&&(a[W.id]=W,X(Object(z.a)({},a),"Update",W.id),B(null),v(!1))}),[W,a,X]),ie=Object(i.useCallback)((function(e,t){var n=a[e];if(!n)throw new Error("Something went wrong! Brush does not exist.");B(n),S(!0),M(t)}),[a]),ae=Object(i.useCallback)((function(e){var t=h.current;if(t&&W&&N){var n=t.getBoundingClientRect(),r=n.left,c=n.top,i=U(W.extents),a=i.x1,o=i.x2,s=i.y1,l=i.y2;switch(N){case"N":l=e.clientY-c;break;case"S":s=e.clientY-c;break;case"W":a=e.clientX-r;break;case"E":o=e.clientX-r;break;case"NW":a=e.clientX-r,l=e.clientY-c;break;case"NE":l=e.clientY-c,o=e.clientX-r;break;case"SW":a=e.clientX-r,s=e.clientY-c;break;case"SE":s=e.clientY-c,o=e.clientX-r;break;default:throw new Error("Wrong Resize Direction")}W.extents=J({x1:a,x2:o,y1:s,y2:l}),B(Object(z.a)({},W))}}),[W,N,U,J]),oe=Object(i.useCallback)((function(){W&&(W.extents=Jt(W.extents),a[W.id]=W,X(Object(z.a)({},a),"Update",W.id),B(null),M(null),S(!1))}),[W,a,X]);Object(i.useEffect)((function(){if(p||g||w)return p&&(window.addEventListener("mousemove",$),window.addEventListener("mouseup",ee)),g&&(window.addEventListener("mousemove",re),window.addEventListener("mouseup",ce)),w&&(window.addEventListener("mousemove",ae),window.addEventListener("mouseup",oe)),function(){p&&(window.removeEventListener("mousemove",$),window.removeEventListener("mouseup",ee)),g&&(window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",ce)),w&&(window.removeEventListener("mousemove",ae),window.removeEventListener("mouseup",oe))}}),[p,$,ee,g,re,ce,w,oe,ae]);var se=Object(i.useCallback)((function(){if(!W)return Object(Z.jsx)("g",{});var e=Jt(U(W.extents)),t=e.x1,n=e.x2,r=e.y1,c=e.y2;return Object(Z.jsx)(Ht,{closeHandler:q,height:c-r,id:W.id,width:n-t,x:t,y:r,onMouseDown:ne,onResizeStart:ie})}),[W,ne,ie,q,U]),le=Object(Z.jsx)("rect",{ref:h,cursor:j?"default":"crosshair",fill:"none",height:T,pointerEvents:j?"none":"all",width:K,onMouseDown:Q}),de=Object.values(a);W&&(de=de.filter((function(e){return e.id!==W.id})));var ue=Object(Z.jsxs)("g",{children:[se(),Object.values(de).map((function(e){var t=U(e.extents),n=t.x1,r=t.x2,c=t.y1,i=t.y2;return Object(Z.jsx)(Ht,{closeHandler:q,height:c-i,id:e.id,width:r-n,x:n,y:i,onMouseDown:ne,onResizeStart:ie},e.id)}))]}),je=p?[ue,le]:[le,ue],he=Object(P.a)(je,2),be=he[0],fe=he[1];return Object(Z.jsxs)("g",{id:"brush-component",children:[be,fe]})};function Jt(e){var t=e.x1,n=e.x2,r=e.y1,c=e.y2;if(n<t){var i=[n,t];t=i[0],n=i[1]}if(c<r){var a=[c,r];r=a[0],c=a[1]}return{x1:t,x2:n,y1:r,y2:c}}var Ut=Object(u.a)({newColor:{stroke:"blue !important",fill:"blue !important"},removedColor:{stroke:"red !important"},newMark:{strokeWidth:"1",fill:"black"},removedMark:{stroke:"black",strokeWidth:"3",strokeLinecap:"round",fill:"black"},movedLine:{opacity:"0.2 !important",stroke:"black",fill:"black",strokeWidth:"1",strokeLinecap:"round"},movedPoint:{fill:"gray !important"},regularMark:{fill:"black"},nonUnionMark:{fill:"rgb(44, 127, 184)"},unionMark:{fill:Bt,stroke:Bt},regularForceMark:{fill:"black !important",opacity:.2},intermittentHighlight:{fill:"red"},matches:{fill:"".concat(At," !important"),opacity:1},isnp:{fill:"".concat(Wt," !important"),opacity:1},ipns:{fill:"".concat(Lt," !important"),opacity:1}});function Yt(e,t,n,r){var c=Math.atan((e-t)/(n-r)),i=4.5*Math.cos(c),a=4.5*Math.sin(c);return"M ".concat(t+i," ").concat(r-a," \n  L ").concat(e," ").concat(n," \n  L ").concat(t-i," ").concat(r+a,"\n  z")}var Xt=Object(b.a)((function(e){var t=e.points,n=e.selectedPoints,r=e.xScale,c=e.yScale,a=e.compPoints,o=e.dataDisplay,s=Ut(),l=Object(i.useContext)(T).compareStore.updatedFilterPoints;return console.log(o),console.log(a),console.log(t),a&&"Original"!==o?"AddedOnly"===o?Object(Z.jsx)(Z.Fragment,{children:a.filter((function(e){return 0===t.filter((function(t){return t.label===e.label})).length&&!l.includes(e.id)})).map((function(e){return Object(Z.jsx)("g",{className:"marks ".concat(s.newMark," ").concat(n.includes(e.id)?s.unionMark:s.regularMark," ").concat(0===n.length?s.newColor:""),id:"mark".concat(e.id),opacity:"0.5",transform:"translate(".concat(r(e.x)-5,", ").concat(c(e.y)-5,")"),children:Object(Z.jsx)("polygon",{points:"0 0, 5 10, 10 0"})},e.label)}))}):"ChangedOnly"===o?Object(Z.jsx)(Z.Fragment,{children:t.map((function(e){if(null!==a){var t=a.filter((function(t){return t.label===e.label&&(t.x!==e.x||t.y!==e.y)}));if(t.length>0)return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("path",{className:"marks ".concat(s.movedLine," ").concat(n.includes(e.id)?s.unionMark:s.regularMark),d:Yt(r(e.x),r(t[0].x),c(e.y),c(t[0].y)),style:{opacity:"0.4"}}),Object(Z.jsx)("circle",{className:"marks ".concat(s.movedPoint," ").concat(n.includes(e.id)?s.unionMark:s.regularMark),cx:r(e.x),cy:c(e.y),id:"mark".concat(e.id),opacity:".2",r:"5"},e.label),Object(Z.jsx)("circle",{className:"marks ".concat(s.movedPoint," ").concat(n.includes(t[0].id)?s.unionMark:s.regularMark),cx:r(t[0].x),cy:c(t[0].y),id:"mark".concat(e.id),opacity:"1",r:"5"},t[0].label+"2")]})}return null}))}):"RemovedOnly"===o?Object(Z.jsx)(Z.Fragment,{children:t.map((function(e){return null!==a&&0===a.filter((function(t){return t.label===e.label})).length?Object(Z.jsxs)("g",{className:"marks ".concat(s.removedMark," ").concat(n.includes(e.id)?s.unionMark:s.regularMark," ").concat(0===n.length?s.removedColor:""),id:"mark".concat(e.id),opacity:"0.5",transform:"translate(".concat(r(e.x)-3,", ").concat(c(e.y)-3,")"),children:[Object(Z.jsx)("line",{x2:"6",y2:"6"}),Object(Z.jsx)("line",{x1:"6",y2:"6"})]},e.id):Object(Z.jsx)("g",{},e.id)}))}):"Comparison"===o?Object(Z.jsx)(Z.Fragment,{children:a.map((function(e){return Object(Z.jsx)("circle",{className:"marks ".concat(n.includes(e.id)?s.unionMark:s.regularMark),cx:r(e.x),cy:c(e.y),id:"mark".concat(e.id),opacity:"0.5",r:"5"},e.label)}))}):"Diff"===o?Object(Z.jsxs)(Z.Fragment,{children:[t.map((function(e){if(null!==a&&0===a.filter((function(t){return t.label===e.label})).length)return Object(Z.jsxs)("g",{className:"marks ".concat(s.removedMark," ").concat(n.includes(e.id)?s.unionMark:s.regularMark," ").concat(0===n.length?s.removedColor:""),id:"mark".concat(e.id),opacity:"0.5",transform:"translate(".concat(r(e.x)-3,", ").concat(c(e.y)-3,")"),children:[Object(Z.jsx)("line",{x2:"6",y2:"6"}),Object(Z.jsx)("line",{x1:"6",y2:"6"})]},e.label);if(null!==a){var t=a.filter((function(t){return t.label===e.label&&(t.x!==e.x||t.y!==e.y)}));if(t.length>0)return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("path",{className:"marks ".concat(s.movedLine," ").concat(n.includes(e.id)?s.unionMark:s.regularMark),d:Yt(r(e.x),r(t[0].x),c(e.y),c(t[0].y)),style:{opacity:"0.4"}}),Object(Z.jsx)("g",{className:"marks ".concat(s.movedPoint," ").concat(n.includes(e.id)?s.unionMark:s.regularMark),id:"mark".concat(e.id),opacity:"0.5",transform:"translate(".concat(r(e.x)-5,", ").concat(c(e.y)-5,")"),children:Object(Z.jsx)("polygon",{points:"0 5, 5 10, 10 5, 5 0"})},e.label),Object(Z.jsx)("g",{className:"marks ".concat(s.movedPoint," ").concat(n.includes(e.id)?s.unionMark:s.regularMark),id:"mark".concat(t[0].id),opacity:"0.5",transform:"translate(".concat(r(t[0].x)-5,", ").concat(c(t[0].y)-5,")"),children:Object(Z.jsx)("polygon",{points:"0 5, 5 10, 10 5, 5 0"})},t[0].label+"2")]})}return Object(Z.jsx)("circle",{className:"marks ".concat(n.includes(e.id)?s.unionMark:s.regularMark),cx:r(e.x),cy:c(e.y),id:"mark".concat(e.id),opacity:"0.1",r:"5"},e.label)})),a.filter((function(e){return 0===t.filter((function(t){return t.label===e.label})).length&&!l.includes(e.id)})).map((function(e){return Object(Z.jsx)("g",{className:"marks ".concat(s.newMark," ").concat(n.includes(e.id)?s.unionMark:s.regularMark," ").concat(0===n.length?s.newColor:""),id:"mark".concat(e.id),opacity:"0.5",transform:"translate(".concat(r(e.x)-5,", ").concat(c(e.y)-5,")"),children:Object(Z.jsx)("polygon",{points:"0 0, 5 10, 10 0"})},e.label)}))]}):Object(Z.jsxs)(Z.Fragment,{children:[t.map((function(e){if(null!==a&&0===a.filter((function(t){return t.label===e.label})).length)return Object(Z.jsx)(Ct.a,{title:Object(Z.jsx)("pre",{children:JSON.stringify(e,null,2)}),children:Object(Z.jsxs)("g",{className:"marks ".concat(s.removedMark," ").concat(n.includes(e.id)?s.unionMark:s.regularMark," ").concat(0===n.length?s.removedColor:""),id:"mark".concat(e.id),opacity:"0.5",transform:"translate(".concat(r(e.x)-3,", ").concat(c(e.y)-3,")"),children:[Object(Z.jsx)("line",{x2:"6",y2:"6"}),Object(Z.jsx)("line",{x1:"6",y2:"6"})]},e.label)},e.label);if(null!==a){var t=a.filter((function(t){return t.label===e.label&&(t.x!==e.x||t.y!==e.y)}));if(t.length>0)return Object(Z.jsx)(Ct.a,{title:Object(Z.jsx)("pre",{children:JSON.stringify(e,null,2)}),children:Object(Z.jsxs)("g",{children:[Object(Z.jsx)("path",{className:"marks ".concat(s.movedLine," ").concat(n.includes(e.id)?s.unionMark:s.regularMark),d:Yt(r(e.x),r(t[0].x),c(e.y),c(t[0].y)),style:{opacity:"0.4"}}),Object(Z.jsx)("circle",{className:"marks ".concat(s.movedPoint," ").concat(n.includes(e.id)?s.unionMark:s.regularMark),cx:r(e.x),cy:c(e.y),id:"mark".concat(e.id),opacity:".2",r:"5"},e.label),Object(Z.jsx)("circle",{className:"marks ".concat(s.movedPoint," ").concat(n.includes(t[0].id)?s.unionMark:s.regularMark),cx:r(t[0].x),cy:c(t[0].y),id:"mark".concat(e.id),opacity:"1",r:"5"},t[0].label+"2")]})},e.label)}return Object(Z.jsx)(Ct.a,{title:Object(Z.jsx)("pre",{children:JSON.stringify(e,null,2)}),children:Object(Z.jsx)("circle",{className:"marks ".concat(n.includes(e.id)?s.unionMark:s.regularMark),cx:r(e.x),cy:c(e.y),id:"mark".concat(e.id),opacity:"0.5",r:"5"},e.label)},e.label)})),a.filter((function(e){return 0===t.filter((function(t){return t.label===e.label})).length&&!l.includes(e.id)})).map((function(e){return Object(Z.jsx)(Ct.a,{title:Object(Z.jsx)("pre",{children:JSON.stringify(e,null,2)}),children:Object(Z.jsx)("g",{className:"marks ".concat(s.newMark," ").concat(n.includes(e.id)?s.unionMark:s.regularMark," ").concat(0===n.length?s.newColor:""),id:"mark".concat(e.id),opacity:"0.5",transform:"translate(".concat(r(e.x)-5,", ").concat(c(e.y)-5,")"),children:Object(Z.jsx)("polygon",{points:"0 0, 5 10, 10 0"})},e.label)},e.label)}))]}):Object(Z.jsx)(Z.Fragment,{children:t.map((function(e){return Object(Z.jsx)(Ct.a,{title:Object(Z.jsx)("pre",{children:JSON.stringify(e,null,2)}),children:Object(Z.jsx)("circle",{className:"marks ".concat(n.includes(e.id)?s.unionMark:s.regularMark," "),cx:r(e.x),cy:c(e.y),id:"mark".concat(e.id),opacity:"0.5",r:"5"},e.label)},e.id)}))})})),Zt=Object(u.a)((function(){return{brushStyle:{cursor:"grabbing",stroke:"gray",opacity:1,transition:"opacity 0.5s"},brushDown:{stroke:"rgb(244, 106, 15)"},brushHide:{opacity:0,transition:"opacity 0.5s"}}}));function qt(e,t,n){var r=Math.pow(n.x-e.x,2),c=Math.pow(n.y-e.y,2);return Math.sqrt(r+c)<=t}var Qt=Object(b.a)((function(e){var t=e.left,n=void 0===t?0:t,r=e.right,c=void 0===r?0:r,a=e.top,o=void 0===a?0:a,s=e.bottom,l=void 0===s?0:s,d=e.extentPadding,u=void 0===d?0:d,j=e.onBrush,h=e.xScale,b=e.yScale,f=e.brushSize,p=void 0===f?20:f,x=e.data,O=void 0===x?[]:x,m=Zt(),g=m.brushStyle,v=m.brushDown,y=m.brushHide,w=Object(i.useRef)(null),S=Object(i.useRef)(null),C=Object(i.useRef)([]),D=p||20,N=Object(i.useState)(!1),M=Object(P.a)(N,2),z=M[0],A=M[1],L=Object(i.useState)(!1),W=Object(P.a)(L,2),B=W[0],F=W[1],E=[Math.abs(l+u-(o-u)),Math.abs(n-u-(c+u))],R=E[0],G=E[1],I=function(e,t,n,r){var c=e.left,a=e.top,o=e.width,s=e.height,l=Object(i.useMemo)((function(){return Object(te.g)().extent([[c-1,a-1],[o+1,s+1]]).x((function(e){return n(e.x)})).y((function(e){return r(e.y)})).addAll(t)}),[c,a,o,s,t,n,r]);return{search:function(e,t,c){var i=e-c,a=e+c,o=t-c,s=t+c,d=[];return l.visit((function(l,u,j,h,b){if(!l.length){var f=l;do{var p=f,x=p.data,O=p.data,m=O.x,g=O.y;qt({x:e,y:t},c,{x:n(m),y:r(g)})&&d.push(x.id)}while(f=f.next)}return u>=a||j>=s||h<i||b<o})),d}}}({left:n,top:o,width:G,height:R},O,h,b).search;function T(){S.current&&(j(Array.from(new Set(C.current)),"End","Selection"),C.current=[]),F(!1)}function K(e){if(z){var t=w.current,n=S.current;if(t&&n){var r=n.getBoundingClientRect(),c=e.clientX-r.left,i=e.clientY-r.top,a=Object(te.i)(t),o=i+D>=R+10||i-D<=-10;if(c+D>=G+10||c-D<=-10||a.attr("cx",c),o||a.attr("cy",i),B){var s,l=I(c,i,D);(s=C.current).push.apply(s,Object(k.a)(l)),j(l,"Brushing","Selection")}}}}function _(){window.removeEventListener("mousemove",K),window.removeEventListener("mouseup",T)}return Object(i.useEffect)((function(){return window.addEventListener("mousemove",K),window.addEventListener("mouseup",T),_})),Object(Z.jsxs)("g",{transform:Me(-u,-u),onMouseDown:function(e){var t=S.current;if(t){var n=t.getBoundingClientRect(),r=e.clientX-n.left,c=e.clientY-n.top,i=I(r,c,D);C.current=i,j(i,"Start","Selection")}F(!0)},onMouseEnter:function(){return A(!0)},onMouseLeave:function(){B||A(!1)},children:[Object(Z.jsx)("rect",{ref:S,fill:"none",height:R,pointerEvents:"all",width:G}),Object(Z.jsx)("circle",{ref:w,className:"".concat(g," ").concat(B?v:""," ").concat(z?"":y),fill:"none",pointerEvents:B?"all":"initial",r:D,strokeWidth:"2"})]})}));function $t(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object(P.a)(e,2),c=r[0],a=r[1],o=Object(P.a)(t,2),s=o[0],l=o[1],d=Object(i.useMemo)((function(){var e=Object(te.h)().domain([c,a]).range([s,l]).clamp(!0);return n&&e.nice(),e}),[c,a,s,l,n]);return d}function en(e,t,n,r){var c=Object(i.useContext)(T).exploreStore,a=c.compDataset,o=c.origCompDataset,s=c.loadedDataset,l=c.workingValues,d=c.isComparison,u=Object(i.useContext)(T).projectStore,j=u.compDatasetValues,h=u.originaCompValues,b=u.currentComparisonDatasets;return Object(i.useMemo)((function(){var c,i;return r?(c=j.map((function(r){return{id:r.id,x:r[e],y:r[t],label:r[n]}}))||[],i=(null===a||void 0===a?void 0:a.values.map((function(r){return{id:r.id,x:r[e],y:r[t],label:r[n]}})))||[]):d&&b.length>1?(c=h.map((function(r){return{id:r.id,x:r[e],y:r[t],label:r[n]}}))||[],i=o.values.map((function(r){return{id:r.id,x:r[e],y:r[t],label:r[n]}}))||[]):(c=l.map((function(r){return{id:r.id,x:r[e],y:r[t],label:r[n]}}))||[],i=s.values.map((function(r){return{id:r.id,x:r[e],y:r[t],label:r[n]}}))||[]),{points:c,x_extents:Object(te.e)(i.map((function(e){return e.x}))),y_extents:Object(te.e)(i.map((function(e){return e.y})))}}),[j,r,e,t,n,l,s,a,o,h,d,b])}var tn=Object(b.a)((function(e){var t=e.scale,n=e.transform,r=void 0===n?"":n,c=e.type,a=e.columnName,o=Object(i.useRef)(null),s=Object(i.useContext)(T).exploreStore.loadedDataset.columnInfo,l=Object(i.useMemo)((function(){var e=null;switch(c){case"left":e=Object(te.b)(t);break;case"right":e=Object(te.c)(t);break;case"bottom":e=Object(te.a)(t);break;case"top":e=Object(te.d)(t)}return e.tickFormat((function(e){return e>=1e6?"".concat(e.toString()[0],"e").concat(e.toString().length-1):e>=5e5?"".concat(e/1e5,"M"):e>=1e3?"".concat(e/1e3,"K"):e.toString()})),e}),[t,c]);Object(i.useEffect)((function(){var e=o.current;e&&Object(te.i)(e).call(l)}),[l]);var d=Object(i.useMemo)((function(){switch(c){case"bottom":return Me(Math.max.apply(Math,Object(k.a)(t.range()))/2,35);case"top":return Me(Math.max.apply(Math,Object(k.a)(t.range()))/2,-35);case"left":return"".concat(Me(-40,Math.max.apply(Math,Object(k.a)(t.range()))/2),"rotate(270)");case"right":return"".concat(Me(40,Math.max.apply(Math,Object(k.a)(t.range()))/2),"rotate(90)")}}),[t,c]),u=s[a];return Object(Z.jsxs)("g",{transform:r,children:[Object(Z.jsx)("g",{ref:o}),Object(Z.jsxs)("text",{dominantBaseline:"middle",textAnchor:"middle",transform:d,children:[Object(Z.jsx)("tspan",{children:u.short})," ",Object(Z.jsx)("tspan",{children:"|"})," ",Object(Z.jsx)("tspan",{children:u.fullname})," ",u.unit&&Object(Z.jsxs)("tspan",{children:["(",u.unit,")"]})]})]})})),nn=Object(b.a)((function(e){var t=e.offset,n=void 0===t?0:t;return Object(Z.jsxs)("g",{transform:Me(n,-10),children:[Object(Z.jsxs)("g",{transform:Me(0,20),children:[Object(Z.jsx)("circle",{fill:At,r:"5"}),Object(Z.jsx)("text",{dominantBaseline:"middle",dx:"10",children:"Matches"})]}),Object(Z.jsxs)("g",{transform:Me(0,40),children:[Object(Z.jsx)("circle",{fill:Lt,r:"5"}),Object(Z.jsx)("text",{dominantBaseline:"middle",dx:"10",children:"Not Selected"})]}),Object(Z.jsxs)("g",{transform:Me(0,60),children:[Object(Z.jsx)("circle",{fill:Wt,r:"5"}),Object(Z.jsx)("text",{dominantBaseline:"middle",dx:"10",children:"Not Predicted"})]})]})})),rn=n(30),cn=Object(b.a)((function(e){var t=e.points,n=e.selectedPoints,r=e.xScale,c=e.yScale,a=Object(i.useContext)(T).exploreStore.hoveredPrediction,o=Ut(),s=(null===a||void 0===a?void 0:a.membership)||{},l=s.matches,d=void 0===l?[]:l,u=s.isnp,j=void 0===u?[]:u,h=s.ipns,b=void 0===h?[]:h;return Object(Z.jsx)(Z.Fragment,{children:t.map((function(e){var t;return Object(Z.jsx)(Ct.a,{title:Object(Z.jsx)("pre",{children:JSON.stringify(e,null,2)}),children:Object(Z.jsx)("circle",{className:Object(zt.a)("marks",(t={},Object(rn.a)(t,o.unionMark,n.includes(e.id)),Object(rn.a)(t,o.regularMark,!n.includes(e.id)),Object(rn.a)(t,o.regularForceMark,!!a),Object(rn.a)(t,o.matches,d.includes(e.id)),Object(rn.a)(t,o.isnp,j.includes(e.id)),Object(rn.a)(t,o.ipns,b.includes(e.id)),t)),cx:r(e.x),cy:c(e.y),id:"mark".concat(e.id),opacity:"0.5",r:"5"},e.label)},e.id)}))})})),an=Object(b.a)((function(e){var t=e.info,n=e.xScale,r=e.yScale,c=Object(i.useMemo)((function(){return Object(te.f)().x((function(e){return n(e[0])})).y((function(e){return r(e[1])}))}),[n,r]);return Object(Z.jsx)("g",{children:Object(Z.jsx)("path",{d:"".concat(c(t.hull),"Z")||!1,fill:"gray",opacity:"0.3",stroke:"black"})})})),on=Object(b.a)((function(e){var t=e.info,n=e.xScale,r=e.yScale,c=t.selected_center,a=Object(te.k)().type(te.r).size(64),o=Object(i.useMemo)((function(){return Object(te.f)().x((function(e){return n(e[0])})).y((function(e){return r(e[1])}))}),[n,r]);return Object(Z.jsxs)("g",{children:[Object(Z.jsx)("path",{d:a()||"",fill:"blue",opacity:"0.8",transform:Me(n(c[0]),r(c[1]))}),Object(Z.jsx)("path",{d:"".concat(o(t.hull),"Z")||!1,fill:"gray",opacity:"0.3",stroke:"black"})]})})),sn=Object(b.a)((function(e){var t=e.info,n=e.xScale,r=e.yScale,c=Object(i.useMemo)((function(){var e=t.coeff,c=t.intercept,i=t.threshold,a=n.copy().clamp(!1),o=r.copy().clamp(!1),s=n.domain(),l=Object(P.a)(s,2),d=l[0],u=l[1],j=n.domain().map((function(t){return t*e[0]+c})),h=Object(P.a)(j,2),b=h[0],f=h[1],p=n.domain().map((function(t){return t*e[0]+c-5*i})),x=Object(P.a)(p,2),O=x[0],m=x[1],g=n.domain().map((function(t){return t*e[0]+c+5*i})),v=Object(P.a)(g,2),y=v[0],k=v[1],w=[a(d),a(u),o(b),o(f),o(O),o(m),o(y),o(k)];return{x1:d=w[0],x2:u=w[1],y1:b=w[2],y2:f=w[3],oy1:O=w[4],oy2:m=w[5],ooy1:y=w[6],ooy2:k=w[7]}}),[n,r,t]),a=c.x1,o=c.x2,s=c.y1,l=c.y2,d=c.oy1,u=c.oy2,j=c.ooy1,h=c.ooy2;return Object(Z.jsxs)("g",{clipPath:"url(#clip)",children:[Object(Z.jsx)("line",{opacity:"0.4",stroke:"black",strokeWidth:"5px",x1:a,x2:o,y1:s,y2:l}),Object(Z.jsx)("line",{opacity:"0.2",stroke:"black",strokeWidth:"2px",x1:a,x2:o,y1:d,y2:u}),Object(Z.jsx)("line",{opacity:"0.2",stroke:"black",strokeWidth:"2px",x1:a,x2:o,y1:j,y2:h})]})})),ln=function(){return Object(Z.jsx)("defs",{children:Object(Z.jsx)("pattern",{height:"4",id:"pattern",patternTransform:"rotate(45)",patternUnits:"userSpaceOnUse",width:"4",children:Object(Z.jsx)("rect",{fill:"black",height:"4",opacity:"0.5",transform:"translate(0,0)",width:"2"})})})},dn=Object(u.a)((function(){return{lineBase:{strokeWidth:2,strokeOpacity:.3},line:{stroke:"black"},hatch:{strokeWidth:5,stroke:"url(#pattern)"}}})),un=Object(b.a)((function(e){var t=e.info,n=e.xScale,r=e.yScale,c=dn(),a=t.frontier,o=Object(P.a)(t.sense,2),s=o[0],l=o[1],d=Object(i.useMemo)((function(){return{scaled_frontier:a.map((function(e){return{x:n(e[0]),y:r(e[1])}}))}}),[n,r,a]).scaled_frontier,u=Object(i.useMemo)((function(){return{x_lines:Object(Z.jsx)("g",{className:"frontier-x",children:Object(k.a)(d).sort((function(e,t){return"max"===s?e.x-t.x:t.x-e.x})).map((function(e,t,r){var a="".concat(e.x,"-").concat(e.y),o=0,l=0,d=0,u=0;0===t?(o="max"===s?n.range()[0]:e.x,l="max"===s?e.x:n.range()[1],d=e.y,u=e.y):(o=r[t-1].x,l=e.x,d=e.y,u=e.y);return Object(Z.jsxs)(i.Fragment,{children:[Object(Z.jsx)("line",{className:Object(zt.a)(c.lineBase,c.line),x1:o,x2:l,y1:d,y2:u}),Object(Z.jsx)("line",{className:Object(zt.a)(c.lineBase,c.hatch),transform:Me(0,5),x1:o,x2:l,y1:d,y2:u})]},a)}))}),y_lines:Object(Z.jsx)("g",{children:Object(k.a)(d).sort((function(e,t){return"max"===l?e.y-t.y:t.y-e.y})).map((function(e,t,n){var a="".concat(e.x,"-").concat(e.y),o=0,s=0,d=0,u=0;if(t===n.length-1)o=e.x,s=e.x,d="max"===l?e.y:r.range()[1],u="max"===l?r.range()[0]:e.y;else{var j=n[t+1];o=e.x,s=e.x,d=e.y,u=j.y}return Object(Z.jsxs)(i.Fragment,{children:[Object(Z.jsx)("line",{className:Object(zt.a)(c.lineBase,c.line),x1:o,x2:s,y1:d,y2:u}),Object(Z.jsx)("line",{className:Object(zt.a)(c.lineBase,c.hatch),transform:Me(-5,0),x1:o,x2:s,y1:d,y2:u})]},a)}))})}}),[d,s,l,n,r,c]),j=u.x_lines,h=u.y_lines;return Object(Z.jsxs)("g",{children:[Object(Z.jsx)(ln,{}),j,h]})})),jn=Object(b.a)((function(e){var t=e.prediction,n=e.xScale,r=e.yScale,c=t.info;switch(console.log(JSON.parse(JSON.stringify(t))),t.algorithm){case"DBScan":switch(t.intent){case"Cluster":return Object(Z.jsx)(an,{info:c,xScale:n,yScale:r})}break;case"KMeans":return Object(Z.jsx)(on,{info:c,xScale:n,yScale:r});case"BNL":return Object(Z.jsx)(un,{info:c,xScale:n,yScale:r});case"LR":return Object(Z.jsx)(sn,{info:c,xScale:n,yScale:r})}return Object(Z.jsx)(Z.Fragment,{})})),hn=Object(u.a)((function(){return{lineBase:{strokeWidth:2,strokeOpacity:.3},line:{stroke:"black"},hatch:{strokeWidth:5,stroke:"url(#pattern)"}}})),bn=Object(b.a)((function(e){var t=e.height,n=void 0===t?25:t,r=e.lineHeight,c=void 0===r?n:r,i=e.width,a=void 0===i?150:i,o=e.transform,s=void 0===o?Me(0):o,l=hn(),d=c;return Object(Z.jsx)("g",{transform:s,children:Object(Z.jsxs)("g",{transform:Me(a/2,0),children:[Object(Z.jsx)("line",{className:Object(zt.a)(l.lineBase,l.line),x1:0,x2:0,y1:0,y2:d}),Object(Z.jsx)("line",{className:Object(zt.a)(l.lineBase,l.hatch),transform:Me(5,0),x1:0,x2:0,y1:0,y2:d}),Object(Z.jsxs)(mt.a,{component:"text",transform:Me(10,n/2),variant:"button",children:[Object(Z.jsx)("tspan",{x:"0",children:"Dominated"}),Object(Z.jsx)("tspan",{dy:"1em",x:"0",children:"Region"})]})]})})})),fn=Object(u.a)((function(){return Object(K.a)({root:function(e){return{width:e.dimension,height:e.dimension}}})})),pn=Object(b.a)((function(e){var t=e.plot,n=e.size,r=e.originalMarks,c=void 0===r||r,a=e.dataDisplay,o=void 0===a?"Original":a,s=Object(_.a)(),l=n-2*s.spacing(1),d=fn({dimension:l}).root,u=Object(i.useContext)(T).exploreStore,j=u.loadedDataset.labelColumn,h=u.setFreeformSelection,b=u.selectedPoints,f=u.showMatchesLegend,p=u.setBrushSelection,x=u.brushType,O=u.hoveredPrediction,m=u.showSkylineLegend,g=u.state,v=Object(i.useContext)(T).compareStore.selectedPointsComparison,y=t.x,k=t.y,w=Ut(),S=en(y,k,j,!1),C=S.points,D=S.x_extents,N=S.y_extents,M=en(y,k,j,!0).points,A=s.spacing(10),L=l-2*A,W=$t(D,[0,L]),B=$t(N,[L,0]),F=Object(i.useCallback)((function(e,n,r){if(0!==e.length){var c=e.map((function(e){return"#mark".concat(e)})).join(",");switch(n){case"Start":case"Brushing":Object(te.i)("#".concat(t.id)).selectAll(c).filter((function(){return Object(te.i)(this).classed(w.regularMark)})).classed(w.intermittentHighlight,!0);break;case"End":Object(te.i)("#".concat(t.id)).selectAll(".marks").classed(w.intermittentHighlight,!1),h(t,e)}}}),[t,h,w]),E=Object(i.useCallback)((function(e,n,r,c){var i={};Object.entries(n).forEach((function(t){var n=Object(P.a)(t,2),r=n[0],c=n[1];i[r]=Object(z.a)(Object(z.a)({},c),{},{points:e[r]})})),p(t,i,r,c)}),[t,p]),R=null;switch(x){case"Freeform Small":R=20;break;case"Freeform Medium":R=35;break;case"Freeform Large":R=50;break;default:R=null}return Object(Z.jsxs)("svg",{className:d,id:t.id,children:[Object(Z.jsx)("defs",{children:Object(Z.jsx)("clipPath",{id:"clip",width:L,children:Object(Z.jsx)("rect",{fill:"none",height:L,width:L})})}),Object(Z.jsxs)("g",{transform:Me(A),children:[Object(Z.jsx)(tn,{columnName:y,scale:W,transform:Me(0,L),type:"bottom"}),Object(Z.jsx)(tn,{columnName:k,scale:B,type:"left"}),f&&Object(Z.jsx)(nn,{offset:L-110}),m&&Object(Z.jsx)(bn,{transform:Me(L-150,100)}),Object(Z.jsx)(Vt,{bottom:L,brushes:g.brushes[t.id]||{},data:C,disableBrush:"Rectangular"!==x||!c,left:0,right:L,top:0,xScale:W,yScale:B,onBrushHandler:E}),R&&c&&Object(Z.jsx)(Qt,{bottom:L,brushSize:R,data:C,left:0,right:L,top:0,xScale:W,yScale:B,onBrush:F}),c?Object(Z.jsx)(cn,{points:C,selectedPoints:b,xScale:W,yScale:B}):Object(Z.jsx)(Xt,{compPoints:M,dataDisplay:o,points:C,selectedPoints:v,xScale:W,yScale:B}),O&&Object(Z.jsx)(jn,{prediction:O,xScale:W,yScale:B}),g.prediction&&Object(Z.jsx)(jn,{prediction:g.prediction,xScale:W,yScale:B})]})]})})),xn=Object(b.a)((function(e){var t=e.setDataDisplay,n=e.dataDisplay,r=e.selectedPoints,c=void 0!==r&&r,i=Ut();return Object(Z.jsx)("svg",{height:30,width:700,children:Object(Z.jsxs)("g",{children:[Object(Z.jsxs)("g",{transform:Me(0,10),onMouseDown:function(){t("Original"===n?"All":"Original")},children:[Object(Z.jsx)("circle",{className:"marks ".concat(i.regularMark),cx:12.5,cy:5,opacity:".5",r:"5"}),"Original"===n?Object(Z.jsx)("rect",{height:25,opacity:".2",rx:20,transform:Me(0,-8),width:100}):null,Object(Z.jsx)("text",{dominantBaseline:"middle",dx:"25",dy:"5",fontWeight:"Original"===n?"bold":"normal",children:"Base"})]}),Object(Z.jsxs)("g",{transform:Me(100,10),onMouseDown:function(){t("Comparison"===n?"All":"Comparison")},children:[Object(Z.jsx)("circle",{className:"marks ".concat(i.regularMark),cx:12.5,cy:5,opacity:".5",r:"5"}),"Comparison"===n?Object(Z.jsx)("rect",{height:25,opacity:".2",rx:20,transform:Me(0,-8),width:100}):null,Object(Z.jsx)("text",{dominantBaseline:"middle",dx:"25",dy:"5",children:"Updated"})]}),Object(Z.jsxs)("g",{transform:Me(200,10),onMouseDown:function(){t("RemovedOnly"===n?"All":"RemovedOnly")},children:[Object(Z.jsxs)("g",{className:"marks ".concat(i.removedMark," ").concat(c?"":i.removedColor),opacity:"0.5",transform:Me(10,0),children:[Object(Z.jsx)("line",{x2:"6",y2:"6"}),Object(Z.jsx)("line",{x1:"6",y2:"6"})]}),"RemovedOnly"===n?Object(Z.jsx)("rect",{height:25,opacity:".2",rx:20,transform:Me(0,-8),width:100}):null,Object(Z.jsx)("text",{dominantBaseline:"middle",dx:"25",dy:"5",children:"Removed"})]}),Object(Z.jsxs)("g",{transform:Me(300,10),onMouseDown:function(){t("AddedOnly"===n?"All":"AddedOnly")},children:[Object(Z.jsxs)("g",{className:"marks ".concat(i.newMark," ").concat(c?"":i.newColor),opacity:"0.5",transform:Me(10,0),children:["AddedOnly"===n?Object(Z.jsx)("rect",{height:25,opacity:".2",rx:20,transform:Me(-10,-8),width:100}):null,Object(Z.jsx)("polygon",{points:"0 0, 5 10, 10 0"})]}),Object(Z.jsx)("text",{dominantBaseline:"middle",dx:"32",dy:"5",children:"Added"})]}),Object(Z.jsxs)("g",{transform:Me(400,10),onMouseDown:function(){t("ChangedOnly"===n?"All":"ChangedOnly")},children:[Object(Z.jsx)("path",{className:"marks ".concat(i.movedLine),d:Yt(5,25,5,5),style:{opacity:"0.4"}}),"ChangedOnly"===n?Object(Z.jsx)("rect",{height:25,opacity:".2",rx:20,transform:Me(-10,-8),width:130}):null,Object(Z.jsx)("circle",{className:"marks ".concat(i.movedPoint),cx:5,cy:5,opacity:".2",r:"5"}),Object(Z.jsx)("circle",{className:"marks ".concat(i.movedPoint),cx:25,cy:5,opacity:"1",r:"5"}),Object(Z.jsx)("text",{dominantBaseline:"middle",dx:"32",dy:"5",children:"Point Moved"})]}),Object(Z.jsxs)("g",{transform:Me(510,10),onMouseDown:function(){t("Diff"===n?"All":"Diff")},children:["Diff"===n?Object(Z.jsx)("rect",{height:25,opacity:".2",rx:20,transform:Me(14,-8),width:130}):null,Object(Z.jsx)("text",{dominantBaseline:"middle",dx:"32",dy:"5",children:"All Changed Data"})]})]})})})),On=Object(u.a)((function(e){return Object(K.a)({root:{flexGrow:1,padding:e.spacing(2),overflow:"auto"},chips:{display:"flex",justifyContent:"center",flexWrap:"wrap","& > *":{margin:e.spacing(.5)}},grid:{height:"100%"},closeIcon:{position:"absolute"}})})),mn=Object(b.a)((function(){var e=Object(i.useContext)(T),t=e.exploreStore,n=t.plots,r=t.removePlot,c=t.isLoadingData,a=t.n_plots,o=t.isComparison,s=t.setComparison,l=t.selectedPoints,d=e.projectStore,u=d.currentProject,j=d.currentDatasetKey,h=d.loadDatasetWithReapply,b=d.loadComparisonDataset,f=d.isReapplying,x=d.currentComparisonDatasets,O=d.comparisonKeys,m=1===a?800:500,g=On(),v=Object(_.a)(),y=Object(i.useState)("All"),k=Object(P.a)(y,2),w=k[0],S=k[1],C=1===a?"auto":6,D=Object(Z.jsx)(H.a,{});console.log(o,Object(p.toJS)(x),Object(p.toJS)(O));var N=n.map((function(e){return Object(Z.jsxs)(V.a,{xs:C,item:!0,children:[o&&x.length>1?Object(Z.jsx)(xn,{dataDisplay:w,offset:m-2*v.spacing(1)-110,selectedPoints:l.length>0,setDataDisplay:S}):null,Object(Z.jsxs)(J.a,{elevation:3,children:[a>1&&Object(Z.jsx)(U.a,{className:g.closeIcon,onClick:function(){r(e)},children:Object(Z.jsx)(X.a,{})}),Object(Z.jsx)(pn,{dataDisplay:w,originalMarks:!o||x.length<2,plot:e,size:m-2*v.spacing(1)})]})]},e.id)}));return u&&j?(console.log(Object(p.toJS)(O)),Object(Z.jsxs)("div",{className:g.root,children:[Object(Z.jsxs)("div",{className:g.chips,children:[u.datasets.map((function(e){return Object(Z.jsx)(It.a,{color:j===e.key||o&&O.includes(e.key)?"primary":"default",disabled:j===e.key||o&&O.includes(e.key),label:e.version,onClick:function(){o?b(e.key):h(e.key)}},e.key)})),Object(Z.jsx)(Tt.a,{control:Object(Z.jsx)(Kt.a,{checked:o,color:"primary",name:"Compare Datasets",onChange:function(){return s(!o)}}),label:"Compare Datasets",labelPlacement:"end",value:"end"})]}),Object(Z.jsx)(V.a,{alignItems:"center",className:g.grid,justify:"center",spacing:2,container:!0,children:c||f?D:N})]})):Object(Z.jsx)("div",{})})),gn=n(637),vn=n(639),yn=n(638),kn=n(270),wn=n(657),Sn=n(239),Cn=n(238),Dn=n(334),Nn=n.n(Dn),Mn=n(333),Pn=n.n(Mn),zn=n(653),An=n(624),Ln=Object(b.a)((function(e){var t=e.text,n=e.handleType,r=e.color,c=Object(i.useState)(!1),a=Object(P.a)(c,2),o=a[0],s=a[1];return o?Object(Z.jsx)(An.a,{value:t,onBlur:function(){return s(!1)},onChange:function(e){e.stopPropagation(),n(e.target.value)}}):Object(Z.jsx)(Ct.a,{title:t,children:Object(Z.jsx)(mt.a,{align:"center",color:r,style:{width:"100px"},variant:"button",noWrap:!0,onClick:function(){return s(!0)},children:t})})})),Wn=Object(u.a)((function(e){return{card:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},close:{marginLeft:"auto"}}})),Bn=Object(b.a)((function(e){var t,n=e.id,r=Wn(),c=Object(i.useContext)(T),a=c.provenance,o=c.provenance.graph.nodes,s=c.exploreStore,l=s.removeFromWorkflow,d=s.currentDatasetKey,u=o[n],j=!1,b=a.getLatestArtifact(n);return b&&(j=!!d&&"Rejected"===b.artifact.status_record[d]),Object(Z.jsx)(gn.a,{className:r.card,variant:"outlined",children:Object(Z.jsx)(yn.a,{children:Object(Z.jsxs)(vn.a,{disableSpacing:!0,children:[Object(Z.jsxs)("div",{children:[Object(Z.jsx)(mt.a,{color:j?"textSecondary":"textPrimary",display:"block",variant:"button",children:u.label}),Object(Z.jsx)(mt.a,{color:"textSecondary",display:"block",variant:"subtitle2",children:Object(h.isChildNode)(u)&&u.artifacts&&u.artifacts.annotations&&a.getLatestAnnotation(u.id)?null===(t=a.getLatestAnnotation(u.id))||void 0===t?void 0:t.annotation:""})]}),Object(Z.jsx)(U.a,{className:r.close,color:"secondary",disabled:j,size:"small",onClick:function(){return l(n)},children:Object(Z.jsx)(X.a,{})})]})})})})),Fn=Object(u.a)((function(e){return{card:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},close:{marginLeft:"auto"},badge_sync:{backgroundColor:Sn.a[500]},badge_unsync:{backgroundColor:Cn.a[500]}}})),En=Object(b.a)((function(e){var t=e.workflow,n=Fn(),r=Object(i.useContext)(T),c=r.exploreStore,a=c.workflows,o=c.renameWorkflow,s=c.currentWorkflow,l=c.setCurrentWorkflow,d=c.removeWorkflow,u=c.workflowSyncStatus,j=c.setSyncStatus,h=r.provenance,b=r.db,f=Object(i.useState)(!0),p=Object(P.a)(f,2),x=p[0],O=p[1],g=t.id,v=!!u[g]&&u[g]===JSON.stringify(t),y=g===s,k=Object(i.useCallback)((function(e){return o(g,e)}),[g,o]),w=Object(i.useCallback)((function(){var e=document.createElement("textarea");e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-99999px",e.value=g,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),O(!0)}),[g]);return Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)(gn.a,{className:n.card,variant:"outlined",onClick:function(){return l(g)},children:Object(Z.jsxs)(yn.a,{children:[Object(Z.jsxs)(vn.a,{disableSpacing:!0,children:[Object(Z.jsx)(kn.a,{classes:{badge:v?n.badge_sync:n.badge_unsync},color:"primary",variant:"dot",children:Object(Z.jsx)(Ln,{color:y?"textPrimary":"textSecondary",handleType:k,text:t.name})}),v?Object(Z.jsx)(U.a,{className:n.close,disabled:0===t.graph.length,size:"small",onClick:w,children:Object(Z.jsx)(Nn.a,{})}):Object(Z.jsx)(U.a,{className:n.close,disabled:0===t.graph.length,size:"small",onClick:function(){return function(e,t,n,r,c){var i={id:n.id,name:n.name,project:n.project,graph:m(t,n.graph)};r.ref("".concat(e)).set(i).then((function(){c(e,JSON.stringify(n))}))}(g,h.graph,a[g],b,j)},children:Object(Z.jsx)(Pn.a,{})}),Object(Z.jsx)(U.a,{size:"small",onClick:function(){return d(g)},children:Object(Z.jsx)(X.a,{})})]}),Object(Z.jsx)(Ye.a,{}),Object.values(t.graph).map((function(e){return Object(Z.jsx)(Bn,{id:e},e)}))]})}),Object(Z.jsx)(wn.a,{anchorOrigin:{vertical:"bottom",horizontal:"right"},autoHideDuration:1e3,open:x,onClose:function(){return O(!1)},children:Object(Z.jsx)(zn.a,{children:"Copied workflow id: ".concat(g)})})]})})),Rn=Object(u.a)((function(e){return{root:{margin:e.spacing(2),padding:e.spacing(1)},card:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}}})),Gn=Object(b.a)((function(){var e=Rn(),t=Object(i.useContext)(T).exploreStore,n=t.workflows,r=t.addWorkflow;return Object(Z.jsxs)(J.a,{className:e.root,children:[Object(Z.jsx)(mt.a,{align:"center",style:{fontWeight:"bold",fill:"#F2",fontSize:"18px",fontFamily:"Lato, Helvetica Neue,Arial,Helvetica,sans-serif"},variant:"h4",children:"Workflows"}),Object(Z.jsx)(Ye.a,{}),Object(Z.jsxs)(gn.a,{style:{border:"none",boxShadow:"none"},variant:"outlined",children:[Object(Z.jsx)(vn.a,{children:Object(Z.jsx)(Ze.a,{color:"primary",onClick:function(){return r()},children:"Add Workflow"})}),Object(Z.jsx)(yn.a,{children:Object.values(n).map((function(e){return Object(Z.jsx)(En,{workflow:e},e.id)}))})]})]})})),In=Object(u.a)((function(){return{root:{".red":{backgroundColor:"#ff8080"},".green":{backgroundColor:"#90EE90"},".yellow":{backgroundColor:"#ffff8b"},display:"grid",height:"100vh",width:"100vw",gridTemplateRows:"min-content 1fr",overflow:"hidden"},layout:{display:"grid",gridTemplateColumns:"5fr 1.5fr 1.3fr 1.5fr",overflow:"hidden"}}})),Tn={"Load Dataset":{backboneGlyph:Object(Z.jsx)(Te,{size:22}),currentGlyph:Object(Z.jsx)(Te,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Te,{size:16}),bundleGlyph:Object(Z.jsx)(Te,{fill:"#2185d0",size:22})},MultiBrush:{backboneGlyph:Object(Z.jsx)(Ke,{size:22}),currentGlyph:Object(Z.jsx)(Ke,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Ke,{size:16}),bundleGlyph:Object(Z.jsx)(Ke,{fill:"#2185d0",size:22})},"Switch Category Visibility":{backboneGlyph:Object(Z.jsx)(_e,{size:22}),currentGlyph:Object(Z.jsx)(_e,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(_e,{size:16}),bundleGlyph:Object(Z.jsx)(_e,{fill:"#2185d0",size:22})},"Change Category":{backboneGlyph:Object(Z.jsx)(Ve,{size:22}),currentGlyph:Object(Z.jsx)(Ve,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Ve,{size:16}),bundleGlyph:Object(Z.jsx)(Ve,{fill:"#2185d0",size:22})},"Add Plot":{backboneGlyph:Object(Z.jsx)(Ie,{size:22}),currentGlyph:Object(Z.jsx)(Ie,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Ie,{size:16}),bundleGlyph:Object(Z.jsx)(Ie,{fill:"#2185d0",size:22})},"Point Selection":{backboneGlyph:Object(Z.jsx)(Ge,{size:22}),currentGlyph:Object(Z.jsx)(Ge,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Ge,{size:16}),bundleGlyph:Object(Z.jsx)(Ge,{fill:"#2185d0",size:22})},"Point Deselection":{backboneGlyph:Object(Z.jsx)(Re,{size:22}),currentGlyph:Object(Z.jsx)(Re,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Re,{size:16}),bundleGlyph:Object(Z.jsx)(Re,{fill:"#2185d0",size:22})},"Add Brush":{backboneGlyph:Object(Z.jsx)(Ee,{size:22}),currentGlyph:Object(Z.jsx)(Ee,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Ee,{size:16}),bundleGlyph:Object(Z.jsx)(Ee,{fill:"#2185d0",size:22})},"Lock Prediction":{backboneGlyph:Object(Z.jsx)(Fe,{size:22}),currentGlyph:Object(Z.jsx)(Fe,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Fe,{size:16}),bundleGlyph:Object(Z.jsx)(Fe,{fill:"rgb(248, 191, 132)",size:22})},"Prediction Selection":{backboneGlyph:Object(Z.jsx)(Be,{size:22}),currentGlyph:Object(Z.jsx)(Be,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Be,{size:16}),bundleGlyph:Object(Z.jsx)(Be,{fill:"#2185d0",size:22})},Invert:{backboneGlyph:Object(Z.jsx)(We,{size:22}),currentGlyph:Object(Z.jsx)(We,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(We,{size:16}),bundleGlyph:Object(Z.jsx)(We,{fill:"#2185d0",size:22})},"Update Brush":{backboneGlyph:Object(Z.jsx)(Le,{size:22}),currentGlyph:Object(Z.jsx)(Le,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Le,{size:16}),bundleGlyph:Object(Z.jsx)(Le,{fill:"#2185d0",size:22})},"Remove Brush":{backboneGlyph:Object(Z.jsx)(Ae,{size:22}),currentGlyph:Object(Z.jsx)(Ae,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Ae,{size:16}),bundleGlyph:Object(Z.jsx)(Ae,{fill:"#2185d0",size:22})},Filter:{backboneGlyph:Object(Z.jsx)(ze,{size:22}),currentGlyph:Object(Z.jsx)(ze,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(ze,{size:16}),bundleGlyph:Object(Z.jsx)(ze,{fill:"#ccc",size:22})},"Change Brush Type":{backboneGlyph:Object(Z.jsx)(Pe,{size:22}),currentGlyph:Object(Z.jsx)(Pe,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(Pe,{size:16}),bundleGlyph:Object(Z.jsx)(Pe,{fill:"#2185d0",size:22})},"Change Brush Size":{backboneGlyph:Object(Z.jsx)(He,{size:22}),currentGlyph:Object(Z.jsx)(He,{fill:"#2185d0",size:22}),regularGlyph:Object(Z.jsx)(He,{size:16}),bundleGlyph:Object(Z.jsx)(He,{fill:"#2185d0",size:22})}},Kn=Object(b.a)((function(){var e=In(),t=Object(i.useContext)(T),n=t.exploreStore,r=t.projectStore,c=r.loadedDataset,a=r.nodeCreationMap,o=r.approveNode,s=r.rejectNode,l=t.provenance,d=t.bundledNodes,u=t.loadedWorkflowId,b=t.loadSavedProject,f=t.dims,p=n.addToWorkflow;Object(i.useEffect)((function(){var e=l.current;if(!(Object(h.isChildNode)(e)&&e.children.length>0)&&!(!c||n.n_plots>0||u||b)){var t=c.numericColumns,r=0,i=1;if(f.length>0){var a=Object(P.a)(f,2),o=a[0],s=a[1];r=-1!==t.findIndex((function(e){return e===o}))?t.findIndex((function(e){return e===o})):r,i=-1!==t.findIndex((function(e){return e===s}))?t.findIndex((function(e){return e===s})):i}var d={id:D(),x:t[r],y:t[i]};n.addPlot(d)}}));var x,O={},m=Object(g.a)(d);try{for(m.s();!(x=m.n()).done;){var v=x.value;0!==v.length&&(O[v[0]]={metadata:"",bundleLabel:"",bunchedNodes:v})}}catch(y){m.e(y)}finally{m.f()}return Object(Z.jsxs)("div",{className:e.root,children:[Object(Z.jsx)(j.a,{}),Object(Z.jsx)(Ot,{}),Object(Z.jsxs)("div",{className:e.layout,children:[Object(Z.jsx)(mn,{}),Object(Z.jsx)(Gt,{}),Object(Z.jsx)(Ne,{addToWorkflow:p,approvedFunction:function(e){return o(e)},backboneGutter:40,changeCurrent:function(e){return l.goToNode(e)},current:l.graph.current,currentDataset:(null===c||void 0===c?void 0:c.version)||"",ephemeralUndo:!1,eventConfig:Tn,nodeCreationMap:a,nodeMap:l.graph.nodes,prov:l,rejectedFunction:function(e){return s(e)},root:l.graph.root,undoRedoButtons:!0},l.graph.root),Object(Z.jsx)(Gn,{})]})]})})),_n=Object(b.a)((function(e){var t=e.location,n=Object(i.useContext)(T),r=n.setQueryParams,c=n.projectStore.loadedDataset;return Object(i.useEffect)((function(){r(t.search)}),[t.search,r]),c?Object(Z.jsx)(Kn,{}):Object(Z.jsx)(d.a,{to:{pathname:"/project",search:t.search}})})),Hn=n(266),Vn=n.n(Hn),Jn=n(265),Un=function(e){var t=e.info,n=e.width,r=e.height;return Object(Z.jsxs)("div",{children:[Object.keys(t).length," ",n," ",r]})},Yn=Object(b.a)((function(e){var t=e.column,n=e.width,r=e.height,c=t.dataType,i=t.fullname;return"id"===c||"label"===c?Object(Z.jsx)(Z.Fragment,{children:i}):"categorical"===t.dataType?Object(Z.jsx)(Un,{height:r,info:t.info,width:n}):Object(Z.jsx)("div",{children:"Custom"})}));function Xn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:56,r=arguments.length>3?arguments[3]:void 0,c=Object(i.useCallback)((function(e){return{padding:0,width:"100%",background:e}}),[]),a=Object(i.useMemo)((function(){if(!e)return{rows:[],columns:[]};var i=e.columnInfo,a=e.columns;return{rows:e.values,columns:a.filter((function(e){return"id"!==e&&"iid"!==e})).map((function(e){return{field:e,headerName:i[e].fullname,description:i[e].unit||"",flex:1,renderHeader:function(t){var r=t.colDef.width;return n?Object(Z.jsx)("div",{children:t.field}):Object(Z.jsx)("div",{children:Object(Z.jsx)(Yn,{column:i[e],height:n,width:r})})},renderCell:function(e){if(null===t)return Object(Z.jsx)("div",{children:e.value});var n=e.row.Label,i=t.values.filter((function(e){return e.Label===n})),a="none";if(0===i.length)a=r?"#ff8080":"#90EE90";else if(!r){e.getValue(e.field)!==i[0][e.field]&&(a="#ffff8b")}return Object(Z.jsx)("div",{style:c(a),children:e.value})},cellClassName:function(e){if(null===t)return"none";var n=e.row.Label,c=t.values.filter((function(e){return e.Label===n})),i="none";if(0===c.length)i=r?"red":"green";else if(!r){e.getValue(e.field)!==c[0][e.field]&&(i="yellow")}return i}}}))}}),[e,t,n,r,c]),o=a.rows,s=void 0===o?[]:o,l=a.columns,d=void 0===l?[]:l;return{rows:s,columns:d}}var Zn=Object(u.a)((function(){return{centerText:{display:"flex",alignItems:"center",justifyContent:"center"}}})),qn=Object(b.a)((function(e){var t=Object(i.useRef)(null),n=Zn(),r=Xn(Object(i.useContext)(T).projectStore.loadedDataset,null,56,!0),c=r.rows,a=r.columns;return Object(Z.jsx)("div",{className:n.centerText,style:{gridColumnStart:1,gridColumnEnd:1+e.columnNum},children:c.length>0?Object(Z.jsx)(Jn.a,{ref:t,columns:a,headerHeight:56,rows:c,autoPageSize:!0,pagination:!0}):Object(Z.jsx)(mt.a,{variant:"button",children:"Please select a dataset"})})})),Qn=Object(b.a)((function(){var e=Object(i.useRef)(null),t=Object(i.useContext)(T).projectStore.currentComparisonDatasets,n=Xn(t[0],t[1],56,!1),r=n.rows,c=n.columns;return Object(Z.jsx)("div",{style:{gridColumnStart:2,gridColumnEnd:3},children:Object(Z.jsx)(Jn.a,{ref:e,columns:c,headerHeight:56,rows:r,autoPageSize:!0,pagination:!0})})})),$n=n(642),er=n(643),tr=n(644),nr=n(348),rr=n(646),cr=n(338),ir=n(652),ar=n(645),or=n(556),sr=n(557),lr=n(640),dr=n(641),ur=Object(b.a)((function(e){var t=e.trackers,n=e.updateWhenDone,r=Object(i.useState)([]),c=Object(P.a)(r,2),a=c[0],o=c[1],s=Object(i.useState)(!1),l=Object(P.a)(s,2),d=l[0],u=l[1];return Object(i.useEffect)((function(){if(0!==t.length){d&&(o([]),n());var e=setInterval((function(){S.a.post("".concat(N,"/dataset/status"),{trackers:t}).then((function(e){var t=e.data;0===t.map((function(e){return e.status})).filter((function(e){return"SUCCESS"!==e})).length&&u(!0),o(t)}))}),500);return function(){return clearInterval(e)}}}),[t,a,d,n]),Object(Z.jsx)(or.a,{children:a.map((function(e){var t=e.type,n=e.info,r=n.processed,c=n.to_process;return Object(Z.jsxs)(sr.a,{children:[Object(Z.jsxs)(lr.a,{children:[t," (",r,"/",c,")"]}),Object(Z.jsx)(lr.a,{children:Object(Z.jsx)(dr.a,{value:r/c*100,variant:"determinate"})})]},t)}))})})),jr=new ir.a;var hr=Object(b.a)((function(e){var t=e.open,n=e.handleClose,r=function(e){var t=Object(i.useState)(!1),n=Object(P.a)(t,2),r=n[0],c=n[1],a=Object(i.useState)(!1),o=Object(P.a)(a,2),s=o[0],l=o[1],d=Object(i.useState)([]),u=Object(P.a)(d,2),j=u[0],h=u[1],b=Object(i.useCallback)((function(){c(!1),l(!0)}),[]);return{handleSubmit:Object(i.useCallback)((function(t){if(e){var n=new FormData;Object.entries(t).forEach((function(e){n.append(e[0],e[1])})),n.append("reset","True"),S.a.post("".concat(N,"/").concat(e.key,"/dataset/"),n,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){h(e.data.trackers),c(!0)}))}}),[e]),initialValues:{version:"",description:"",dataset:null,metadata:null},showStatus:r,trackers:j,updateWhenDone:b,processingComplete:s}}(Object(i.useContext)(T).projectStore.currentProject),c=r.initialValues,a=r.handleSubmit,o=r.showStatus,s=r.trackers,l=r.updateWhenDone,d=r.processingComplete,u=Object(cr.a)({initialValues:c,onSubmit:a});return Object(Z.jsx)(Z.Fragment,{children:Object(Z.jsxs)($n.a,{open:t,onClose:n,children:[Object(Z.jsx)(er.a,{children:"Upload a new dataset"}),Object(Z.jsxs)(tr.a,{children:[Object(Z.jsxs)("form",{id:"dataset-form",onSubmit:u.handleSubmit,children:[Object(Z.jsx)(nr.a,{id:"version",label:"Version",margin:"dense",type:"text",value:u.values.version,fullWidth:!0,required:!0,onChange:u.handleChange}),Object(Z.jsx)(nr.a,{id:"description",label:"Description",margin:"dense",type:"text",value:u.values.description,fullWidth:!0,multiline:!0,onChange:u.handleChange}),Object(Z.jsxs)(dt.a,{children:[Object(Z.jsx)(An.a,{id:"csv",type:"file",hidden:!0,required:!0,onChange:function(e){var t=e.target.files;t&&t.length>0&&u.setFieldValue("dataset",t[0])}}),"Dataset*"]}),Object(Z.jsxs)(dt.a,{children:[Object(Z.jsx)(An.a,{id:"yaml",type:"file",hidden:!0,onChange:function(e){var t=e.target.files;t&&t.length>0&&u.setFieldValue("metadata",t[0])}}),"Metadata"]})]}),o&&Object(Z.jsx)(ar.a,{client:jr,children:Object(Z.jsx)(ur,{trackers:s,updateWhenDone:l})})]}),Object(Z.jsx)(rr.a,{children:d?Object(Z.jsx)(Ze.a,{onClick:function(){return n()},children:"Close"}):Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)(Ze.a,{onClick:function(){return n()},children:"Cancel"}),Object(Z.jsx)(Ze.a,{disabled:u.isSubmitting,form:"dataset-form",type:"submit",children:"Add"})]})})]})})})),br=Object(u.a)((function(){return Object(K.a)({colorClass:{},root:{"& .red":{background:"#ff8080"},"& .green":{backgroundColor:"#90EE90"},"& .yellow":{backgroundColor:"#ffff8b"},flexGrow:1,display:"grid",height:"100vh",gridTemplateRows:"min-content 1fr",gridTemplateColumns:"2fr 2fr"}})})),fr=Object(b.a)((function(){var e=br(),t=Object(i.useContext)(T),n=t.projectStore,r=n.currentProject,c=n.loadedDatasetKey,a=n.loadDataset,o=t.search,s=Object(i.useState)(!1),d=Object(P.a)(s,2),u=d[0],j=d[1],h=Object(i.useState)(!1),b=Object(P.a)(h,2),f=b[0],p=b[1],x=Object(i.useMemo)((function(){return(null===r||void 0===r?void 0:r.datasets.map((function(e){return{key:e.key,desc:e.version}})))||[]}),[r]),O=ht("dataset-dropdown","Dataset","",x,x.map((function(e){return e.key})).includes(c)?c:"",a).Dropdown;return r?Object(Z.jsxs)("div",{className:e.root,children:[Object(Z.jsx)(Je.a,{color:"transparent",position:"static",style:{gridColumnStart:1,gridColumnEnd:3},children:Object(Z.jsxs)(Ue.a,{children:[Object(Z.jsx)(mt.a,{variant:"h6",noWrap:!0,children:r.name}),Object(Z.jsx)(O,{}),Object(Z.jsx)(Ze.a,{color:"primary",startIcon:Object(Z.jsx)(ot.a,{}),variant:"outlined",onClick:function(){return j(!0)},children:"Upload Dataset"}),Object(Z.jsx)(Ze.a,{color:"primary",component:l.b,startIcon:Object(Z.jsx)(Vn.a,{}),to:{pathname:"/explore",search:o},variant:"outlined",children:"Load Dataset"}),Object(Z.jsx)(Kt.a,{checked:f,color:"primary",inputProps:{"aria-label":"secondary checkbox"},name:"checkedA",onChange:function(){p(!f)}}),f?Object(Z.jsx)(Ze.a,{color:"primary",component:l.b,startIcon:Object(Z.jsx)(Vn.a,{}),to:"/compare",variant:"outlined",children:"Comparison View"}):null]})}),Object(Z.jsx)(qn,{columnNum:f?1:2}),f&&Object(Z.jsx)(Qn,{}),Object(Z.jsx)(hr,{handleClose:function(){return j(!1)},open:u})]}):Object(Z.jsx)("div",{children:"Unloaded"})})),pr=n(658),xr=n(560),Or=n(336),mr=n.n(Or),gr=n(337),vr=n.n(gr),yr=n(647),kr=Object(b.a)((function(e){var t=e.open,n=e.handleClose,r=Object(i.useContext)(T).projectStore.loadProjects,c=Object(i.useState)(""),a=Object(P.a)(c,2),o=a[0],s=a[1],l=Object(i.useState)(""),d=Object(P.a)(l,2),u=d[0],j=d[1],h=Object(i.useState)(""),b=Object(P.a)(h,2),f=b[0],p=b[1],x=Object(i.useState)(!1),O=Object(P.a)(x,2),m=O[0],g=O[1],v=Object(i.useCallback)((function(){var e=new FormData;e.append("name",u),e.append("reset","True"),S.a.post("".concat(N,"/project/").concat(o),e).then((function(e){var t=e.data.message;p(t)})).catch((function(){p("Something went wrong!")})).finally((function(){s(""),j(""),g(!0),r(o)}))}),[o,u,r]);return Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsxs)($n.a,{open:t,onClose:n,children:[Object(Z.jsx)(er.a,{children:"Create new project"}),Object(Z.jsxs)(tr.a,{children:[Object(Z.jsx)(yr.a,{children:"Please enter name and an unique id for the project."}),Object(Z.jsx)(nr.a,{id:"project-id",label:"Project ID",margin:"dense",type:"text",value:o,required:!0,onChange:function(e){return s(e.target.value)}}),Object(Z.jsx)("br",{}),Object(Z.jsx)(nr.a,{id:"project-name",label:"Project Name",margin:"dense",type:"text",value:u,required:!0,onChange:function(e){return j(e.target.value)}})]}),Object(Z.jsxs)(rr.a,{children:[Object(Z.jsx)(Ze.a,{onClick:function(){return n()},children:"Cancel"}),Object(Z.jsx)(Ze.a,{disabled:""===o||""===u,onClick:function(){v(),n()},children:"Add"})]})]}),Object(Z.jsx)(wn.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},autoHideDuration:2e3,message:f,open:m,onClose:function(){return g(!1)}})]})})),wr=240,Sr=Object(u.a)((function(e){return Object(K.a)({root:{display:"flex"},appBar:{width:"calc(100% - ".concat(wr,"px)"),marginLeft:wr},drawer:{width:wr,flexShrink:0},drawerPaper:{width:wr},toolbar:Object(z.a)(Object(z.a)({},e.mixins.toolbar),{},{display:"flex",alignItems:"center",justifyContent:"center"})})})),Cr=Object(b.a)((function(){var e=Sr(),t=Object(i.useContext)(T).projectStore,n=t.projects,r=t.currentProject,c=t.loadProjectByKey,a=Object(i.useState)(!1),o=Object(P.a)(a,2),s=o[0],l=o[1];return Object(Z.jsxs)(pr.a,{className:e.drawer,classes:{paper:e.drawerPaper},variant:"permanent",children:[Object(Z.jsx)("div",{className:e.toolbar,children:Object(Z.jsx)(mt.a,{variant:"h6",children:"Projects"})}),Object(Z.jsx)(Ye.a,{}),Object(Z.jsx)(or.a,{children:Object(Z.jsxs)(sr.a,{button:!0,onClick:function(){return l(!0)},children:[Object(Z.jsx)(xr.a,{children:Object(Z.jsx)(mr.a,{})}),Object(Z.jsx)(lr.a,{primary:"Add Project",children:" "})]})}),Object(Z.jsx)(Ye.a,{}),Object(Z.jsx)(or.a,{children:n.map((function(e){return Object(Z.jsxs)(sr.a,{selected:e.key===(null===r||void 0===r?void 0:r.key),button:!0,onClick:function(){return c(e.key)},children:[Object(Z.jsx)(xr.a,{children:Object(Z.jsx)(vr.a,{})}),Object(Z.jsx)(lr.a,{primary:e.name})]},e.key)}))}),Object(Z.jsx)(kr,{handleClose:function(){return l(!1)},open:s})]})})),Dr=Object(u.a)((function(){return Object(K.a)({root:{display:"flex"}})})),Nr=Object(b.a)((function(e){var t=e.location,n=Dr(),r=Object(i.useContext)(T),c=r.projectStore,a=c.currentProject,o=c.loadedDataset,s=r.setQueryParams,l=r.debug,u=r.redirectPath,h=r.search;r.loadedWorkflowId;Object(i.useEffect)((function(){s(t.search)}),[t.search,s]);return l&&"explore"===u&&o?Object(Z.jsx)(d.a,{to:{pathname:"/explore",search:h}}):Object(Z.jsxs)("div",{className:n.root,children:[Object(Z.jsx)(j.a,{}),Object(Z.jsx)(Cr,{}),a?Object(Z.jsx)(fr,{}):"Please select a project"]})})),Mr=(n(548),n(648)),Pr=Object(u.a)({root:{width:"400px"},media:{height:"300px",margin:"0px",padding:"0px"},grid:{display:"grid",gridGap:"1px",gridTemplateColumns:"repeat(3, 1fr)",gridTemplateRows:"repeat(2, 1fr)"},gridContainer:{display:"flex",justifyContent:"center",alignItems:"center"},buttonContainer:{display:"flex",justifyContent:"center",alignItems:"center"}}),zr=Object(b.a)((function(){var e=Pr(),t=["Cluster Complex Demo","Cluster Simple Demo","Gapminder World Demo","Linear Regression Complex Demo","Linear Regression Simple Demo","Outliers"],n=["".concat("/reapply_workflows","/landingPictures/clusterComplex.png"),"".concat("/reapply_workflows","/landingPictures/clusterSimple.png"),"".concat("/reapply_workflows","/landingPictures/gapminder.png"),"".concat("/reapply_workflows","/landingPictures/linearComplex.png"),"".concat("/reapply_workflows","/landingPictures/linearSimple.png"),"".concat("/reapply_workflows","/landingPictures/Outliers.png")],r=["/explore?demo=cluster_complex","/explore?demo=cluster_simple","/explore?demo=gapminder_world","/explore?demo=linear_regression_complex","/explore?demo=linear_regression_simple","/explore?demo=outliers"],c=["https://colab.research.google.com/drive/18GdpjL9LD5tQBFoWgAjBScWtjvX9WNA8?usp=sharing","https://colab.research.google.com/drive/1WdzfTqhSgCML1iq9inw03Z64Lj8qHc1a?usp=sharing","https://colab.research.google.com/drive/1E_5Pw0905aGOnYUo7-RwI2pq2WvTI-j4?usp=sharing","https://colab.research.google.com/drive/16DJRqPHgoAw1EFwiKm4PmihG3BRHdOxj?usp=sharing","https://colab.research.google.com/drive/1zsupVPrE0rxCZfKR3MlS0DIagvBeP55O?usp=sharing","https://colab.research.google.com/drive/1uds9y6vKaZDRjfRCVLbbyBjij6T6i3Vb?usp=sharing"];return Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)(mt.a,{align:"center",style:{margin:"20px",fontWeight:"bold",fill:"#F2",fontSize:"36px",fontFamily:"Lato, Helvetica Neue,Arial,Helvetica,sans-serif"},variant:"h1",children:"Reusing Interactive Analysis Workflows"}),Object(Z.jsx)("div",{className:e.gridContainer,children:Object(Z.jsx)("div",{className:e.grid,children:t.map((function(i){return Object(Z.jsxs)(gn.a,{className:e.root,variant:"outlined",children:[Object(Z.jsx)(yn.a,{children:Object(Z.jsx)(Mr.a,{className:e.media,image:n[t.indexOf(i)],title:"Cluster Complex Version 1"})}),Object(Z.jsx)(yn.a,{children:Object(Z.jsx)(mt.a,{component:"h2",variant:"h5",gutterBottom:!0,children:i})}),Object(Z.jsxs)(vn.a,{children:[Object(Z.jsx)(Ze.a,{color:"primary",component:l.b,size:"small",to:r[t.indexOf(i)],children:"View Dataset"}),Object(Z.jsx)(Ze.a,{color:"primary",size:"small",children:Object(Z.jsx)("a",{href:c[t.indexOf(i)],children:"View Notebook"})})]})]},i)}))})}),Object(Z.jsx)("div",{className:e.buttonContainer,children:Object(Z.jsx)(Ze.a,{color:"primary",component:l.b,to:"/project",variant:"outlined",children:"Project Explorer"})})]})}));c()(a.a,{trackAllPureComponents:!0,exclude:[/XGrid|RowCells|GridCell/]});var Ar=Object(Z.jsx)(l.a,{children:Object(Z.jsxs)(d.d,{children:[Object(Z.jsx)(d.b,{component:_n,path:"/explore",exact:!0}),Object(Z.jsx)(d.b,{component:Nr,path:"/project",exact:!0}),Object(Z.jsx)(d.b,{component:zr,path:"/",exact:!0}),Object(Z.jsx)(d.b,{component:ee,path:"/compare",exact:!0})]})});s.a.render(Ar,document.getElementById("root"))}},[[549,1,2]]]);
//# sourceMappingURL=main.de2ed764.chunk.js.map