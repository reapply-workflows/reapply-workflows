{"version":3,"sources":["cred.ts","Firebase/firebase.ts","types/Prediction.ts","utils/IDGens.ts","stores/provenance/actions.ts","stores/queries/queryCompare.ts","stores/queries/queryPrediction.ts","stores/queries/queryProjects.ts","stores/types/Provenance.ts","stores/ViewState.ts","stores/WorkflowStore.ts","stores/ExploreStore.ts","stores/queries/mutateCategoryColumn.ts","stores/queries/queryData.ts","stores/ProjectStore.ts","stores/RootStore.ts","components/DebugDialog.tsx","layouts/BaseLayout.tsx","utils/ColorSpec.ts","components/Scatterplot/styles.ts","utils/transform.ts","components/Predictions/Bar.tsx","components/Predictions/PredictionsTable.tsx","library/trrack-vis/Utils/findBundleParent.ts","library/trrack-vis/Utils/translate.ts","library/trrack-vis/Utils/TreeLayout.ts","library/trrack-vis/components/Styles.ts","library/trrack-vis/components/BackboneNode.tsx","library/trrack-vis/components/BookmarkNode.tsx","library/trrack-vis/components/BookmarkListView.tsx","library/trrack-vis/components/BookmarkTransitions.ts","library/trrack-vis/components/LinkTransitions.ts","library/trrack-vis/components/BundleTransitions.ts","library/trrack-vis/components/Link.tsx","library/trrack-vis/components/NodeTransitions.ts","library/trrack-vis/components/UndoRedoButton.tsx","library/trrack-vis/components/ProvVis.tsx","library/trrack-vis/Utils/Icons.tsx","library/trrack-vis/components/ProvVisCreator.tsx","components/utils/EventConfig.tsx","components/ProvenanceTree.tsx","components/SidePanel/BrushSelector.tsx","contexts/CategoryContext.ts","components/SidePanel/Symbol.tsx","components/SidePanel/CategoriesCard.tsx","components/SidePanel/AggregateDialog.tsx","components/SidePanel/AggregationPanel.tsx","components/SidePanel/Labels.tsx","components/SidePanel/Transformations.tsx","components/SidePanel/index.tsx","components/AddPCPDialog.tsx","components/AddScatterplotDialog.tsx","components/Brushes/FreeFormBrush.tsx","components/Scatterplot/Axis.tsx","components/PCP/PCP.tsx","components/PCP/usePCP.ts","components/Scatterplot/CompareMarks.tsx","hooks/useScale.ts","components/Brushes/Rectangular Brush/Components/RectBrush.tsx","components/Brushes/Rectangular Brush/Components/BrushComponent.tsx","components/Scatterplot/Legend.tsx","components/Scatterplot/Marks.tsx","components/Scatterplot/SkylineOverlay.tsx","components/Scatterplot/Overlay.tsx","components/Scatterplot/Scatterplot.tsx","components/Visualization.tsx","components/CustomWorkflowView.tsx","components/EditWorkflow.tsx","components/WorkflowMenu.tsx","hooks/useWorflow.ts","views/Explore.tsx","components/DataView.tsx","components/Sidebar.tsx","components/utils/If.tsx","views/Projects.tsx","index.tsx"],"names":["firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","getFirebase","app","firebase","apps","length","initializeApp","db","database","ref","path","a","get","snapshot","loadWorkflowFromFirebase","workflowId","workflow","val","checkIfWorkflowExists","id","exists","syncWorkflow","wf","update","getAllCustomWorkflows","pid","Object","wfs","values","filter","d","type","project","predictionToIntent","intent","algorithm","info","params","dimensions","getPlotId","Date","getTime","toString","getAggregateID","createNewAction","createAction","state","interaction","saveStateMode","addScatterplot","setEventType","setLabel","addPCP","removeScatterplot","addPointSelection","addBrush","updateBrush","removeBrush","addIntentSelection","addFilter","assignLabel","assignCategory","addAggregate","queryCompare","base","target","provenance","Axios","post","COMPUTE","data","_data","selections","PREDICT","queryProjects","PROJECT","initState","i_type","defaultViewState","views","labels","filteredPoints","categoryAssignments","freeformSelections","aggregates","getSelections","forEach","view","brushSelections","sels","push","Set","sort","defaultGraph","root","current","nodes","WorkflowStore","project_name","graph","name","order","committed","customWorkflows","currentWorkflow","currentWorkflowReaction","isSyncing","syncStatus","runInAction","wfDict","setCurrentWorkflow","console","log","newWorkflow","now","setProject","removeFromWorkflow","addToWorkflow","toJS","isChildNode","parent","wfGraph","reverse","ord","node","setWorkflowName","updateGraph","toggleSync","reaction","syncCustomWorkflow","fireImmediately","node_id","idx","children","sync","this","makeAutoObservable","Boolean","BrushSizeMap","defaultCompareData","compare","ExploreStore","plotType","showCategories","selectedCategoryColumn","brushType","showLabelLayer","highlightMode","highlightPredicate","colorPredicate","hideAggregateMembers","showMatchesLegend","predictions","isLoading","compareMode","compareTarget","compareData","hoveredPrediction","import","showGlobalScale","record","lastAccessed","stateHelper","st","scatterplots","c","pcps","x","y","spec","action","apply","numericColumns","slice","selectPointsFreeform","points","pointSelection","ids","unselectPointsFreeform","currentViewSelections","p","includes","handleBrushSelection","_spec","brushes","affectedId","currentBrush","extents","x1","x2","y1","y2","min","max","rangeId","handleIntentSelection","prediction","handleFilter","filterType","handleLabelling","label","as","handleCategorization","category","value","in","handleAggregate","aggOptions","drop","rules","switchCompareMode","enable","setCompareTarget","setHoveredPrediction","pred","loadWorkflow","projectStore","query","fetchQuery","projects","wf_Id","setProjects","setCurrentProject","getData","entries","importProvenanceGraph","setDatasetId","datasets","updateRecord","dataset_id","refreshPrediction","_state","dims","getDimensions","dataValues","dataPoints","queryPrediction","retry","then","approveNode","nodeId","getLatestArtifact","artifact","JSON","parse","stringify","status","addArtifact","rejectNode","toggleHideAggregateMembers","toggleLabelLayer","show","switchBrush","btype","opts","debug","localStorage","setItem","toggleShowCategories","setHighlightMode","highlight","setHighlightPredicate","predicate","setColorPredicate","setShowMatchesLegend","changeCategoryColumn","col","categoricalColumns","Error","getCompareData","setShowGlobalScale","queryState","rawDataPoints","rec","initProvenance","done","window","printProvenanceTable","keysToShow","table","printProvenance","printRawProvenance","category_reaction","when","doesHaveCategories","arg","_","r","dispose","getItem","mode","original_record","dataset","originMap","art","source","createdIn","datasetVersionFromKey","approvedIn","v","map","rejectedIn","datas","m","columnInfo","keys","extent","computeDataPoints","agg","aggregate","applyTransforms","pt","assignments","compareRecord","changes","added","removed","updated","updateMap","results","ADD_CATEGORY","gql","addCategory","columnName","options","apolloClient","mutate","mutation","variables","queryData","rid","DATA","ProjectStore","project_id","key","version","prj","proj","removeItem","addCategoryColumn","exploreStore","dataset_requests","promise","Promise","all","catch","err","StoreContext","createContext","undefined","useStore","store","useContext","setDebugOpts","QueryClient","defaultOptions","queries","staleTime","Infinity","cacheTime","goToExplore","observer","FormGroup","FormControlLabel","control","Switch","checked","onChange","useStyles","makeStyles","theme","fab","position","right","spacing","bottom","styles","useState","debugMenuOpen","setDebugMenuOpen","Fab","className","color","onClick","Dialog","open","onClose","DialogTitle","DialogContent","MATCHES","IPNS","ISNP","UNION","useScatterplotStyle","newColor","stroke","fill","removedColor","newMark","strokeWidth","opacity","removedMark","strokeLinecap","movedLine","movedPoint","regularMark","regularLine","strokeOpacity","nonUnionMark","unionMark","unionLine","regularForceMark","intermittentHighlight","matches","isnp","ipns","dullMark","forceDullMark","translate","createStyles","common","foreground","background","rank","height","toFixed","classes","useRef","width","setWidth","useEffect","bounds","getBoundingClientRect","scale","useMemo","scaleLinear","domain","range","clsx","Typography","component","dominantBaseline","textAnchor","transform","variant","centerContainer","display","justifyContent","alignItems","flexDirection","listContainer","overflow","padding","spStyles","CircularProgress","List","ListItem","onMouseEnter","point","membership_stats","onMouseLeave","rank_jaccard","ListItemIcon","IconButton","Tooltip","title","hash","findBundleParent","bundleMap","parentList","bundle","bunchedNodes","treeLayout","currentPath","from","to","search","getPathTo","depthMap","explored","toExplore","currDepth","temp","pop","has","add","b","DFS","final","child","treeColor","style","prov","first","iconOnly","duration","radius","textSize","nodeMap","annotationOpen","bookmark","setAnnotationOpen","exemptList","setExemptList","eventConfig","popupContent","editAnnotations","annotationContent","approvedFunction","rejectedFunction","currentDataset","nodeCreationMap","expandedClusterList","cursorStyle","cursor","artifacts","annotations","getLatestAnnotation","annotation","annotateText","setAnnotateText","handleCheck","lastAnnotation","trim","addAnnotation","handleClose","handleInputChange","glyph","dropDownAdded","eventType","metadata","bundleGlyph","currentGlyph","backboneGlyph","fontWeight","annotate","actionType","depth","substr","labelG","alignmentBaseline","fontSize","fontFamily","maxWidth","Button","margin","maxHeight","event","stopPropagation","Icon","size","e","nodeClicked","labelClicked","getBookmark","setBookmark","enter","timing","delay","start","Popup","content","trigger","resize","innerNode","exemptCopy","Array","splice","findIndex","currentNode","bookmarks","j","bookmarked","keyAccessor","xOffset","yOffset","nodeList","opactiy","leave","BookmarkTransitions","innerBookmarks","linkTransitions","clusterOffset","backboneOffset","annotationHeight","clusteredNodesInFront","getX","bundleTransitions","stratifiedMap","highestDepth","lowestDepth","i","validity","Link","props","nodeTransitions","undoButtonStyle","marginTop","borderRadius","marginRight","$nest","backgroundColor","redoButtonStyle","UndoRedoButton","undoCallback","redoCallback","isAtRoot","isAtLatest","disabled","container","changeCurrent","gutter","backboneGutter","verticalSpace","clusterVerticalSpace","regularCircleRadius","backboneCircleRadius","regularCircleStroke","backboneCircleStroke","sideOffset","topOffset","linkWidth","clusterLabels","ephemeralUndo","setFirst","list","eventTypes","group","curr","bundleLabel","concat","setExpandedClusterList","types","symbols","d3","conf","counter","regularGlyph","setDefaultConfig","copyList","bundledNodes","strat","parentId","localCurr","collapsedParent","bundleParents","allExpanded","stratifiedTree","stratifiedList","descendants","links","shiftLeft","svgWidth","bookmarkTabView","graphTabView","goForwardToNonEphemeral","goForwardOneStep","goBackToNonEphemeral","goBackOneStep","link","linkArr","onMouseOut","onMouseOver","rx","ry","panes","menuItem","icon","render","Tab","Pane","attached","overflowX","overflowY","menu","secondary","pointing","Filter","RemoveBrush","ChangeBrush","Invert","TurnPrediction","viewBox","strokeLinejoin","AddBrush","PointDeselection","PointSelection","configure","isolateGlobalState","useCallback","goToNode","doesCurrentHaveWorkflow","undoRedoButtons","minWidth","Card","CardHeader","CardContent","ToggleButtonGroup","exclusive","bt","ToggleButton","GlobalPlotAttributeContext","shape","startIcon","createFilterOptions","fc","form","showCategory","categoryMap","categoryOptions","openDialog","setOpenDialog","dialogValue","setDialogValue","handleDialogClose","subheader","Autocomplete","filterOptions","filtered","inputValue","getOptionLabel","option","getOptionSelected","renderInput","TextField","renderOption","opt","toUpperCase","clearOnBlur","handleHomeEndKeys","selectOnFocus","newValue","setTimeout","sym","symbol","onSubmit","preventDefault","DialogContentText","autoFocus","FormControl","fullWidth","helperText","multiline","DialogActions","split","formControl","selectEmpty","onSet","setAggregateOptions","optionsMap","setOptionsMap","canSet","column","InputLabel","fullname","Select","labelId","ev","MenuItem","FormHelperText","unit","showAggregateDialog","setShowAggregateDialog","aggregateOptions","isSelectionEmpty","aggLabel","setAggLabel","showAggLabel","setShowAggLabel","Box","InputProps","endAdornment","InputAdornment","labelMap","showLabel","setShowLabel","disableFocusRipple","disableRipple","filterAnchorEl","setFilterAnchorEl","setter","endIcon","currentTarget","Menu","anchorEl","anchorOrigin","vertical","horizontal","keepMounted","flexFlow","gap","_dimensions","setDimensions","Chip","dim","di","multiple","setX","setY","brushStyle","transition","brushDownSelection","brushDownDeselection","brushHide","isInCircle","center","x_sq","Math","pow","y_sq","sqrt","left","top","extentPadding","onBrush","xScale","yScale","brushSize","brushRef","layerRef","selectedPointsRef","mouseIn","setMouseIn","mouseDown","setMouseDown","clickMode","setClickMode","0","2","abs","searchArea","quadTree","quadtree","addAll","x0","x3","y0","y3","selectedNodes","visit","newNode","cx","cy","next","useQuadSearch","handleMouseUp","handleMove","targetNode","clientX","clientY","nodeSelection","select","edgeY","attr","selectedPoints","removeEvent","removeEventListener","addEventListener","onContextMenu","onMouseDown","button","pointerEvents","shadow","textShadow","defaultTickFormatter","tickFormatter","numberOfTicksTarget","floor","ticks","formattedValue","offset","tickTransform","TickLine","tickLength","labelAnchor","labelTransform","useTheme","plotWidth","plotHeight","rangeMap","scatterplotStyles","groupWidth","attributeSpreadScale","scalePoint","attributeScales","scales","clamp","nice","usePCP","_freeformBrushHandler","selectorString","join","isSelecting","selectAll","classed","lineGen","line","fontStyle","dp","iid","lines","cls","createComet","mark","symbolCircle","symbolTriangle","symbolCross","theta","atan","xLength","cos","yLength","sin","useScale","closeIconText","closeIconBackground","resizeBase","ns","ew","nwse","nesw","RectBrush","onResizeStart","closeHandler","resizeHandlerSize","showIcon","setShowIcon","timeoutId","setTimeoutId","clearInterval","baseRectangle","tout","northRect","southRect","westRect","eastRect","nwRect","neRect","swRect","seRect","dy","BrushComponent","onBrushHandler","disableBrush","overlayRef","mouseDownCreation","setMouseDownCreation","mouseDownMove","setMouseDownMove","mouseDownResize","setMouseDownResize","resizeDirection","setResizeDirection","activeBrush","setActiveBrush","diff","setDiff","yScaleUpdated","copy","pixelX","pixelY","dataX","invert","dataY","extentToPixel","extentToData","rect1","rect2","rect","br","selected","closeBrushHandler","creationMouseDownHandler","brush","creationMouseMoveHandler","creationMouseUpHandler","correctBrushExtents","moveMouseDownHandler","currX","currY","moveMouseMoveHandler","brushHeight","brushWidth","diffX","diffY","newX","newY","moveMouseUpHandler","resizeMouseDownHandler","brushId","direction","resizeMouseMoveHandler","resizeMouseUpHandler","renderActiveBrush","overlay","brushList","renderedBrushes","bottomLayer","topLayer","input","dx","datapoints","symbolMap","s","cope","fieldProps","HatchPattern","patternTransform","patternUnits","lineBase","hatch","frontier","sense","x_sense","y_sense","scaled_frontier","x_lines","n","arr","y_lines","hull","edges","SkylineOverlay","dimension","xAxisLabel","yAxisLabel","freeformBrushHandler","aggregatePoints","rectangularBrushHandler","_x_extents","_y_extents","plotSize","x_extents","y_extents","affectedPoints","_rectBrushHandler","_selections","gridTemplateRows","gridTemplateAreas","chips","gridArea","flexWrap","speedDial","vis","overlfow","paperContainer","paper","alignContent","visContainer","closeIcon","sidePanel","setOpen","aggregateDataPoints","n_plots","showDialog","setShowDialog","showPCPDialog","setShowPCPDialog","labelMaker","col_name","short","pcp","Paper","sps","dps","selectedCategory","labelColumn","x_range","y_range","elevation","SpeedDial","ariaLabel","SpeedDialIcon","onOpen","SpeedDialAction","tooltipPlacement","tooltipTitle","tooltipOpen","card","history","useHistory","workflows","raised","ButtonGroup","pathname","Divider","Timeline","align","TimelineItem","TimelineSeparator","TimelineDot","TimelineConnector","TimelineContent","workflowName","swn","Input","placeholder","TimelineOppositeContent","gridTemplateColumns","useWorkflowFromURL","setWorkflow","location","useLocation","URLSearchParams","wf_to_set","replace","schemeSet1","workflowButton","subroot","drawer","hoveredCategory","setHoveredCategory","showWorkflowMenu","setShowWorkflowMenu","aggOpt","categories","l","catMap","Unassigned","Provider","Drawer","anchor","headerHeight","rows","columns","field","headerName","description","flex","useDataGrid","autoPageSize","pagination","drawerWidth","appbar","marginLeft","flexShrink","drawerPaper","toolbar","mixins","TreeView","defaultCollapseIcon","defaultEndIcon","defaultExpandIcon","expanded","StyledTreeItem","labelIcon","FolderIcon","labelText","DescriptionIcon","launchHandler","showLaunch","useTreeItemStyles","palette","text","hover","grey","borderTopRightRadius","borderBottomRightRadius","paddingRight","typography","fontWeightMedium","fontWeightRegular","paddingLeft","labelRoot","flexGrow","LabelIcon","labelInfo","bgColor","other","TreeItem","If","condition","else","elseComponent","memo","fetchAllProjects","useQuery","isError","error","message","API","httpLink","createHttpLink","uri","ApolloClient","cache","InMemoryCache","headers","whyDidYouRender","React","trackAllPureComponents","exclude","App","ApolloProvider","client","QueryClientProvider","CssBaseline","exact","Projects","Explore","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.7f57c652.chunk.js","sourcesContent":["export const firebaseConfig = {\n  apiKey: 'AIzaSyB8jzc6Gck2Rt-rrw-ZbACudr5VqESRNRY',\n  authDomain: 'reusing-intent.firebaseapp.com',\n  databaseURL: 'https://reusing-intent-default-rtdb.firebaseio.com',\n  projectId: 'reusing-intent',\n  storageBucket: 'reusing-intent.appspot.com',\n  messagingSenderId: '290275127628',\n  appId: '1:290275127628:web:1441a32bfafc7880ff5fe9',\n  measurementId: 'G-G4HW82CZ7W',\n};\n","import firebase from 'firebase/app';\n\nimport 'firebase/database';\nimport { firebaseConfig } from '../cred';\nimport { CustomWorkflow } from '../stores/WorkflowStore';\n\nexport function getFirebase() {\n  const app = firebase.apps.length === 0 ? firebase.initializeApp(firebaseConfig) : firebase.app();\n\n  const db = firebase.database(app);\n\n  const ref = async (path: string | undefined) => {\n    const snapshot = await db.ref(path).get();\n\n    return snapshot;\n  };\n\n  return { app, db, ref };\n}\n\nexport async function loadWorkflowFromFirebase(workflowId: string) {\n  const { ref } = getFirebase();\n  const workflow: Workflow = (await ref(workflowId)).val();\n\n  return workflow;\n}\n\nexport async function checkIfWorkflowExists(id: string) {\n  const { ref } = getFirebase();\n\n  return (await ref(id)).exists();\n}\n\ntype Workflow = {\n  id: string;\n  project: string;\n  project_name: string;\n  order: string[];\n  name: string;\n  type: string;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  graph: any;\n};\n\nexport async function syncWorkflow(wf: Workflow | CustomWorkflow) {\n  const update = {\n    [`/${wf.id}`]: wf,\n  };\n\n  const { db } = getFirebase();\n\n  db.ref().update(update);\n}\n\nexport async function getAllCustomWorkflows(pid: string) {\n  const { ref } = getFirebase();\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const wfs: CustomWorkflow[] = Object.values((await ref('/')).val() || {});\n\n  return wfs.filter((d) => d.type === 'Custom' && d.project === pid);\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n// Modify reapply-workflows/reapply_workflows/inference/prediction.py in conjunction\n\ntype IntentType =\n  | 'Cluster'\n  | 'Outlier'\n  | 'Linear Regression'\n  | 'Polynomial Regression'\n  | 'Multivariate Optimization';\n\ntype Algorithm =\n  | 'Polynomial Features + TheilSenRegressor'\n  | 'TheilSenRegressor'\n  | 'KMeans'\n  | 'DBScan'\n  | 'Isolation Forest'\n  | 'BNL';\n\ntype PredictionStats = {\n  ipns: string[];\n  isnp: string[];\n  matches: string[];\n};\n\nexport type Prediction = {\n  intent: IntentType;\n  algorithm: Algorithm;\n  info: any;\n  hash: string;\n  params: any;\n  rank_jaccard: number;\n  rank_auto_complete: number;\n  rank_nb: number;\n  dimensions: string[];\n  members: string[];\n  membership_stats: PredictionStats;\n};\n\nexport type Intent = Pick<Prediction, 'intent' | 'algorithm' | 'params' | 'dimensions' | 'info'>;\n\nexport function predictionToIntent({\n  intent,\n  algorithm,\n  info,\n  params,\n  dimensions,\n}: Prediction): Intent {\n  return { intent, algorithm, params, dimensions, info };\n}\n\nexport type PredictionResult = {\n  success: boolean;\n  errors: string[];\n  predictions: Prediction[];\n};\n","export function getPlotId(): string {\n  return `plot${new Date().getTime().toString()}`;\n}\n\nexport function getBrushId(): string {\n  return `brush${new Date().getTime().toString()}`;\n}\n\nexport function getAggregateID(): string {\n  return `agg${new Date().getTime().toString()}`;\n}\n\nexport function getWorkflowID(): string {\n  return `workflow${new Date().getTime().toString()}`;\n}\n","import { createAction } from '@visdesignlab/trrack';\n\nimport { Interaction } from '../../types/Interactions';\n\nimport { ReapplyEvents, State } from './../types/Provenance';\n\nfunction createNewAction() {\n  return createAction<State, [Interaction], ReapplyEvents>((state: State, interaction) => {\n    state.interaction = interaction;\n  }).saveStateMode('Complete');\n}\n\nexport function addInteractionCreator(event: ReapplyEvents, label: string) {\n  return createNewAction().setEventType(event).setLabel(label);\n}\n\nexport const addScatterplot = createNewAction()\n  .setEventType('Add Scatterplot')\n  .setLabel('Add Scatterplot');\n\nexport const addPCP = createNewAction().setEventType('Add Scatterplot').setLabel('Add PCP');\n\nexport const removeScatterplot = createNewAction()\n  .setEventType('Remove Scatterplot')\n  .setLabel('Remove Scatterplot');\n\nexport const addPointSelection = createNewAction()\n  .setEventType('Point Selection')\n  .setLabel('Select points');\n\nexport const addPointDeselection = createNewAction()\n  .setEventType('Point Deselection')\n  .setLabel('Unselect points');\n\nexport const addBrush = createNewAction().setLabel('Brush').setEventType('Add Brush');\nexport const updateBrush = createNewAction().setLabel('Brush').setEventType('Update Brush');\nexport const removeBrush = createNewAction().setLabel('Brush').setEventType('Remove Brush');\n\nexport const addIntentSelection = createNewAction()\n  .setLabel('Intent Selection')\n  .setEventType('Algorithmic Selection');\n\nexport const addFilter = createNewAction().setLabel('Filter Selections').setEventType('Filter');\n\nexport const assignLabel = createNewAction().setLabel('Label Selections').setEventType('Label');\n\nexport const assignCategory = createNewAction()\n  .setLabel('Categorize Selections')\n  .setEventType('Categorize');\n\nexport const addAggregate = createNewAction()\n  .setLabel('Aggregate Selections')\n  .setEventType('Label');\n\nexport const replaceAggregate = createNewAction().setLabel('Replace Aggregate');\n","import Axios from 'axios';\n\nimport { COMPUTE } from '../..';\nimport { CompareData } from '../ExploreStore';\nimport { DataPoint } from '../types/Dataset';\n\nexport const queryCompare = async <T>(base: DataPoint[], target: DataPoint[], provenance: T) => {\n  const { data } = await Axios.post<CompareData>(`${COMPUTE}/compare`, {\n    base,\n    target,\n    provenance,\n  });\n\n  return data;\n};\n","import Axios from 'axios';\n\nimport { Prediction } from '../../types/Prediction';\nimport { DataPoint } from '../types/Dataset';\n\nimport { PREDICT } from './../../index';\n\nexport async function queryPrediction(\n  _data: DataPoint[],\n  dimensions: string[],\n  selections: string[],\n) {\n  if (selections.length === 0) return [];\n\n  try {\n    const { data } = await Axios.post<Prediction[]>(`${PREDICT}/`, {\n      data: _data || [],\n      dimensions,\n      selections,\n    });\n\n    return data;\n  } catch {\n    return [];\n  }\n}\n","import Axios from 'axios';\n\nimport { PROJECT } from '../..';\nimport { Project } from '../types/Project';\n\nexport const queryProjects = async () => {\n  const { data } = await Axios.get<Project[]>(`${PROJECT}/all`);\n\n  return data;\n};\n","import { Provenance, ProvenanceGraph } from '@visdesignlab/trrack';\n\nimport { Interaction } from '../../types/Interactions';\n\nexport type State = {\n  interaction: Interaction;\n};\n\nexport const initState: State = {\n  interaction: {\n    i_type: 'Root',\n  },\n};\n\nexport type ReapplyEvents =\n  | 'Add Scatterplot'\n  | 'Remove Scatterplot'\n  | 'Point Selection'\n  | 'Point Deselection'\n  | 'Add Brush'\n  | 'Update Brush'\n  | 'Remove Brush'\n  | 'Filter'\n  | 'Label'\n  | 'Aggregate'\n  | 'Categorize'\n  | 'Algorithmic Selection';\n\ntype Status = 'Accepted' | 'Rejected' | 'Unknown';\n\nexport type NodeStatus = {\n  original_record: string;\n  status: { [nodeId: string]: Status };\n};\n\nexport type ReapplyProvenance = Provenance<State, ReapplyEvents, NodeStatus>;\nexport type ReapplyGraph = ProvenanceGraph<ReapplyEvents, void>;\n","import Axios from 'axios';\n\nimport { BrushCollection } from '../components/Brushes/Rectangular Brush/Types/Brush';\n\nimport { COMPUTE } from './../index';\nimport { PCPSpec, ScatterplotSpec, ViewSpec } from './../types/Interactions';\nimport { StateRecord } from './ExploreStore';\nimport { DataPoint } from './types/Dataset';\nimport { ReapplyGraph } from './types/Provenance';\n\ntype BaseView = {\n  id: string;\n  brushes: BrushCollection;\n  brushSelections: { [key: string]: string[] };\n  spec: ViewSpec;\n};\n\nexport type ScatterplotView = BaseView & {\n  type: 'Scatterplot';\n  x: string;\n  y: string;\n  spec: ScatterplotSpec;\n};\n\nexport type PCPView = BaseView & {\n  type: 'PCP';\n  dimensions: string[];\n  spec: PCPSpec;\n};\n\nexport type View = ScatterplotView | PCPView;\n\n// # View State\nexport type ViewState = {\n  views: { [k: string]: View };\n  labels: { [k: string]: string[] };\n  freeformSelections: string[];\n  filteredPoints: string[];\n  selections: string[];\n  categoryAssignments: { [categoryName: string]: { [value: string]: string[] } };\n  aggregates: {\n    [id: string]: {\n      name: string;\n      values: string[];\n      aggregate: DataPoint;\n    };\n  };\n};\n\nexport const defaultViewState: ViewState = {\n  views: {},\n  labels: {},\n  filteredPoints: [],\n  categoryAssignments: {},\n  freeformSelections: [],\n  aggregates: {},\n  selections: [],\n};\n\n// Helper Functions\n\nexport function clearSelections(state: ViewState): ViewState {\n  Object.entries(state.views).forEach(([id, view]) => {\n    view.brushSelections = {};\n    view.brushes = {};\n    state.views[id] = view;\n  });\n\n  state.freeformSelections = [];\n\n  return state;\n}\n\nexport function getSelections(state: ViewState): string[] {\n  const selections: string[] = [...state.freeformSelections];\n\n  Object.values(state.views).forEach((view) => {\n    Object.values(view.brushSelections).forEach((sels) => selections.push(...sels));\n  });\n\n  return [...new Set(selections)].sort();\n}\n\nexport function getDimensions(state: ViewState): string[] {\n  const dims: string[] = [];\n  Object.values(state.views).forEach((d) => {\n    if (d.type === 'Scatterplot') dims.push(...[d.x, d.y]);\n    // else dims.push(...d.dimensions);\n  });\n\n  return [...new Set(dims)];\n}\n\nexport function getView(spec: ViewSpec): View {\n  if (spec.type === 'Scatterplot') {\n    return {\n      id: spec.id,\n      type: 'Scatterplot',\n      x: spec.dimensions[0],\n      y: spec.dimensions[1],\n      spec,\n      brushes: {},\n      brushSelections: {},\n    };\n  }\n\n  return {\n    id: spec.id,\n    type: 'PCP',\n    spec,\n    dimensions: spec.dimensions,\n    brushes: {},\n    brushSelections: {},\n  };\n}\n\nexport async function queryState(_data: DataPoint[], provenance: ReapplyGraph) {\n  const { data } = await Axios.post<StateRecord>(`${COMPUTE}/state`, {\n    data: _data,\n    provenance,\n  });\n\n  return data;\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { isChildNode, ProvenanceGraph } from '@visdesignlab/trrack';\nimport { IReactionDisposer, makeAutoObservable, reaction, runInAction, toJS } from 'mobx';\n\nimport { getAllCustomWorkflows, syncWorkflow } from '../Firebase/firebase';\n\ntype WorkflowGraph = ProvenanceGraph<unknown, unknown>;\n\nexport type CustomWorkflow = {\n  id: string;\n  type: 'Custom';\n  name: string;\n  project: string;\n  project_name: string;\n  graph: WorkflowGraph;\n  order: string[];\n};\n\nconst defaultGraph: WorkflowGraph = {\n  root: '',\n  current: '',\n  nodes: {},\n};\n\nexport default class WorkflowStore<T> {\n  id: string;\n  project: string;\n  project_name: string;\n  order: string[] = [];\n  name: string | null = null;\n  graph: T;\n  type = 'Default';\n  committed: boolean;\n  customWorkflows: { [wf_id: string]: CustomWorkflow } = {};\n  currentWorkflow: CustomWorkflow | null = null;\n  currentWorkflowReaction: IReactionDisposer | null = null;\n  isSyncing: 'Not Syncing' | 'Syncing' = 'Not Syncing';\n  syncStatus: 'syncing' | 'done' = 'syncing';\n\n  constructor(\n    id: string,\n    project: string,\n    project_name: string,\n    graph: T,\n    name: string | null = null,\n    order: string[] = [],\n    type = 'Default',\n    committed = false,\n  ) {\n    this.id = id;\n    this.project = project;\n    this.name = name;\n    this.type = type;\n    this.project_name = project_name;\n    this.order = order;\n    this.graph = graph;\n    this.committed = committed;\n\n    makeAutoObservable(this);\n\n    this.getAllCustomWorkflows(project);\n\n    reaction(\n      () => toJS(this.graph),\n      () => this.sync(),\n    );\n  }\n\n  getAllCustomWorkflows = async (pid: string) => {\n    const wfs = await getAllCustomWorkflows(pid);\n    runInAction(() => {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const wfDict: { [key: string]: CustomWorkflow } = {};\n      wfs.forEach((wf) => {\n        wfDict[wf.id] = wf;\n      });\n\n      this.customWorkflows = wfDict;\n    });\n  };\n\n  setCurrentWorkflow = (id?: string) => {\n    if (!id) {\n      const newWorkflow: CustomWorkflow = {\n        id: Date.now().toString(),\n        type: 'Custom',\n        name: '',\n        project: this.project,\n        project_name: this.project_name,\n        graph: defaultGraph,\n        order: [],\n      };\n\n      this.currentWorkflow = newWorkflow;\n    } else {\n      console.log('Test');\n      this.currentWorkflow = this.customWorkflows[id];\n    }\n  };\n\n  setProject = (projectId: string) => {\n    this.project = projectId;\n  };\n\n  get doesCurrentHaveWorkflow() {\n    return Boolean(this.currentWorkflow?.graph.root !== '');\n  }\n\n  removeFromWorkflow = (id: string) => {\n    if (!this.currentWorkflow) return;\n\n    if (!this.currentWorkflow.graph) return;\n\n    const order = this.currentWorkflow.order;\n\n    this.currentWorkflow.order = order.filter((d) => d !== id);\n    delete this.currentWorkflow.graph.nodes[id];\n  };\n\n  addToWorkflow = (id: string) => {\n    if (!this.currentWorkflow) return;\n\n    const graph: WorkflowGraph = toJS(this.graph as any);\n\n    let current = graph.nodes[id];\n    let order: string[] = [];\n\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      order.push(current.id);\n\n      if (!isChildNode(current)) break;\n\n      const parent = graph.nodes[current.parent];\n      current = parent;\n    }\n\n    order = order.reverse();\n\n    const wfGraph: WorkflowGraph = {\n      current: order[order.length - 1],\n      root: order[0],\n      nodes: {},\n    };\n\n    order.forEach((ord) => {\n      const node: any = graph.nodes[ord];\n\n      wfGraph.nodes[node.id] = toJS(node);\n    });\n\n    this.currentWorkflow.graph = wfGraph;\n    this.currentWorkflow.order = order;\n  };\n\n  setWorkflowName = (name: string) => {\n    if (!this.currentWorkflow) return;\n\n    this.currentWorkflow.name = name;\n  };\n\n  updateGraph = (graph: T) => {\n    runInAction(() => {\n      this.graph = graph;\n    });\n  };\n\n  toJS = () => {\n    return {\n      id: this.id,\n      project: this.project,\n      graph: this.graph,\n    };\n  };\n\n  toggleSync = () => {\n    this.isSyncing = this.isSyncing === 'Syncing' ? 'Not Syncing' : 'Syncing';\n\n    if (this.currentWorkflowReaction) {\n      this.currentWorkflowReaction();\n    }\n\n    if (this.isSyncing) {\n      this.currentWorkflowReaction = reaction(\n        () => toJS(this.currentWorkflow),\n        (wf) => {\n          if (!wf) return;\n          this.syncCustomWorkflow(wf);\n        },\n        {\n          fireImmediately: true,\n        },\n      );\n    } else {\n      this.currentWorkflowReaction = null;\n    }\n  };\n\n  syncCustomWorkflow = (wf: CustomWorkflow) => {\n    const { id, type, name, graph, project, project_name, order } = wf;\n\n    if (graph.root === '' || graph.current === '' || name === '') return;\n\n    order.forEach((node_id, idx) => {\n      graph.nodes[node_id].children =\n        idx !== order.length - 1 ? [graph.nodes[order[idx + 1]].id] : [];\n\n      const node = graph.nodes[node_id];\n\n      if (isChildNode(node) && idx !== 0) {\n        node.parent = graph.nodes[order[idx - 1]].id;\n      }\n\n      graph.nodes[node_id] = node;\n    });\n\n    graph.current = order[order.length - 1];\n    graph.root = order[0];\n\n    syncWorkflow({\n      id,\n      name,\n      graph,\n      type,\n      project,\n      project_name,\n      order,\n    });\n  };\n\n  sync = () => {\n    this.committed = true;\n    syncWorkflow({\n      id: this.id,\n      project: this.project,\n      project_name: this.project_name,\n      graph: this.graph,\n      order: this.order,\n      name: this.name as any,\n      type: this.type,\n    });\n  };\n}\n","/* eslint-disable @typescript-eslint/no-empty-function */\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { initProvenance, isChildNode, NodeID } from '@visdesignlab/trrack';\nimport { extent } from 'd3';\nimport { action, makeAutoObservable, reaction, runInAction, toJS, when } from 'mobx';\n\nimport { BrushSize } from '../components/Brushes/FreeFormBrush';\nimport {\n  BrushAffectType,\n  BrushCollection,\n} from '../components/Brushes/Rectangular Brush/Types/Brush';\nimport { ScatterplotPoint } from '../components/Scatterplot/Scatterplot';\nimport { checkIfWorkflowExists, loadWorkflowFromFirebase } from '../Firebase/firebase';\nimport { PCPSpec, ScatterplotSpec, Selection } from '../types/Interactions';\nimport { Prediction, predictionToIntent } from '../types/Prediction';\nimport { getAggregateID, getPlotId } from '../utils/IDGens';\n\nimport { AggMap } from './../contexts/CategoryContext';\nimport { OriginMap, Source } from './../library/trrack-vis/Utils/BundleMap';\nimport {\n  addAggregate,\n  addBrush,\n  addFilter,\n  addIntentSelection,\n  addPCP,\n  addPointSelection,\n  addScatterplot,\n  assignCategory,\n  assignLabel,\n  removeBrush,\n  removeScatterplot,\n  updateBrush,\n} from './provenance/actions';\nimport { queryCompare } from './queries/queryCompare';\nimport { queryPrediction } from './queries/queryPrediction';\nimport { queryProjects } from './queries/queryProjects';\nimport RootStore from './RootStore';\nimport { DataPoint } from './types/Dataset';\nimport { initState, NodeStatus, ReapplyProvenance } from './types/Provenance';\nimport {\n  defaultViewState,\n  getDimensions,\n  getSelections,\n  PCPView,\n  queryState,\n  ScatterplotView,\n  View,\n  ViewState,\n} from './ViewState';\nimport WorkflowStore from './WorkflowStore';\n\nexport const CUSTOM_LABEL = 'customlabel';\nexport const CUSTOM_CATEGORY_ASSIGNMENT = 'customCategoryAssignment';\n\nexport type StateRecord = Record<NodeID, ViewState>;\n\nexport type FreeFormBrushType = 'Freeform Small' | 'Freeform Medium' | 'Freeform Large';\n\nexport type BrushType = FreeFormBrushType | 'Rectangular' | 'None';\n\nexport const BrushSizeMap: { [key in FreeFormBrushType]: BrushSize } = {\n  'Freeform Small': 20,\n  'Freeform Medium': 35,\n  'Freeform Large': 50,\n};\n\nexport type HighlightPredicate = (point: ScatterplotPoint) => boolean;\nexport type ColorPredicate = (point: ScatterplotPoint) => string;\n\nexport type CompareData = {\n  data: DataPoint[];\n  compare: {\n    [node: string]: {\n      changes: {\n        added: string[];\n        removed: string[];\n        updated: string[];\n        updateMap: { source: string; target: string; id: string }[];\n        results: string[];\n      };\n      state: ViewState;\n    };\n  };\n};\n\nconst defaultCompareData: CompareData = {\n  data: [],\n  compare: {},\n};\n\nexport default class ExploreStore {\n  root: RootStore;\n  plotType: 'scatterplot' | 'pcp' | 'none' = 'none';\n  showCategories = false;\n  selectedCategoryColumn: string | null = null;\n  brushType: BrushType = 'Freeform Medium';\n  showLabelLayer = true;\n  highlightMode = false;\n  highlightPredicate: HighlightPredicate | null = null;\n  colorPredicate: ColorPredicate | null = null;\n  hideAggregateMembers = false;\n  showMatchesLegend = false;\n  predictions: {\n    isLoading: boolean;\n    values: Prediction[];\n  } = { isLoading: false, values: [] };\n  provenance: ReapplyProvenance;\n  workflow: WorkflowStore<typeof this.provenance.graph> | null = null;\n  compareMode = false;\n  compareTarget: string | null = null;\n  compareData: CompareData = defaultCompareData;\n  hoveredPrediction: Prediction | null = null;\n  import = false;\n  showGlobalScale = false;\n\n  // Vis state\n  record: StateRecord = {};\n  lastAccessed = '';\n\n  constructor(root: RootStore) {\n    this.root = root;\n\n    this.provenance = initProvenance(initState);\n    this.provenance.done();\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (window as any).printProvenanceTable = (keysToShow: string[] = ['id', 'label']) => {\n      // eslint-disable-next-line no-console\n      console.table(Object.values(toJS(this.provenance.graph.nodes)), keysToShow);\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (window as any).printProvenance = () => {\n      // eslint-disable-next-line no-console\n      console.log(this.provenance.state);\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (window as any).printRawProvenance = () => {\n      // eslint-disable-next-line no-console\n      console.log(toJS(this.provenance.graph));\n    };\n\n    makeAutoObservable(this, {\n      // getState: action,\n      updateRecord: action,\n      stateHelper: action,\n      refreshPrediction: action,\n      toggleShowCategories: action,\n      setCompareTarget: action,\n      switchBrush: action,\n      toggleLabelLayer: action,\n      switchCompareMode: action,\n      toggleHideAggregateMembers: action,\n      setHoveredPrediction: action,\n    });\n\n    // If category is toggled on first time, load the default category column and dispose self\n    const category_reaction = when(\n      () => this.showCategories && this.data !== null,\n      () => {\n        if (this.data && this.doesHaveCategories && this.selectedCategoryColumn === null) {\n          this.selectedCategoryColumn = this.data.categoricalColumns[0];\n        }\n      },\n    );\n\n    // Once data is loaded and it does not have categories, dispose category_reaction, then dispose self\n    reaction(\n      () => this.data,\n      (arg, _, r) => {\n        if (arg) {\n          if (!this.doesHaveCategories) {\n            category_reaction();\n          }\n          r.dispose();\n        }\n      },\n    );\n\n    reaction(\n      () => toJS(this.provenance.graph),\n      (graph) => {\n        if (this.workflow) this.workflow.updateGraph(graph);\n      },\n    );\n\n    reaction(\n      () => ({\n        dataset_id: this.dataset_id,\n        provenance: Object.values(this.provenance.graph.nodes).length,\n      }),\n      ({ dataset_id }) => {\n        if (dataset_id) this.updateRecord(dataset_id, this.provenance.graph);\n      },\n    );\n\n    reaction(\n      () => this.state,\n      (st) => this.refreshPrediction(st),\n    );\n\n    if (root.opts.debug === 'on') {\n      this.toggleShowCategories(root.opts.showCategories);\n      const btype = localStorage.getItem('btype');\n      this.switchBrush(((btype as unknown) || this.brushType) as BrushType);\n    }\n\n    reaction(\n      () => ({\n        mode: this.compareMode,\n        target: this.compareTarget,\n      }),\n      ({ mode, target }) => {\n        if (!mode || !target || !this.dataset_id) return;\n        this.getCompareData(this.dataset_id, target);\n      },\n    );\n\n    reaction(\n      () => Object.values(this.provenance.graph.nodes).length,\n      () => {\n        if (this.import) return;\n\n        const { current } = this.provenance;\n\n        if (isChildNode(current)) {\n          const artifact: NodeStatus = {\n            original_record: this.dataset_id || '',\n            status: {},\n          };\n\n          this.root.projectStore.project?.datasets.forEach((dataset) => {\n            if (dataset.id === this.dataset_id) {\n              artifact.status[dataset.id] = 'Accepted';\n            } else {\n              artifact.status[dataset.id] = 'Unknown';\n            }\n          });\n\n          this.provenance.addArtifact(artifact);\n        }\n      },\n    );\n  }\n\n  // Getters\n  get query() {\n    return this.root.query;\n  }\n\n  get dataset_id() {\n    return this.root.projectStore.dataset_id;\n  }\n\n  get base_dataset_id() {\n    return this.dataset_id;\n  }\n\n  get data() {\n    return this.root.projectStore.data;\n  }\n\n  get rawDataPoints() {\n    return this.data?.values || [];\n  }\n\n  get nodeCreationMap() {\n    const originMap: OriginMap = {};\n\n    Object.values(this.provenance.graph.nodes).forEach((node) => {\n      const art = this.provenance.getLatestArtifact(node.id);\n\n      if (!art) return;\n\n      const { artifact } = art;\n\n      const datasetKey = this.root.projectStore.datasetVersionFromKey(artifact.original_record);\n      const source: Source = {\n        createdIn: datasetKey,\n        approvedIn: Object.entries(artifact.status)\n          .filter((v) => v[1] === 'Accepted')\n          .map((v) => this.root.projectStore.datasetVersionFromKey(v[0])),\n        rejectedIn: Object.entries(artifact.status)\n          .filter((v) => v[1] === 'Rejected')\n          .map((v) => this.root.projectStore.datasetVersionFromKey(v[0])),\n      };\n      originMap[node.id] = source;\n    });\n\n    return originMap;\n  }\n\n  get rangeMap() {\n    const datas = Object.values(this.root.projectStore._data);\n\n    const m: { [k: string]: { min: number; max: number } } = {};\n\n    if (this.showGlobalScale) {\n      datas.forEach((data) => {\n        const { columnInfo, values = [] } = data;\n\n        Object.keys(columnInfo).forEach((col) => {\n          const [min = -1, max = -1] = extent(values.map((v) => v[col]) as number[]);\n\n          if (!m[col]) {\n            m[col] = { min, max };\n          } else {\n            m[col].min = m[col].min < min ? m[col].min : min;\n            m[col].max = m[col].max > max ? m[col].max : max;\n          }\n        });\n      });\n    } else {\n      if (!this.data) return m;\n      const values = this.dataPoints;\n      const { columnInfo } = this.data;\n\n      Object.keys(columnInfo).forEach((col) => {\n        const [min = -1, max = -1] = extent(values.map((v) => v[col]) as number[]);\n\n        if (!m[col]) {\n          m[col] = { min, max };\n        } else {\n          m[col].min = m[col].min < min ? m[col].min : min;\n          m[col].max = m[col].max > max ? m[col].max : max;\n        }\n      });\n    }\n\n    return m;\n  }\n\n  get dataPoints() {\n    return this.computeDataPoints(this.state, this.rawDataPoints);\n  }\n\n  get aggregateDataPoints() {\n    const { aggregates } = this.state;\n\n    const agg: DataPoint[] = [];\n\n    Object.values(aggregates).forEach((a) => {\n      agg.push(a.aggregate);\n    });\n\n    return agg;\n  }\n\n  computeDataPoints(state: ViewState, rawDataPoints: DataPoint[], applyTransforms = true) {\n    if (rawDataPoints.length === 0) return rawDataPoints;\n\n    const data: { [k: string]: DataPoint } = {};\n\n    rawDataPoints\n      .filter((d) => !state.filteredPoints.includes(d.id))\n      .forEach((pt) => {\n        data[pt.id] = toJS(pt);\n      });\n\n    if (applyTransforms) {\n      Object.entries(state.labels).forEach(([label, ids]) => {\n        ids.forEach((id) => {\n          if (!data[id]) return;\n\n          if (!data[id][CUSTOM_LABEL]) data[id][CUSTOM_LABEL] = [label];\n          else data[id][CUSTOM_LABEL].push(label);\n        });\n      });\n\n      Object.entries(state.categoryAssignments).forEach(([category, assignments]) => {\n        if (category !== this.selectedCategoryColumn) return;\n        Object.entries(assignments).forEach(([label, values]) => {\n          values.forEach((id) => {\n            data[id][CUSTOM_CATEGORY_ASSIGNMENT] = label;\n          });\n        });\n      });\n    }\n\n    return Object.values(data);\n  }\n\n  get doesHaveCategories() {\n    if (!this.data) return false;\n\n    return this.data.categoricalColumns.length > 0;\n  }\n\n  get changes() {\n    const id = this.provenance.graph.current;\n    const compareRecord = this.compareData.compare[id];\n\n    if (!compareRecord)\n      return {\n        added: [],\n        removed: [],\n        updated: [],\n        updateMap: [],\n        results: [],\n      };\n\n    return compareRecord.changes;\n  }\n\n  get state() {\n    const id = this.provenance.graph.current;\n    let record = this.record[id];\n    const compareRecord = this.compareData.compare[id];\n\n    if (this.compareMode) {\n      if (!compareRecord) {\n        record = compareRecord;\n      } else {\n        record = compareRecord.state;\n      }\n    }\n\n    return this.stateHelper(id, record);\n  }\n\n  get selections() {\n    return this.state.selections;\n  }\n\n  stateHelper = (id: NodeID, state?: ViewState) => {\n    let st: ViewState =\n      this.lastAccessed !== '' ? toJS(this.record[this.lastAccessed]) : defaultViewState;\n\n    if (state) {\n      st = toJS(state);\n      this.lastAccessed = id;\n    }\n\n    const scatterplots = Object.values(st.views).filter(\n      (c) => c.type === 'Scatterplot',\n    ) as ScatterplotView[];\n    const pcps = Object.values(st.views).filter((c) => c.type === 'PCP') as PCPView[];\n\n    return { ...st, scatterplots, pcps };\n  };\n\n  // Provenance Actions\n  addScatterplot = (x?: string, y?: string) => {\n    if (!this.data) return;\n\n    if (this.plotType === 'none') {\n      this.plotType = 'scatterplot';\n    }\n\n    if (!x || !y) {\n      const spec: ScatterplotSpec = {\n        i_type: 'ViewSpec',\n        id: getPlotId(),\n        type: 'Scatterplot',\n        action: 'Add',\n        dimensions: [this.data.numericColumns[0], this.data.numericColumns[1]],\n      };\n\n      this.provenance.apply(\n        addScatterplot(spec),\n        `Adding scatterplot for ${spec.dimensions[0]}-${spec.dimensions[1]}`,\n      );\n    } else {\n      const spec: ScatterplotSpec = {\n        i_type: 'ViewSpec',\n        id: getPlotId(),\n        action: 'Add',\n        type: 'Scatterplot',\n        dimensions: [x, y],\n      };\n\n      this.provenance.apply(addScatterplot(spec), `Adding scatterplot for ${x}-${y}`);\n    }\n  };\n\n  addPCP = (dimensions: string[] = []) => {\n    if (!this.data) return;\n\n    if (dimensions.length === 0) {\n      const spec: PCPSpec = {\n        i_type: 'ViewSpec',\n        id: getPlotId(),\n        type: 'PCP',\n        action: 'Create',\n        dimensions: this.data.numericColumns.slice(0, 4),\n      };\n\n      this.provenance.apply(addPCP(spec), 'Adding PCP');\n    } else {\n      const spec: PCPSpec = {\n        i_type: 'ViewSpec',\n        id: getPlotId(),\n        type: 'PCP',\n        action: 'Create',\n        dimensions,\n      };\n\n      this.provenance.apply(addPCP(spec), 'Adding PCP');\n    }\n  };\n\n  removeScatterplot = (id: string) => {\n    this.provenance.apply(\n      removeScatterplot({\n        i_type: 'ViewSpec',\n        id,\n        action: 'Remove',\n        type: 'Scatterplot',\n        dimensions: [],\n      }),\n      'Remove Scatterplot',\n    );\n  };\n\n  selectPointsFreeform = (points: string[], view: View) => {\n    if (!this.data) return;\n\n    const spec = view.spec;\n\n    const pointSelection: Selection = {\n      i_type: 'Selection',\n      type: 'Point',\n      action: 'Selection',\n      ids: points,\n    };\n\n    this.provenance.apply(addPointSelection(pointSelection), `Select ${points.length} points`);\n  };\n\n  unselectPointsFreeform = (points: string[], view: View) => {\n    if (!this.data) return;\n    const spec = view.spec;\n\n    const currentViewSelections = this.state.freeformSelections;\n\n    const ids = points.filter((p) => currentViewSelections.includes(p));\n\n    const pointSelection: Selection = {\n      i_type: 'Selection',\n      type: 'Point',\n      action: 'Deselection',\n      ids,\n    };\n\n    this.provenance.apply(addPointSelection(pointSelection), `Unselect ${ids.length} points`);\n  };\n\n  handleBrushSelection = (\n    _spec: View,\n    brushes: BrushCollection,\n    type: BrushAffectType,\n    affectedId: string,\n  ) => {\n    const currentBrush = brushes[affectedId];\n\n    const spec = _spec.spec;\n\n    switch (type) {\n      case 'Add': {\n        const { x1, x2, y1, y2 } = currentBrush.extents;\n\n        if (spec.type === 'Scatterplot') {\n          const extents = {\n            [spec.dimensions[0]]: { min: x1, max: x2 },\n            [spec.dimensions[1]]: { min: y1, max: y2 },\n          };\n\n          const interaction: Selection = {\n            i_type: 'Selection',\n            type: 'Range',\n            rangeId: currentBrush.id,\n            action: 'Add',\n            view: spec.id,\n            extents,\n          };\n\n          this.provenance.apply(addBrush(interaction), 'Add Brush');\n        }\n        break;\n      }\n      case 'Update': {\n        const { x1, x2, y1, y2 } = currentBrush.extents;\n\n        if (spec.type === 'Scatterplot') {\n          const extents = {\n            [spec.dimensions[0]]: { min: x1, max: x2 },\n            [spec.dimensions[1]]: { min: y1, max: y2 },\n          };\n\n          this.provenance.apply(\n            updateBrush({\n              i_type: 'Selection',\n              type: 'Range',\n              view: spec.id,\n              rangeId: currentBrush.id,\n              action: 'Update',\n              extents,\n            }),\n            'Update Brush',\n          );\n        }\n        break;\n      }\n      case 'Remove':\n        this.provenance.apply(\n          removeBrush({\n            i_type: 'Selection',\n            type: 'Range',\n            rangeId: affectedId,\n            action: 'Remove',\n            view: spec.id,\n            extents: {},\n          }),\n          'Remove Brush',\n        );\n        break;\n      case 'Clear':\n      default:\n        break;\n    }\n  };\n\n  handleIntentSelection = (prediction: Prediction) => {\n    this.provenance.apply(\n      addIntentSelection({\n        i_type: 'Selection',\n        type: 'Algorithmic',\n        apply: predictionToIntent(prediction),\n      }),\n      `Apply ${prediction.intent} selection`,\n    );\n  };\n\n  handleFilter = (filterType: 'In' | 'Out') => {\n    this.provenance.apply(\n      addFilter({\n        i_type: 'Filter',\n        action: filterType,\n      }),\n      `Filter ${filterType}`,\n    );\n  };\n\n  handleLabelling = (label: string) => {\n    this.provenance.apply(\n      assignLabel({\n        i_type: 'Label',\n        as: label,\n      }),\n      `Assign label ${label}`,\n    );\n  };\n\n  handleCategorization = (category: string, value: string) => {\n    this.provenance.apply(\n      assignCategory({\n        i_type: 'Categorize',\n        in: category,\n        as: value,\n      }),\n    );\n  };\n\n  handleAggregate = (name: string, aggOptions: AggMap, drop = false) => {\n    this.provenance.apply(\n      addAggregate({\n        i_type: 'Aggregation',\n        name,\n        id: getAggregateID(),\n        drop,\n        rules: aggOptions,\n      }),\n    );\n  };\n\n  // Mobx Actions\n  switchCompareMode = (enable: boolean) => {\n    this.compareMode = enable;\n  };\n\n  setCompareTarget = (id: string) => {\n    this.compareTarget = id;\n  };\n\n  setHoveredPrediction = (pred: Prediction | null) => {\n    this.hoveredPrediction = pred;\n  };\n\n  loadWorkflow = async (id: string) => {\n    const workflowExists = await checkIfWorkflowExists(id);\n\n    if (!workflowExists) {\n      const project = this.root.projectStore.project;\n      runInAction(() => {\n        if (project) {\n          this.workflow = new WorkflowStore(\n            id,\n            project.id,\n            project.name,\n            toJS(this.provenance.graph),\n            null,\n            [],\n            'Default',\n          );\n          this.workflow.sync();\n        }\n      });\n    } else {\n      runInAction(() => {\n        this.import = true;\n      });\n\n      const projects = await this.query.fetchQuery('projects', () => queryProjects());\n\n      if (projects.length === 0) return;\n\n      const wf = await loadWorkflowFromFirebase(id);\n      const { id: wf_Id, project, project_name, graph, order, name, type } = wf;\n\n      this.root.projectStore.setProjects(projects);\n      this.root.projectStore.setCurrentProject(project);\n\n      if (!this.root.projectStore.project) return;\n      await this.root.projectStore.getData(this.root.projectStore.project);\n\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      Object.entries(graph.nodes).forEach(([id, node]: [any, any]) => {\n        const children = node.children;\n\n        if (!children) node.children = [];\n        graph.nodes[id] = node;\n      });\n\n      this.provenance.importProvenanceGraph(graph);\n      this.root.projectStore.setDatasetId(this.root.projectStore.projects[project].datasets[0].id);\n\n      this.updateRecord(this.dataset_id || '', this.provenance.graph);\n      this.refreshPrediction();\n      runInAction(() => {\n        this.workflow = new WorkflowStore(wf_Id, project, project_name, graph, name, order, type);\n      });\n\n      runInAction(() => {\n        this.import = false;\n      });\n    }\n  };\n\n  refreshPrediction = (_state?: ViewState) => {\n    const state = _state ? _state : this.state;\n    const selections = getSelections(state);\n    const dimensions = getDimensions(state);\n    const dataValues = this.dataPoints;\n\n    if (selections.length === 0) {\n      runInAction(\n        () =>\n          (this.predictions = {\n            isLoading: false,\n            values: [],\n          }),\n      );\n\n      return;\n    }\n\n    runInAction(() => {\n      this.predictions.isLoading = true;\n    });\n\n    this.query\n      .fetchQuery(\n        ['predictions', this.dataset_id, selections, dimensions, dataValues],\n        () => queryPrediction(dataValues, dimensions, selections),\n        { retry: 100 },\n      )\n      .then((pred) => {\n        runInAction(() => {\n          this.predictions = { isLoading: false, values: pred };\n        });\n      });\n  };\n\n  approveNode = (nodeId: string) => {\n    let { artifact = null } = this.provenance.getLatestArtifact(nodeId) || {};\n\n    artifact = JSON.parse(JSON.stringify(artifact));\n\n    if (artifact) {\n      artifact.status[this.dataset_id || ''] = 'Accepted';\n      this.provenance.addArtifact(artifact, nodeId);\n    }\n  };\n\n  rejectNode = (nodeId: string) => {\n    let { artifact = null } = this.provenance.getLatestArtifact(nodeId) || {};\n\n    artifact = JSON.parse(JSON.stringify(artifact));\n\n    if (artifact) {\n      artifact.status[this.dataset_id || ''] = 'Rejected';\n      this.provenance.addArtifact(artifact, nodeId);\n    }\n  };\n\n  toggleHideAggregateMembers = () => (this.hideAggregateMembers = !this.hideAggregateMembers);\n\n  toggleLabelLayer = (show?: boolean) => {\n    if (show) this.showLabelLayer = show;\n    else this.showLabelLayer = !this.showLabelLayer;\n  };\n\n  switchBrush = (btype: BrushType) => {\n    if (this.root.opts.debug === 'on') {\n      localStorage.setItem('btype', btype);\n    }\n\n    this.brushType = btype;\n  };\n\n  toggleShowCategories = (show: unknown | null = null) => {\n    if (typeof show === 'boolean') {\n      this.showCategories = show;\n    } else {\n      this.showCategories = !this.showCategories;\n    }\n  };\n\n  setHighlightMode = (highlight: boolean) => (this.highlightMode = highlight);\n\n  setHighlightPredicate = (predicate: HighlightPredicate | null) =>\n    (this.highlightPredicate = predicate);\n\n  setColorPredicate = (predicate: ColorPredicate | null) => (this.colorPredicate = predicate);\n\n  setShowMatchesLegend = (show: boolean) => (this.showMatchesLegend = show);\n\n  changeCategoryColumn = (col: string | null) => {\n    if (!this.data || !col) return;\n\n    if (this.data.categoricalColumns.includes(col)) this.selectedCategoryColumn = col;\n    else throw new Error('Undefined column');\n\n    localStorage.setItem('category-column', col);\n  };\n\n  getCompareData = (base: string, target: string) => {\n    const graph = this.provenance.graph;\n    this.query\n      .fetchQuery(['compare', this.dataset_id, this.compareTarget, graph], () =>\n        queryCompare(\n          this.root.projectStore._data[base].values,\n          this.root.projectStore._data[target].values,\n          graph,\n        ),\n      )\n      .then((data) => {\n        runInAction(() => {\n          this.compareData = data;\n        });\n      });\n  };\n\n  setShowGlobalScale = (val: boolean) => {\n    this.showGlobalScale = val;\n  };\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  updateRecord = (dataset_id: string, graph: any) => {\n    this.query\n      .fetchQuery(['state', dataset_id, graph], () => queryState(this.rawDataPoints, graph))\n      .then((rec) => {\n        runInAction(() => {\n          this.record = rec;\n        });\n      });\n  };\n}\n\n// Applying action in provenance triggers a reaction,\n// This checks if the visState is available for current node,\n// If yes, return\n// If not, then go and calculate it recursively\n","import { gql } from '@apollo/client';\n\nimport { apolloClient } from '../..';\n\nimport { CategoryResult } from './../types/Project';\n\nconst ADD_CATEGORY = gql`\n  mutation add_category_column($projectId: ID!, $columnName: String!, $options: String!) {\n    addCategoryColumn(projectId: $projectId, columnName: $columnName, options: $options) {\n      errors\n      success\n      columnInfo\n      numericColumns\n      categoricalColumns\n      labelColumn\n      columns\n    }\n  }\n`;\n\nexport function addCategory(projectId: string, columnName: string, options: string) {\n  return apolloClient.mutate<CategoryResult>({\n    mutation: ADD_CATEGORY,\n    variables: { projectId, columnName, options },\n  });\n}\n","import Axios from 'axios';\n\nimport { DATA } from '../..';\nimport { Data } from '../types/Dataset';\n\nexport const queryData = async (rid: string) => {\n  const { data } = await Axios.get<Data>(`${DATA}/${rid}`);\n\n  return data;\n};\n","import { action, makeAutoObservable, reaction, runInAction } from 'mobx';\n\nimport { addCategory } from './queries/mutateCategoryColumn';\nimport { queryData } from './queries/queryData';\nimport RootStore from './RootStore';\nimport { Data } from './types/Dataset';\nimport { Project } from './types/Project';\n\nexport default class ProjectStore {\n  root: RootStore;\n  project_id: string | null = null;\n  dataset_id: string | null = null;\n  _data: { [id: string]: Data } = {};\n  projects: { [id: string]: Project } = {};\n\n  constructor(root: RootStore) {\n    this.root = root;\n    makeAutoObservable(this, {\n      setCurrentProject: action,\n    });\n    reaction(\n      () => this.project,\n      (project) => {\n        if (project) this.getData(project);\n      },\n    );\n  }\n\n  get project() {\n    if (!this.project_id) return null;\n\n    return this.projects[this.project_id];\n  }\n\n  get data() {\n    if (!this.dataset_id) return null;\n\n    return this._data[this.dataset_id];\n  }\n\n  get query() {\n    return this.root.query;\n  }\n\n  datasetVersionFromKey = (key: string | null) => {\n    if (!key) return '';\n\n    const { version = '' } = this._data[key] || {};\n\n    return version;\n  };\n\n  setProjects = (projects: Project[]) => {\n    const prj: { [id: string]: Project } = {};\n    projects.forEach((proj) => {\n      prj[proj.id] = proj;\n    });\n\n    runInAction(() => {\n      this.projects = prj;\n    });\n  };\n\n  setCurrentProject = (project_id: string) => {\n    localStorage.removeItem('aggOpt');\n\n    this.project_id = project_id;\n  };\n\n  setDatasetId = (id: string) => {\n    this.dataset_id = id;\n  };\n\n  addCategoryColumn = async (columnName: string, options: string) => {\n    if (!this.project) return;\n\n    const { data: d } = await addCategory(this.project.id, columnName, options);\n\n    if (d) {\n      const { addCategoryColumn } = d;\n      runInAction(() => {\n        if (this.data) {\n          if (!this.dataset_id) return;\n          this._data[this.dataset_id] = { ...this.data, ...addCategoryColumn };\n\n          this.root.exploreStore.selectedCategoryColumn = columnName;\n        }\n      });\n    }\n  };\n\n  getData = async (project: Project) => {\n    const { datasets } = project;\n\n    const dataset_requests: Promise<Data>[] = [];\n\n    datasets.forEach((dataset) => {\n      const data = this.query.fetchQuery(['dataset', dataset.id], () => queryData(dataset.id));\n      dataset_requests.push(data);\n    });\n\n    const promise = Promise.all(dataset_requests);\n\n    promise\n      .then((datasets) => {\n        const datas: { [r: string]: Data } = {};\n        datasets.forEach((data) => {\n          datas[data.id] = data;\n        });\n        runInAction(() => {\n          this._data = datas;\n        });\n      })\n      .catch((err) => {\n        throw new Error(err);\n      });\n\n    return promise;\n  };\n}\n","import { makeAutoObservable, when } from 'mobx';\nimport { createContext, useContext } from 'react';\nimport { QueryClient } from 'react-query';\n\nimport ExploreStore from './ExploreStore';\nimport ProjectStore from './ProjectStore';\n\ntype DebugOpts = {\n  debug: 'on' | 'off';\n  showCategories: boolean;\n  goToExplore: boolean;\n};\n\nexport default class RootStore {\n  projectStore: ProjectStore;\n  exploreStore: ExploreStore;\n  opts: DebugOpts;\n  query: QueryClient;\n\n  constructor() {\n    this.query = new QueryClient({\n      defaultOptions: {\n        queries: {\n          staleTime: Infinity,\n          cacheTime: Infinity,\n        },\n      },\n    });\n\n    this.opts = {\n      debug: 'off',\n      goToExplore: false,\n      showCategories: false,\n    };\n\n    const opts = localStorage.getItem('debug-opts');\n\n    if (opts !== null) {\n      this.opts = JSON.parse(opts);\n      localStorage.setItem('debug-opts', JSON.stringify(this.opts));\n    }\n\n    this.projectStore = new ProjectStore(this);\n    this.exploreStore = new ExploreStore(this);\n\n    makeAutoObservable(this);\n\n    when(\n      () => this.opts.showCategories,\n      () => {\n        this.exploreStore.toggleShowCategories(this.opts.showCategories);\n      },\n    );\n  }\n\n  setDebugOpts = (opts: Partial<DebugOpts>) => {\n    this.opts = { ...this.opts, ...opts };\n    localStorage.setItem('debug-opts', JSON.stringify(this.opts));\n  };\n}\n\nexport const StoreContext = createContext<RootStore | undefined>(undefined);\n\nexport function useStore() {\n  const store = useContext(StoreContext);\n\n  if (store === undefined) throw new Error('Store is undefined');\n\n  return store;\n}\n\nexport const store = new RootStore();\n","import { FormControlLabel, FormGroup, Switch } from '@material-ui/core';\nimport { observer } from 'mobx-react';\n\nimport { useStore } from '../stores/RootStore';\n\nconst DebugDialog = () => {\n  const { opts, setDebugOpts } = useStore();\n\n  return (\n    <>\n      <FormGroup>\n        <FormControlLabel\n          control={\n            <Switch\n              checked={opts.debug === 'on'}\n              onChange={() => setDebugOpts({ debug: opts.debug === 'on' ? 'off' : 'on' })}\n            />\n          }\n          label=\"Debug Mode\"\n        />\n        <FormControlLabel\n          control={\n            <Switch\n              checked={opts.goToExplore}\n              onChange={() => setDebugOpts({ goToExplore: !opts.goToExplore })}\n            />\n          }\n          label=\"Redirect To Explore\"\n        />\n        <FormControlLabel\n          control={\n            <Switch\n              checked={opts.showCategories}\n              onChange={() => setDebugOpts({ showCategories: !opts.showCategories })}\n            />\n          }\n          label=\"Show Categories\"\n        />\n      </FormGroup>\n      <pre>{JSON.stringify(opts, null, 4)}</pre>\n    </>\n  );\n};\n\nexport default observer(DebugDialog);\n","import { Dialog, DialogContent, DialogTitle, Fab, makeStyles, Theme } from '@material-ui/core';\nimport CodeIcon from '@material-ui/icons/Code';\nimport { observer } from 'mobx-react';\nimport { FC, useState } from 'react';\n\nimport DebugDialog from '../components/DebugDialog';\n\nconst useStyles = makeStyles((theme: Theme) => {\n  return {\n    fab: {\n      position: 'absolute',\n      right: theme.spacing(2),\n      bottom: theme.spacing(2),\n      'z-index': 100000,\n    },\n  };\n});\n\nconst BaseLayout: FC = ({ children }) => {\n  const styles = useStyles();\n  const [debugMenuOpen, setDebugMenuOpen] = useState<'open' | 'close'>('close');\n\n  const handleClose = () => {\n    setDebugMenuOpen('close');\n  };\n\n  return (\n    <>\n      {children}\n      <Fab className={styles.fab} color=\"primary\" onClick={() => setDebugMenuOpen('open')}>\n        <CodeIcon />\n      </Fab>\n      <Dialog open={debugMenuOpen === 'open'} onClose={handleClose}>\n        <DialogTitle>Debug Menu</DialogTitle>\n        <DialogContent>\n          <DebugDialog />\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n};\n\nexport default observer(BaseLayout);\n","export const MATCHES = 'rgb(254, 95, 85)';\nexport const IPNS = 'rgb(89, 205, 144)';\nexport const ISNP = 'rgb(250, 192, 94)';\nexport const UNION = 'rgb(244,106,15)';\nexport const NON_UNION = 'rgb(44, 127, 184)';\n\nexport const RANK_BAR_FOREGROUND = 'rgb(168,211,238)';\n","import { makeStyles } from '@material-ui/core';\n\nimport { IPNS, ISNP, MATCHES, NON_UNION, UNION } from '../../utils/ColorSpec';\n\nconst useScatterplotStyle = makeStyles({\n  newColor: {\n    stroke: 'blue !important',\n    fill: 'blue !important',\n  },\n  removedColor: {\n    stroke: 'red !important',\n  },\n  newMark: {\n    strokeWidth: '1',\n    fill: 'black',\n    opacity: 0.5,\n  },\n  removedMark: {\n    stroke: 'none',\n    strokeWidth: '0.5',\n    strokeLinecap: 'round',\n    opacity: 0.5,\n    fill: 'black',\n  },\n  movedLine: {\n    opacity: '0.2 !important',\n    stroke: 'black',\n    fill: 'black',\n    strokeWidth: '1',\n    strokeLinecap: 'round',\n  },\n  movedPoint: {\n    fill: 'black',\n    opacity: 0.5,\n  },\n  regularMark: {\n    fill: 'black',\n  },\n  regularLine: {\n    stroke: 'black',\n    strokeOpacity: 0.2,\n  },\n  nonUnionMark: {\n    fill: NON_UNION,\n  },\n  unionMark: {\n    fill: UNION,\n    stroke: UNION,\n  },\n  unionLine: {\n    stroke: UNION,\n    strokeOpacity: 0.8,\n  },\n  regularForceMark: {\n    fill: 'black !important',\n    opacity: 0.2,\n  },\n  intermittentHighlight: {\n    fill: 'red',\n  },\n  matches: {\n    fill: `${MATCHES} !important`,\n    opacity: 1,\n  },\n  isnp: {\n    fill: `${ISNP} !important`,\n    opacity: 1,\n  },\n  ipns: {\n    fill: `${IPNS} !important`,\n    opacity: 1,\n  },\n  dullMark: {\n    opacity: 0.2,\n  },\n  forceDullMark: {\n    opacity: '0.1 !important',\n  },\n});\n\nexport default useScatterplotStyle;\n","export default function translate(x: number, y: number = x): string {\n  return `translate(${x}, ${y})`;\n}\n","import { createStyles, makeStyles, Typography } from '@material-ui/core';\nimport clsx from 'clsx';\nimport { scaleLinear } from 'd3';\nimport { observer } from 'mobx-react';\nimport React, { FC, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { RANK_BAR_FOREGROUND } from '../../utils/ColorSpec';\nimport translate from '../../utils/transform';\n\ntype Props = {\n  height?: number;\n  rank: number;\n  label?: string;\n};\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    common: {\n      fill: RANK_BAR_FOREGROUND,\n    },\n    foreground: {\n      opacity: 0.9,\n    },\n    background: {\n      opacity: 0.3,\n    },\n    label: {\n      fill: 'black',\n    },\n  }),\n);\n\nconst Bar: FC<Props> = ({ rank, height = 45, label = rank.toFixed(2) }: Props) => {\n  const classes = useStyles();\n  const ref = useRef<SVGSVGElement>(null);\n\n  const [width, setWidth] = useState(0);\n\n  useEffect(() => {\n    if (ref.current) {\n      const bounds = ref.current.getBoundingClientRect();\n\n      if (width !== bounds.width) setWidth(bounds.width);\n    }\n  }, [width]);\n\n  const scale = useMemo(() => {\n    return scaleLinear().domain([0, 1]).range([0, width]);\n  }, [width]);\n\n  return (\n    <svg ref={ref} height={height} width=\"100%\">\n      <rect className={clsx(classes.common, classes.background)} height={height} width={width} />\n      <rect\n        className={clsx(classes.common, classes.foreground)}\n        height={height}\n        width={scale(rank)}\n      />\n      <Typography\n        className={classes.label}\n        component=\"text\"\n        dominantBaseline=\"middle\"\n        textAnchor=\"start\"\n        transform={translate(width * 0.05, height / 2)}\n        variant=\"button\"\n      >\n        {label}\n      </Typography>\n    </svg>\n  );\n};\n\nexport default observer(Bar);\n","import {\n  CircularProgress,\n  createStyles,\n  IconButton,\n  List,\n  ListItem,\n  ListItemIcon,\n  makeStyles,\n  Tooltip,\n  Typography,\n} from '@material-ui/core';\nimport InfoIcon from '@material-ui/icons/Info';\nimport TouchAppIcon from '@material-ui/icons/TouchApp';\nimport { observer } from 'mobx-react';\n\nimport { useStore } from '../../stores/RootStore';\nimport { predictionToIntent } from '../../types/Prediction';\nimport useScatterplotStyle from '../Scatterplot/styles';\n\nimport Bar from './Bar';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    centerContainer: {\n      height: '100%',\n      width: '100%',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      flexDirection: 'column',\n    },\n    listContainer: {\n      overflow: 'scroll',\n      padding: '1em',\n    },\n  }),\n);\n\nconst PredictionsTable = () => {\n  const classes = useStyles();\n  const spStyles = useScatterplotStyle();\n  const {\n    exploreStore: {\n      predictions: { isLoading, values },\n      setHighlightMode,\n      setHoveredPrediction,\n      setHighlightPredicate,\n      setColorPredicate,\n      handleIntentSelection,\n      setShowMatchesLegend,\n    },\n  } = useStore();\n\n  if (isLoading)\n    return (\n      <div className={classes.centerContainer}>\n        <CircularProgress />\n        <Typography variant=\"button\">Computing Predictions</Typography>\n      </div>\n    );\n\n  if (values.length === 0)\n    return (\n      <div className={classes.centerContainer}>\n        <Typography variant=\"button\">No valid selections</Typography>\n      </div>\n    );\n\n  return (\n    <div className={classes.listContainer}>\n      <List>\n        {values.map((pred) => (\n          <ListItem\n            key={pred.hash}\n            onMouseEnter={() => {\n              setHoveredPrediction(pred);\n              setHighlightMode(true);\n              setHighlightPredicate((point) => {\n                const {\n                  membership_stats: { ipns, isnp, matches },\n                } = pred;\n\n                return (\n                  ipns.includes(point.id) || isnp.includes(point.id) || matches.includes(point.id)\n                );\n              });\n              setColorPredicate(({ id }) => {\n                const {\n                  membership_stats: { ipns, isnp, matches },\n                } = pred;\n\n                if (ipns.includes(id)) return spStyles.ipns;\n\n                if (isnp.includes(id)) return spStyles.isnp;\n\n                if (matches.includes(id)) return spStyles.matches;\n\n                return 'inherit';\n              });\n              setShowMatchesLegend(true);\n            }}\n            onMouseLeave={() => {\n              setHoveredPrediction(null);\n              setHighlightMode(false);\n              setHighlightPredicate(null);\n              setColorPredicate(null);\n              setShowMatchesLegend(false);\n            }}\n          >\n            <Bar\n              label={`${pred.intent} ( ${pred.rank_jaccard.toFixed(3)} )`}\n              rank={pred.rank_jaccard}\n            />\n            <ListItemIcon>\n              <IconButton\n                onClick={() => {\n                  handleIntentSelection(pred);\n                  setHighlightMode(false);\n                  setHighlightPredicate(null);\n                  setColorPredicate(null);\n                  setShowMatchesLegend(false);\n                }}\n              >\n                <TouchAppIcon />\n              </IconButton>\n            </ListItemIcon>\n            <Tooltip title={<pre>{JSON.stringify(predictionToIntent(pred), null, 2)}</pre>}>\n              <ListItemIcon>\n                <InfoIcon />\n              </ListItemIcon>\n            </Tooltip>\n          </ListItem>\n        ))}\n      </List>\n    </div>\n  );\n};\n\nexport default observer(PredictionsTable);\n","import { BundleMap } from './BundleMap';\n\nexport default function findBundleParent(nodeId: string, bundleMap?: BundleMap): string[] {\n  const parentList = [];\n\n  // eslint-disable-next-line no-restricted-syntax\n  for (const bundle in bundleMap) {\n    if (bundleMap[bundle].bunchedNodes.includes(nodeId)) {\n      parentList.push(bundle);\n    }\n  }\n\n  return parentList;\n}\n","export default function translate(x: number, y: number) {\n  return `translate(${x}, ${y})`;\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { ProvenanceNode } from '@visdesignlab/trrack';\nimport { HierarchyNode } from 'd3';\n\nimport { StratifiedMap } from '../components/ProvVis';\n\nexport type TreeNode = HierarchyNode<unknown>;\n\nexport type ExtendedHierarchyNode<T, S> = {\n  column: number;\n} & HierarchyNode<ProvenanceNode<T, S>>;\n\nexport type ExtendedStratifiedMap<T, S> = {\n  [key: string]: ExtendedHierarchyNode<T, S>;\n};\n\nexport function treeLayout<T, S>(nodes: StratifiedMap<T, S>, current: string, root: string) {\n  const depthMap: { [key: string]: any } = {};\n\n  const currentPath = getPathTo(nodes, root, current);\n\n  DFS(nodes, root, depthMap, currentPath);\n\n  return currentPath;\n}\n\nfunction DFS<T, S>(nodes: StratifiedMap<T, S>, node: string, depthMap: any, currentPath: string[]) {\n  const explored = new Set();\n\n  const toExplore = [];\n\n  let currDepth = 0;\n\n  toExplore.push(nodes[node]);\n\n  while (toExplore.length > 0) {\n    const temp: any = toExplore.pop();\n\n    if (!explored.has(temp.id)) {\n      temp.width = currDepth;\n      depthMap[temp.id] = temp.width;\n      explored.add(temp.id);\n    } else {\n      temp.width = depthMap[temp.id];\n    }\n\n    if (temp.children) {\n      toExplore.push(\n        ...temp.children.sort((a: any, b: any) => {\n          const aIncludes = currentPath.includes(a.id) ? 1 : 0;\n          const bIncludes = currentPath.includes(b.id) ? 1 : 0;\n\n          return aIncludes - bIncludes;\n        }),\n      );\n    } else {\n      currDepth += 1;\n    }\n  }\n}\n\nexport function getPathTo<T, S>(nodes: StratifiedMap<T, S>, from: string, to: string): string[] {\n  const path: string[] = [];\n\n  search(nodes, from, to, path);\n\n  return [from, ...path.reverse()];\n}\n\nfunction search<T, S>(nodes: StratifiedMap<T, S>, node: string, final: string, path: string[]) {\n  if (!nodes[node]) return false;\n\n  if (node === final) {\n    path.push(node);\n\n    return true;\n  }\n\n  const children = nodes[node].children || [];\n\n  // eslint-disable-next-line no-restricted-syntax\n  for (const child of children) {\n    if (search(nodes, child.id!, final, path)) {\n      path.push(child.id!);\n\n      return true;\n    }\n  }\n\n  return false;\n}\n","import { style } from 'typestyle';\n\n// eslint-disable-next-line import/prefer-default-export\nexport const treeColor = (current?: boolean) =>\n  style({\n    fill: current ? 'rgb(33, 133, 208)' : 'white',\n    stroke: current ? 'rgb(33, 133, 208)' : '#Ccc',\n  });\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/no-non-null-asserted-optional-chain */\n/* eslint-disable no-unused-vars */\nimport { NodeID, Provenance, ProvenanceNode, StateNode } from '@visdesignlab/trrack';\nimport { observer } from 'mobx-react';\nimport React, { ReactChild, useState } from 'react';\nimport { Animate } from 'react-move';\nimport { Button, Icon, Popup } from 'semantic-ui-react';\n\nimport { BundleMap, OriginMap } from '../Utils/BundleMap';\nimport { EventConfig } from '../Utils/EventConfig';\nimport translate from '../Utils/translate';\n\nimport { treeColor } from './Styles';\n\ntype BackboneNodeProps<T, S extends string> = {\n  prov: Provenance<T, S>;\n  first: boolean;\n  iconOnly: boolean;\n  current: boolean;\n  duration: number;\n  node: StateNode<T, S>;\n  radius: number;\n  strokeWidth: number;\n  textSize: number;\n  setBookmark: any;\n  bookmark: any;\n  nodeMap: any;\n  currentDataset: string;\n  annotationOpen: number;\n  setAnnotationOpen: any;\n  exemptList: string[];\n  setExemptList: any;\n  bundleMap?: BundleMap;\n  clusterLabels: boolean;\n  editAnnotations: boolean;\n  eventConfig?: EventConfig<S>;\n  popupContent?: (nodeId: StateNode<T, S>) => ReactChild;\n  annotationContent?: (nodeId: StateNode<T, S>) => ReactChild;\n  approvedFunction: (id: NodeID) => void;\n  nodeCreationMap: OriginMap;\n  addToWorkflow: (id: string) => void;\n  rejectedFunction: (id: NodeID) => void;\n  expandedClusterList?: string[];\n};\n\nfunction BackboneNode<T, S extends string>({\n  prov,\n  first,\n  iconOnly,\n  current,\n  node,\n  duration,\n  radius,\n  strokeWidth,\n  addToWorkflow,\n  textSize,\n  nodeMap,\n  annotationOpen,\n  bookmark,\n  setAnnotationOpen,\n  exemptList,\n  setExemptList,\n  bundleMap,\n  eventConfig,\n  popupContent,\n  editAnnotations,\n  annotationContent,\n  approvedFunction,\n  rejectedFunction,\n  currentDataset,\n  nodeCreationMap,\n  expandedClusterList,\n}: BackboneNodeProps<T, S>) {\n  const padding = 25;\n\n  const cursorStyle = {\n    cursor: 'pointer',\n  } as React.CSSProperties;\n\n  const [annotateText, setAnnotateText] = useState(\n    node.artifacts && node.artifacts.annotations && prov.getLatestAnnotation(node.id)?.annotation\n      ? prov.getLatestAnnotation(node.id)?.annotation!\n      : '',\n  );\n\n  const handleCheck = () => {\n    const lastAnnotation = prov.getLatestAnnotation(node.id);\n\n    if (lastAnnotation?.annotation !== annotateText.trim()) {\n      prov.addAnnotation(annotateText, node.id);\n      setAnnotationOpen(-1);\n    }\n  };\n\n  const handleClose = () => {\n    setAnnotateText(prov.getLatestAnnotation(node.id)?.annotation!);\n    setAnnotationOpen(-1);\n  };\n\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  const handleInputChange = () => {};\n\n  // console.log(JSON.parse(JSON.stringify(node)));\n  let glyph = (\n    <circle\n      className={treeColor(current)}\n      r={radius}\n      strokeWidth={strokeWidth}\n      style={cursorStyle}\n    />\n  );\n\n  // let backboneBundleNodes = findBackboneBundleNodes(nodeMap, bundleMap)\n\n  let dropDownAdded = false;\n\n  if (eventConfig) {\n    const { eventType }: { eventType: any } = node.metadata;\n\n    if (eventType && eventType in eventConfig && eventType !== 'Root') {\n      const { bundleGlyph, currentGlyph, backboneGlyph } = eventConfig[eventType];\n\n      if (bundleMap && Object.keys(bundleMap).includes(node.id)) {\n        dropDownAdded = true;\n        glyph = (\n          <g fontWeight=\"none\" style={cursorStyle}>\n            {bundleGlyph}\n          </g>\n        );\n      }\n\n      if (current) {\n        glyph = (\n          <g fontWeight=\"none\" style={cursorStyle}>\n            {currentGlyph}\n          </g>\n        );\n      } else if (!dropDownAdded) {\n        glyph = (\n          <g fontWeight=\"none\" style={cursorStyle}>\n            {backboneGlyph}\n          </g>\n        );\n      }\n    }\n  }\n\n  let label = '';\n  let annotate = '';\n\n  // console.log(bundleMap)\n  // console.log(nodeMap[node.id]);\n\n  if (\n    bundleMap &&\n    Object.keys(bundleMap).includes(node.id) &&\n    node.actionType === 'Ephemeral' &&\n    expandedClusterList &&\n    !expandedClusterList.includes(node.id)\n  ) {\n    if (node.metadata && node.metadata.eventType) {\n      label = `[${bundleMap[node.id].bunchedNodes.length}] ${node.metadata.eventType}`;\n    } else {\n      label = `[${bundleMap[node.id].bunchedNodes.length}]`;\n    }\n  } else {\n    label = node.label;\n  }\n\n  if (\n    node.artifacts &&\n    node.artifacts.annotations &&\n    node.artifacts.annotations.length > 0 &&\n    annotationOpen !== nodeMap[node.id].depth\n  ) {\n    annotate = node.artifacts.annotations[0].annotation;\n  }\n\n  if (!nodeMap[node.id]) {\n    return null;\n  }\n\n  if (annotate.length > 20) annotate = `${annotate.substr(0, 20)}..`;\n\n  if (label.length > 20) label = `${label.substr(0, 20)}..`;\n\n  const labelG = (\n    <g style={{ opacity: 1 }} transform={translate(padding, 0)}>\n      {nodeCreationMap[node.id] ? (\n        <g>\n          <g transform={translate(-10, -10)}>\n            <circle fill=\"white\" opacity=\"1\" r=\"7\" />\n\n            <text\n              alignmentBaseline=\"middle\"\n              fill={\n                nodeCreationMap[node.id] && nodeCreationMap[node.id].createdIn === currentDataset\n                  ? 'green'\n                  : 'grey'\n              }\n              fontSize={10}\n              fontWeight=\"bold\"\n              style={cursorStyle}\n              textAnchor=\"middle\"\n              x={0}\n              y={0}\n            >\n              {nodeCreationMap[node.id] ? nodeCreationMap[node.id].createdIn : ''}\n            </text>\n          </g>\n\n          <g transform={translate(-10, 10)}>\n            <circle fill=\"white\" opacity=\"1\" r=\"7\" />\n\n            <text\n              alignmentBaseline=\"middle\"\n              fill={\n                nodeCreationMap[node.id] &&\n                nodeCreationMap[node.id].approvedIn.includes(currentDataset)\n                  ? 'green'\n                  : nodeCreationMap[node.id].rejectedIn.includes(currentDataset)\n                  ? 'red'\n                  : 'black'\n              }\n              fontFamily=\"Icons\"\n              fontSize={10}\n              style={cursorStyle}\n              textAnchor=\"middle\"\n              x={0}\n              y={0}\n            >\n              {nodeCreationMap[node.id] &&\n              nodeCreationMap[node.id].approvedIn.includes(currentDataset)\n                ? '\\uf00c'\n                : nodeCreationMap[node.id].rejectedIn.includes(currentDataset)\n                ? '\\uf00d'\n                : '\\uf128'}\n            </text>\n          </g>\n        </g>\n      ) : null}\n      {nodeCreationMap[node.id] &&\n      !nodeCreationMap[node.id].rejectedIn.includes(currentDataset) &&\n      !nodeCreationMap[node.id].approvedIn.includes(currentDataset) ? (\n        <g transform={translate(-10, 10)}>\n          <foreignObject height=\"100\" width=\"50\" x=\"-45\" y=\"-30\">\n            <div style={{ maxWidth: '20' }}>\n              <Button\n                style={{\n                  margin: '1px',\n                  padding: '1px',\n                  maxHeight: '15px',\n                  maxWidth: '15px',\n                }}\n                onClick={(event) => {\n                  event.stopPropagation();\n                  approvedFunction(node.id);\n                }}\n              >\n                <Icon color=\"green\" name=\"check\" size=\"small\" style={{ margin: '0px' }} />\n              </Button>\n            </div>\n            <div style={{ maxWidth: '20' }}>\n              <Button\n                style={{\n                  margin: '1px',\n                  padding: '1px',\n                  maxHeight: '15px',\n                  maxWidth: '15px',\n                }}\n                onClick={(event) => {\n                  event.stopPropagation();\n                  rejectedFunction(node.id);\n                }}\n              >\n                <Icon color=\"red\" name=\"close\" size=\"small\" style={{ margin: '0px' }} />\n              </Button>\n            </div>\n          </foreignObject>\n        </g>\n      ) : (\n        node.label !== 'Root' &&\n        !nodeCreationMap[node.id].rejectedIn.includes(currentDataset) && (\n          <g transform={translate(-10, 10)}>\n            <foreignObject height=\"100\" width=\"50\" x=\"-45\" y=\"-20\">\n              <div style={{ maxWidth: '20' }}>\n                <Button\n                  style={{\n                    margin: '1px',\n                    padding: '1px',\n                    maxHeight: '20px',\n                    maxWidth: '20px',\n                  }}\n                  onClick={(event) => {\n                    event.stopPropagation();\n                    addToWorkflow(node.id);\n                  }}\n                >\n                  <Icon color=\"green\" name=\"add\" size=\"small\" style={{ margin: '0px' }} />\n                </Button>\n              </div>\n            </foreignObject>\n          </g>\n        )\n      )}\n\n      {!iconOnly ? (\n        <g>\n          {dropDownAdded ? (\n            <text\n              alignmentBaseline=\"middle\"\n              fill=\"rgb(248, 191, 132)\"\n              fontFamily=\"Icons\"\n              fontSize={17}\n              style={cursorStyle}\n              textAnchor=\"middle\"\n              x={1}\n              y={0}\n              onClick={(e) => nodeClicked(node, e)}\n            >\n              {expandedClusterList && expandedClusterList.includes(node.id) ? '\\uf0d8' : '\\uf0d7'}\n            </text>\n          ) : (\n            <g />\n          )}\n          {editAnnotations ? (\n            <button>\n              <i className=\"fas fa-undo marginRight\" />\n              Undo\n            </button>\n          ) : (\n            <g />\n          )}\n          <text\n            dominantBaseline=\"middle\"\n            fill=\"black\"\n            fontSize={textSize}\n            fontWeight=\"bold\"\n            textAnchor=\"start\"\n            x={dropDownAdded ? 10 : 0}\n            y={annotate.length === 0 ? 0 : -7}\n            onClick={() => labelClicked(node)}\n          >\n            {label}\n          </text>\n          ,\n          <text\n            dominantBaseline=\"middle\"\n            fill=\"black\"\n            fontSize={textSize}\n            fontWeight=\"regular\"\n            textAnchor=\"start\"\n            x={dropDownAdded ? 10 : 0}\n            y={7}\n            onClick={() => labelClicked(node)}\n          >\n            {annotate}\n          </text>\n          ,\n          <text\n            alignmentBaseline=\"middle\"\n            className=\"fas fa\"\n            fill={prov.getBookmark(node.id) ? '#2185d0' : '#cccccc'}\n            fontFamily=\"Icons\"\n            fontSize={17}\n            opacity={bookmark === node.id || prov.getBookmark(node.id) ? 1 : 0}\n            style={cursorStyle}\n            textAnchor=\"middle\"\n            x={175}\n            y={0}\n            onClick={(e) => {\n              prov.setBookmark(node.id, !prov.getBookmark(node.id));\n\n              e.stopPropagation();\n            }}\n          >\n            {'\\uf02e'}\n          </text>\n          ,\n          <text\n            alignmentBaseline=\"middle\"\n            fill={annotationOpen === nodeMap[node.id].depth ? '#2185d0' : '#cccccc'}\n            fontFamily=\"Icons\"\n            fontSize={17}\n            opacity={bookmark === node.id || annotationOpen === nodeMap[node.id].depth ? 1 : 0}\n            style={cursorStyle}\n            textAnchor=\"middle\"\n            x={210}\n            y={0}\n            onClick={() => {\n              if (annotationOpen === -1 || nodeMap[node.id].depth !== annotationOpen) {\n                setAnnotationOpen(nodeMap[node.id].depth);\n              } else {\n                setAnnotationOpen(-1);\n              }\n            }}\n          >\n            {'\\uf044'}\n          </text>\n        </g>\n      ) : (\n        <g>\n          {dropDownAdded ? (\n            <text\n              alignmentBaseline=\"middle\"\n              fill=\"rgb(248, 191, 132)\"\n              fontFamily=\"Icons\"\n              fontSize={17}\n              style={cursorStyle}\n              textAnchor=\"middle\"\n              x={1}\n              y={0}\n              onClick={(e) => nodeClicked(node, e)}\n            >\n              {expandedClusterList && expandedClusterList.includes(node.id) ? '\\uf0d8' : '\\uf0d7'}\n            </text>\n          ) : (\n            <g />\n          )}\n        </g>\n      )}\n    </g>\n  );\n\n  return (\n    <Animate\n      enter={{\n        opacity: [1],\n        timing: { duration: 100, delay: first ? 0 : duration },\n      }}\n      start={{ opacity: 0 }}\n    >\n      {() => (\n        <>\n          {popupContent !== undefined && nodeMap[node.id].depth > 0 ? (\n            <Popup content={popupContent(node)} trigger={glyph} />\n          ) : (\n            glyph\n          )}\n          {/* {glyph} */}\n\n          {popupContent !== undefined && nodeMap[node.id].depth > 0 ? (\n            <Popup content={popupContent(node)} trigger={labelG} />\n          ) : (\n            labelG\n          )}\n\n          {annotationOpen !== -1 && nodeMap[node.id].depth === annotationOpen ? (\n            <g transform=\"translate(15, 25)\">\n              <foreignObject height=\"80\" width=\"175\" x=\"0\" y=\"0\">\n                <div>\n                  <textarea\n                    style={{ maxWidth: 130, resize: 'none' }}\n                    value={annotateText}\n                    onChange={handleInputChange}\n                  />\n                  <button onClick={handleCheck}>Annotate</button>\n\n                  <button onClick={handleClose}>Close</button>\n                </div>\n\n                {/* <Input size='massive' icon='close' onChange={handleInputChange}\n                  defaultValue={annotateText.current} placeholder=\"Edit Annotation\" action>\n                    <input />\n                    <Button color=\"green\" type=\"submit\" onClick={handleCheck}>\n                      <Icon name=\"world\"/>\n                    </Button>\n                    <Button color=\"red\" type=\"submit\" onClick={handleClose}>\n                      <Icon name=\"close\"/>\n                    </Button>\n                  </Input> */}\n              </foreignObject>\n            </g>\n          ) : (\n            <g />\n          )}\n        </>\n      )}\n    </Animate>\n  );\n\n  function labelClicked(innerNode: ProvenanceNode<T, S>) {\n    if (annotationOpen === nodeMap[innerNode.id].depth && annotationContent) {\n      setAnnotationOpen(-1);\n    } else if (annotationContent) {\n      setAnnotationOpen(nodeMap[innerNode.id].depth);\n    }\n  }\n\n  function nodeClicked(innerNode: ProvenanceNode<T, S>, event: any) {\n    if (bundleMap && Object.keys(bundleMap).includes(innerNode.id)) {\n      const exemptCopy: string[] = Array.from(exemptList);\n\n      if (exemptCopy.includes(innerNode.id)) {\n        exemptCopy.splice(\n          exemptCopy.findIndex((d) => d === innerNode.id),\n          1,\n        );\n      } else {\n        exemptCopy.push(innerNode.id);\n      }\n\n      setExemptList(exemptCopy);\n    }\n\n    event.stopPropagation();\n  }\n}\n\nexport default observer(BackboneNode);\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/no-inferrable-types */\nimport { StateNode } from '@visdesignlab/trrack';\nimport { observer } from 'mobx-react';\nimport React from 'react';\nimport { Animate } from 'react-move';\n\nimport { EventConfig } from '../Utils/EventConfig';\n\nimport { treeColor } from './Styles';\n\ntype BookmarkNodeProps<T, S extends string> = {\n  current: boolean;\n  node: StateNode<T, S>;\n  nodeMap: any;\n  editAnnotations: boolean;\n  eventConfig?: EventConfig<S>;\n};\n\nfunction BookmarkNode<T, S extends string>({\n  current,\n  node,\n  eventConfig,\n}: BookmarkNodeProps<T, S>) {\n  const radius = 5;\n  const strokeWidth = 2;\n  const textSize = 15;\n\n  const cursorStyle = {\n    cursor: 'pointer',\n  } as React.CSSProperties;\n\n  let glyph = (\n    <circle\n      className={treeColor(current)}\n      r={radius}\n      strokeWidth={strokeWidth}\n      style={cursorStyle}\n    />\n  );\n\n  const dropDownAdded = false;\n  const { eventType }: { eventType: any } = node.metadata;\n\n  if (eventConfig) {\n    const { currentGlyph, backboneGlyph } = eventConfig[eventType];\n\n    if (current) {\n      glyph = (\n        <g fontWeight=\"none\" style={cursorStyle}>\n          {currentGlyph}\n        </g>\n      );\n    } else {\n      glyph = (\n        <g fontWeight=\"none\" style={cursorStyle}>\n          {backboneGlyph}\n        </g>\n      );\n    }\n  }\n\n  let label: string = '';\n  let annotate: string = '';\n\n  if (\n    node.artifacts &&\n    node.artifacts.annotations.length > 0 &&\n    node.artifacts.annotations[0].annotation.length > 0\n  ) {\n    annotate = node.artifacts.annotations[0].annotation;\n  }\n\n  label = node.label;\n\n  if (annotate.length > 20) annotate = `${annotate.substr(0, 20)}..`;\n\n  if (label.length > 20) label = `${label.substr(0, 20)}..`;\n\n  return (\n    <Animate\n      enter={{\n        opacity: [1],\n      }}\n      start={{ opacity: 0 }}\n    >\n      {() => (\n        <>\n          <g style={{ opacity: 1 }}>\n            {glyph}\n\n            <text\n              dominantBaseline=\"middle\"\n              fontSize={textSize}\n              fontWeight=\"bold\"\n              textAnchor=\"start\"\n              x={20}\n              y={0}\n            >\n              {label}\n            </text>\n\n            <text\n              dominantBaseline=\"middle\"\n              fontSize={textSize}\n              fontWeight=\"regular\"\n              textAnchor=\"start\"\n              x={dropDownAdded ? 10 : 0}\n              y={20}\n            >\n              {annotate}\n            </text>\n          </g>\n        </>\n      )}\n    </Animate>\n  );\n}\n\nexport default observer(BookmarkNode);\n","import { NodeID, ProvenanceGraph } from '@visdesignlab/trrack';\nimport { observer } from 'mobx-react';\nimport React from 'react';\nimport { NodeGroup } from 'react-move';\n\nimport { EventConfig } from '../Utils/EventConfig';\nimport translate from '../Utils/translate';\n\nimport BookmarkNode from './BookmarkNode';\nimport BookmarkTransitions from './BookmarkTransitions';\n\nexport type BookmarkListViewConfig<T, S extends string> = {\n  graph?: ProvenanceGraph<T, S>;\n  eventConfig?: EventConfig<S>;\n  currentNode: NodeID;\n};\n\nfunction BookmarkListView<T, S extends string>({\n  graph,\n  eventConfig,\n  currentNode,\n}: BookmarkListViewConfig<T, S>) {\n  if (graph === undefined) {\n    return null;\n  }\n\n  const gutter = 15;\n  const verticalSpace = 50;\n\n  const bookmarks = [];\n\n  const xOffset = gutter;\n  const yOffset = verticalSpace;\n\n  // eslint-disable-next-line no-restricted-syntax\n  for (const j in graph.nodes) {\n    if (graph.nodes[j].bookmarked) {\n      bookmarks.push(graph.nodes[j]);\n    }\n  }\n\n  return (\n    <NodeGroup\n      data={bookmarks}\n      keyAccessor={(d) => d.label}\n      {...BookmarkTransitions(xOffset, yOffset, bookmarks)}\n    >\n      {(innerBookmarks) => (\n        <>\n          {innerBookmarks.map((bookmark) => {\n            const { data: d, key, state } = bookmark;\n\n            return (\n              <g key={key} transform={translate(state.x, state.y)}>\n                <BookmarkNode\n                  current={currentNode === d.id}\n                  editAnnotations={false}\n                  eventConfig={eventConfig}\n                  node={d}\n                  nodeMap={innerBookmarks}\n                />\n              </g>\n            );\n          })}\n        </>\n      )}\n    </NodeGroup>\n  );\n}\n\nexport default observer(BookmarkListView);\n","/* eslint-disable no-param-reassign */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable no-plusplus */\nexport default function BookmarkTransitions(xOffset: number, yOffset: number, nodeList: any[]) {\n  xOffset = -xOffset;\n\n  const start = (data: any) => {\n    const index = nodeList.findIndex((d) => d.id === data.id);\n\n    const x = 0;\n    const y = 40 * index;\n\n    return { x, y: y - yOffset, opacity: 0 };\n  };\n\n  const enter = (data: any) => {\n    const index = nodeList.findIndex((d) => d.id === data.id);\n\n    const x = 0;\n    const y = 40 * index;\n\n    return {\n      x: [x],\n      y: [y],\n      opactiy: 1,\n    };\n  };\n\n  const update = (data: any) => {\n    const index = nodeList.findIndex((d) => d.id === data.id);\n\n    const x = 0;\n    const y = 40 * index;\n\n    return {\n      x: [x],\n      y: [y],\n      opactiy: 1,\n    };\n  };\n\n  return {\n    enter,\n    leave: start,\n    update,\n    start,\n  };\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable no-param-reassign */\n/* eslint-disable @typescript-eslint/no-inferrable-types */\nexport default function linkTransitions(\n  xOffset: number,\n  yOffset: number,\n  clusterOffset: number,\n  backboneOffset: number,\n  duration: number = 500,\n  annotationOpen: number,\n  annotationHeight: number,\n) {\n  xOffset = -xOffset;\n  backboneOffset = -backboneOffset;\n  const start = () => ({\n    x1: 0,\n    x2: 0,\n    y1: 0,\n    y2: 0,\n    opacity: 0,\n  });\n\n  const enter = (data: any) => {\n    let clusteredNodesInFront = 0;\n\n    // eslint-disable-next-line max-len\n    clusteredNodesInFront =\n      clusteredNodesInFront === 0 ? clusteredNodesInFront : clusteredNodesInFront - 1;\n\n    const { source, target } = data;\n    const x1 = getX(source.width, xOffset, backboneOffset);\n    const x2 = getX(target.width, xOffset, backboneOffset);\n\n    let y1 = yOffset * source.depth - (yOffset - clusterOffset) * clusteredNodesInFront;\n    let y2 = yOffset * target.depth - (yOffset - clusterOffset) * clusteredNodesInFront;\n\n    if (annotationOpen !== -1 && source.depth > annotationOpen && source.width === 0) {\n      y1 += annotationHeight;\n    }\n\n    if (annotationOpen !== -1 && target.depth > annotationOpen && target.width === 0) {\n      y2 += annotationHeight;\n    }\n\n    return {\n      x1,\n      x2,\n      y1,\n      y2,\n      opacity: 1,\n      timing: { duration },\n    };\n  };\n\n  const update = (data: any) => {\n    let clusteredNodesInFront = 0;\n\n    // eslint-disable-next-line max-len\n    clusteredNodesInFront =\n      clusteredNodesInFront === 0 ? clusteredNodesInFront : clusteredNodesInFront - 1;\n\n    const { source, target } = data;\n    const x1 = getX(source.width, xOffset, backboneOffset);\n    const x2 = getX(target.width, xOffset, backboneOffset);\n\n    let y1 = yOffset * source.depth - (yOffset - clusterOffset) * clusteredNodesInFront;\n    let y2 = yOffset * target.depth - (yOffset - clusterOffset) * clusteredNodesInFront;\n\n    if (annotationOpen !== -1 && source.depth > annotationOpen && source.width === 0) {\n      y1 += annotationHeight;\n    }\n\n    if (annotationOpen !== -1 && target.depth > annotationOpen && target.width === 0) {\n      y2 += annotationHeight;\n    }\n\n    return {\n      x1: [x1],\n      y1: [y1],\n      x2: [x2],\n      y2: [y2],\n      opacity: 1,\n      timing: { duration },\n    };\n  };\n\n  return {\n    enter,\n    leave: start,\n    update,\n    start,\n  };\n}\n\nexport function getX(width: number, xOffset: number, backboneOffset: number) {\n  return width > 1\n    ? (xOffset + backboneOffset) * width - backboneOffset\n    : (xOffset + backboneOffset) * width;\n}\n","/* eslint-disable no-param-reassign */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/no-inferrable-types */\n/* eslint-disable no-plusplus */\nimport { BundleMap } from '../Utils/BundleMap';\n\nimport { getX } from './LinkTransitions';\n\nexport default function bundleTransitions(\n  xOffset: number,\n  yOffset: number,\n  clusterOffset: number,\n  backboneOffset: number,\n  duration: number = 500,\n  expandedClusterList: string[],\n  stratifiedMap: any,\n  nodeList: any[],\n  annotationOpen: number,\n  annotationHeight: number,\n  bundleMap?: BundleMap,\n) {\n  xOffset = -xOffset;\n  backboneOffset = -backboneOffset;\n  const start = () => ({ x: 0, y: 0, opacity: 0 });\n\n  const enter = (data: any) => {\n    const validity = true;\n\n    const x = getX(stratifiedMap[data].width, xOffset, backboneOffset);\n\n    // let backboneBundleNodes = findBackboneBundleNodes(stratifiedMap, bundleMap)\n\n    let highestDepth = stratifiedMap[data].depth;\n    let lowestDepth = stratifiedMap[data].depth;\n\n    if (bundleMap && expandedClusterList.includes(data)) {\n      for (let i = 0; i < bundleMap[data].bunchedNodes.length; i++) {\n        // if(stratifiedMap[bundleMap[data].bunchedNodes[i]].width != 0)\n        // {\n        //   validity = false;\n        // }\n        if (\n          stratifiedMap[bundleMap[data].bunchedNodes[i]] &&\n          stratifiedMap[bundleMap[data].bunchedNodes[i]].depth < highestDepth\n        ) {\n          highestDepth = stratifiedMap[bundleMap[data].bunchedNodes[i]].depth;\n        }\n\n        if (\n          stratifiedMap[bundleMap[data].bunchedNodes[i]] &&\n          stratifiedMap[bundleMap[data].bunchedNodes[i]].depth > lowestDepth\n        ) {\n          lowestDepth = stratifiedMap[bundleMap[data].bunchedNodes[i]].depth;\n        }\n      }\n    }\n\n    let y = yOffset * highestDepth;\n\n    if (annotationOpen !== -1 && highestDepth > annotationOpen) {\n      y += annotationHeight;\n    }\n\n    let height = 0;\n\n    // eslint-disable-next-line no-restricted-syntax\n    for (const j in bundleMap![data].bunchedNodes) {\n      if (stratifiedMap[bundleMap![data].bunchedNodes[j]]) {\n        height++;\n      }\n    }\n\n    height *= clusterOffset;\n\n    if (!expandedClusterList.includes(data)) {\n      height = 10;\n    }\n\n    if (annotationOpen !== -1 && annotationOpen >= highestDepth && annotationOpen <= lowestDepth) {\n      height += annotationHeight;\n    }\n\n    return {\n      x: [x],\n      y: [y],\n      opacity: [!expandedClusterList.includes(data) ? 0 : 1],\n      timing: { duration },\n      validity,\n      height,\n    };\n  };\n\n  const update = (data: any) => {\n    const validity = true;\n\n    const x = getX(stratifiedMap[data].width, xOffset, backboneOffset);\n\n    // let backboneBundleNodes = findBackboneBundleNodes(stratifiedMap, bundleMap)\n\n    let highestDepth = stratifiedMap[data].depth;\n    let lowestDepth = stratifiedMap[data].depth;\n\n    if (bundleMap && expandedClusterList.includes(data)) {\n      for (let i = 0; i < bundleMap[data].bunchedNodes.length; i++) {\n        // if(stratifiedMap[bundleMap[data].bunchedNodes[i]].width != 0)\n        // {\n        //   validity = false;\n        // }\n        if (\n          stratifiedMap[bundleMap[data].bunchedNodes[i]] &&\n          stratifiedMap[bundleMap[data].bunchedNodes[i]].depth < highestDepth\n        ) {\n          highestDepth = stratifiedMap[bundleMap[data].bunchedNodes[i]].depth;\n        }\n\n        if (\n          stratifiedMap[bundleMap[data].bunchedNodes[i]] &&\n          stratifiedMap[bundleMap[data].bunchedNodes[i]].depth > lowestDepth\n        ) {\n          lowestDepth = stratifiedMap[bundleMap[data].bunchedNodes[i]].depth;\n        }\n      }\n    }\n\n    let y = yOffset * highestDepth;\n\n    if (annotationOpen !== -1 && highestDepth > annotationOpen) {\n      y += annotationHeight;\n    }\n\n    let height = 0;\n\n    // eslint-disable-next-line no-restricted-syntax\n    for (const j in bundleMap![data].bunchedNodes) {\n      if (stratifiedMap[bundleMap![data].bunchedNodes[j]]) {\n        height++;\n      }\n    }\n\n    height *= clusterOffset;\n\n    if (!expandedClusterList.includes(data)) {\n      height = 10;\n    }\n\n    if (annotationOpen !== -1 && annotationOpen >= highestDepth && annotationOpen <= lowestDepth) {\n      height += annotationHeight;\n    }\n\n    return {\n      x: [x],\n      y: [y],\n      opacity: [!expandedClusterList.includes(data) ? 0 : 1],\n      timing: { duration },\n      validity,\n      height: [height],\n    };\n  };\n\n  return {\n    enter,\n    leave: start,\n    update,\n    start,\n  };\n}\n","/* eslint-disable @typescript-eslint/ban-types */\nimport React, { FC } from 'react';\n\ntype LinkProps = {} & React.SVGProps<SVGLineElement>;\n\nconst Link: FC<LinkProps> = (props: LinkProps) => <line {...props} />;\n\nexport default Link;\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable no-param-reassign */\nimport { getX } from './LinkTransitions';\n\nexport default function nodeTransitions(\n  xOffset: number,\n  yOffset: number,\n  clusterOffset: number,\n  backboneOffset: number,\n  // eslint-disable-next-line @typescript-eslint/no-inferrable-types\n  duration: number = 500,\n  annotationOpen: number,\n  annotationHeight: number,\n) {\n  xOffset = -xOffset;\n  backboneOffset = -backboneOffset;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const start = (data: any) => {\n    let clusteredNodesInFront = 0;\n\n    const x = getX(data.width, xOffset, backboneOffset);\n    // eslint-disable-next-line max-len\n    clusteredNodesInFront =\n      clusteredNodesInFront === 0 ? clusteredNodesInFront : clusteredNodesInFront - 1;\n\n    let y = yOffset * data.depth - (yOffset - clusterOffset) * clusteredNodesInFront;\n\n    if (annotationOpen !== -1 && data.depth > annotationOpen && data.width === 0) {\n      y += annotationHeight;\n    }\n\n    return { x, y: y - yOffset, opacity: 0 };\n  };\n\n  const enter = (data: any) => {\n    let clusteredNodesInFront = 0;\n\n    const x = getX(data.width, xOffset, backboneOffset);\n\n    // eslint-disable-next-line max-len\n    clusteredNodesInFront =\n      clusteredNodesInFront === 0 ? clusteredNodesInFront : clusteredNodesInFront - 1;\n\n    let y = yOffset * data.depth - (yOffset - clusterOffset) * clusteredNodesInFront;\n\n    if (annotationOpen !== -1 && data.depth > annotationOpen && data.width === 0) {\n      y += annotationHeight;\n    }\n\n    return {\n      x: [x],\n      y: [y],\n      opactiy: 1,\n      timing: { duration },\n    };\n  };\n\n  const update = (data: any) => {\n    let clusteredNodesInFront = 0;\n\n    const x = getX(data.width, xOffset, backboneOffset);\n\n    // eslint-disable-next-line max-len\n    clusteredNodesInFront =\n      clusteredNodesInFront === 0 ? clusteredNodesInFront : clusteredNodesInFront - 1;\n\n    let y = yOffset * data.depth - (yOffset - clusterOffset) * clusteredNodesInFront;\n\n    if (annotationOpen !== -1 && data.depth > annotationOpen && data.width === 0) {\n      y += annotationHeight;\n    }\n\n    return {\n      x: [x],\n      y: [y],\n      opactiy: 1,\n      timing: { duration },\n    };\n  };\n\n  return {\n    enter,\n    leave: start,\n    update,\n    start,\n  };\n}\n","import { ProvenanceGraph } from '@visdesignlab/trrack';\nimport React from 'react';\nimport { Button } from 'semantic-ui-react';\nimport { style } from 'typestyle';\n\nexport type UndoRedoConfig<T, S extends string> = {\n  undoCallback: () => void;\n  redoCallback: () => void;\n  graph?: ProvenanceGraph<T, S>;\n};\n\nconst undoButtonStyle = style({\n  marginTop: '2px',\n  borderRadius: '2px',\n  display: 'inline-block',\n  cursor: 'pointer',\n  fontFamily: 'Lato,Helvetica Neue,Arial,Helvetica,sans-serif',\n  fontSize: '14px',\n  marginRight: '1px',\n  $nest: {\n    '&:hover': {\n      backgroundColor: '#6c7c7c',\n    },\n    '&:active': {\n      backgroundColor: '#6c7c7c',\n    },\n  },\n});\n\nconst redoButtonStyle = style({\n  marginTop: '2px',\n  borderRadius: '2px',\n  display: 'inline-block',\n  cursor: 'pointer',\n  fontFamily: 'Lato,Helvetica Neue,Arial,Helvetica,sans-serif',\n  fontSize: '14px',\n\n  $nest: {\n    '&:hover': {\n      backgroundColor: '#6c7c7c',\n    },\n\n    '&:active': {\n      backgroundColor: '#6c7c7c',\n    },\n  },\n});\n\nfunction UndoRedoButton<T, S extends string>({\n  graph,\n  undoCallback,\n  redoCallback,\n}: UndoRedoConfig<T, S>) {\n  if (graph === undefined) {\n    return null;\n  }\n\n  const isAtRoot = graph.root === graph.current;\n  const isAtLatest = graph.nodes[graph.current].children.length === 0;\n\n  const margin = {\n    marginRight: '3px',\n  } as React.CSSProperties;\n\n  return (\n    <div>\n      <Button\n        className={undoButtonStyle}\n        disabled={isAtRoot}\n        variant=\"outlined\"\n        onClick={undoCallback}\n      >\n        <i className=\"fas fa-undo marginRight\" style={margin} />\n        Undo\n      </Button>\n\n      <Button\n        className={redoButtonStyle}\n        disabled={isAtLatest}\n        variant=\"outlined\"\n        onClick={redoCallback}\n      >\n        <i className=\"fas fa-redo marginRight\" style={margin} />\n        Redo\n      </Button>\n    </div>\n  );\n}\n\nexport default UndoRedoButton;\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable no-param-reassign */\n/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable no-plusplus */\n/* eslint-disable no-nested-ternary */\n/* eslint-disable no-restricted-syntax */\n/* eslint-disable guard-for-in */\n/* eslint-disable no-unused-vars */\nimport {\n  DiffNode,\n  isChildNode,\n  NodeID,\n  Nodes,\n  Provenance,\n  ProvenanceNode,\n  StateNode,\n} from '@visdesignlab/trrack';\nimport * as d3 from 'd3';\nimport { observer } from 'mobx-react';\nimport React, { ReactChild, useEffect, useState } from 'react';\nimport { NodeGroup } from 'react-move';\nimport { Popup, Tab } from 'semantic-ui-react';\nimport { style } from 'typestyle';\n\nimport { BundleMap, OriginMap } from '../Utils/BundleMap';\nimport { EventConfig } from '../Utils/EventConfig';\nimport findBundleParent from '../Utils/findBundleParent';\nimport translate from '../Utils/translate';\nimport { treeLayout } from '../Utils/TreeLayout';\n\nimport BackboneNode from './BackboneNode';\nimport BookmarkListView from './BookmarkListView';\nimport bundleTransitions from './BundleTransitions';\nimport Link from './Link';\nimport linkTransitions from './LinkTransitions';\nimport nodeTransitions from './NodeTransitions';\nimport { treeColor } from './Styles';\nimport UndoRedoButton from './UndoRedoButton';\n\nconst container = style({\n  alignItems: 'center',\n  justifyContent: 'center',\n  overflow: 'auto',\n});\n\ntype ProvVisProps<T, S extends string> = {\n  root: NodeID;\n  sideOffset?: number;\n  iconOnly?: boolean;\n  current: NodeID;\n  nodeMap: Nodes<T, S>;\n  approvedFunction: (id: NodeID) => void;\n  rejectedFunction: (id: NodeID) => void;\n  addToWorkflow: (id: NodeID) => void;\n  nodeCreationMap: OriginMap;\n  currentDataset: string;\n  backboneGutter?: number;\n  gutter?: number;\n  verticalSpace?: number;\n  annotationHeight?: number;\n  clusterVerticalSpace?: number;\n  regularCircleRadius?: number;\n  backboneCircleRadius?: number;\n  regularCircleStroke?: number;\n  backboneCircleStroke?: number;\n  topOffset?: number;\n  textSize?: number;\n  height?: number;\n  width?: number;\n  linkWidth?: number;\n  duration?: number;\n  clusterLabels?: boolean;\n  bundleMap?: BundleMap;\n  eventConfig?: EventConfig<S>;\n  changeCurrent?: (id: NodeID) => void;\n  brushCallback?: (selected: string[]) => void;\n  popupContent?: (nodeId: StateNode<T, S>) => ReactChild;\n  annotationContent?: (nodeId: StateNode<T, S>) => ReactChild;\n\n  undoRedoButtons?: boolean;\n  bookmarkToggle?: boolean;\n  bookmarkListView?: boolean;\n  editAnnotations?: boolean;\n  prov?: Provenance<T, S>;\n  ephemeralUndo?: boolean;\n};\n\nexport type StratifiedMap<T, S> = {\n  [key: string]: d3.HierarchyNode<ProvenanceNode<T, S>>;\n};\n\nexport type StratifiedList<T, S> = d3.HierarchyNode<ProvenanceNode<T, S>>[];\n\nfunction ProvVis<T, S extends string, A>({\n  nodeMap,\n  root,\n  current,\n  changeCurrent,\n  width = 400,\n  height = 800,\n  iconOnly = false,\n  gutter = 15,\n  backboneGutter = 20,\n  verticalSpace = 50,\n  annotationHeight = 100,\n  clusterVerticalSpace = 50,\n  regularCircleRadius = 4,\n  backboneCircleRadius = 5,\n  regularCircleStroke = 3,\n  backboneCircleStroke = 3,\n  sideOffset = 200,\n  topOffset = 30,\n  textSize = 15,\n  linkWidth = 4,\n  duration = 600,\n  clusterLabels = true,\n  bundleMap = {},\n  eventConfig,\n  popupContent,\n  annotationContent,\n  approvedFunction,\n  rejectedFunction,\n  addToWorkflow,\n  currentDataset,\n  nodeCreationMap,\n  editAnnotations = false,\n  prov,\n  ephemeralUndo = false,\n}: ProvVisProps<T, S>) {\n  const [first, setFirst] = useState(true);\n  const [bookmark, setBookmark] = useState<any>(null);\n  const [annotationOpen, setAnnotationOpen] = useState(-1);\n\n  let list: string[] = [];\n  const eventTypes = new Set<string>();\n\n  for (const j in nodeMap) {\n    const child = nodeMap[j];\n\n    if (isChildNode(child)) {\n      if (child.metadata.eventType) {\n        eventTypes.add(child.metadata.eventType as any);\n      }\n\n      if (\n        child.actionType === 'Ephemeral' &&\n        child.children.length === 1 &&\n        (nodeMap[child.parent].actionType !== 'Ephemeral' ||\n          nodeMap[child.parent].children.length > 1)\n      ) {\n        const group: string[] = [];\n        let curr = child;\n\n        while (curr.actionType === 'Ephemeral') {\n          group.push(curr.id);\n\n          if (curr.children.length === 1 && nodeMap[curr.children[0]].actionType === 'Ephemeral') {\n            curr = nodeMap[curr.children[0]] as DiffNode<T, S>;\n          } else {\n            break;\n          }\n        }\n\n        bundleMap[child.id] = {\n          metadata: '',\n          bundleLabel: '',\n          bunchedNodes: group,\n        };\n      }\n    }\n  }\n\n  if (bundleMap) {\n    list = list.concat(Object.keys(bundleMap));\n  }\n\n  function setDefaultConfig<E extends string>(types: Set<string>): EventConfig<E> {\n    const symbols = [\n      d3.symbol().type(d3.symbolStar).size(50),\n      d3.symbol().type(d3.symbolDiamond),\n      d3.symbol().type(d3.symbolTriangle),\n      d3.symbol().type(d3.symbolCircle),\n      d3.symbol().type(d3.symbolCross),\n      d3.symbol().type(d3.symbolSquare),\n      d3.symbol().type(d3.symbolWye),\n    ];\n\n    // Find nodes in the clusters whose entire cluster is on the backbone.\n    const conf: EventConfig<E> = {};\n    let counter = 0;\n\n    for (const j of types) {\n      conf[j] = {};\n      conf[j].backboneGlyph = (\n        <path className={treeColor(false)} d={symbols[counter]()!} strokeWidth={2} />\n      );\n\n      conf[j].bundleGlyph = (\n        <path className={treeColor(false)} d={symbols[counter]()!} strokeWidth={2} />\n      );\n\n      conf[j].currentGlyph = (\n        <path className={treeColor(true)} d={symbols[counter]()!} strokeWidth={2} />\n      );\n\n      conf[j].regularGlyph = (\n        <path className={treeColor(false)} d={symbols[counter]()!} strokeWidth={2} />\n      );\n\n      counter += 1;\n    }\n\n    return conf;\n  }\n\n  const [expandedClusterList, setExpandedClusterList] = useState<string[]>(Object.keys(bundleMap));\n\n  if (!eventConfig && eventTypes.size > 0 && eventTypes.size < 8) {\n    eventConfig = setDefaultConfig<S>(eventTypes);\n  }\n\n  useEffect(() => {\n    setFirst(false);\n  }, []);\n\n  const nodeList = Object.values(nodeMap).filter(() => true);\n\n  const copyList = Array.from(nodeList);\n\n  const keys = bundleMap ? Object.keys(bundleMap) : [];\n\n  // Find a list of all nodes included in a bundle.\n  let bundledNodes: string[] = [];\n\n  if (bundleMap) {\n    for (const key of keys) {\n      bundledNodes = bundledNodes.concat(bundleMap[key].bunchedNodes);\n      bundledNodes.push(key);\n    }\n  }\n\n  const strat = d3\n    .stratify<ProvenanceNode<T, S>>()\n    .id((d) => d.id)\n    .parentId((d) => {\n      if (d.id === root) return null;\n\n      if (isChildNode(d)) {\n        // If you are a unexpanded bundle, find your parent by going straight up.\n        if (\n          bundleMap &&\n          Object.keys(bundleMap).includes(d.id) &&\n          !expandedClusterList.includes(d.id)\n        ) {\n          let curr = d;\n\n          // eslint-disable-next-line no-constant-condition\n          while (true) {\n            const localCurr = curr;\n\n            if (\n              !bundledNodes.includes(localCurr.parent) ||\n              Object.keys(bundleMap).includes(localCurr.parent)\n            ) {\n              return localCurr.parent;\n            }\n\n            const temp = copyList.filter((c) => c.id === localCurr.parent)[0];\n\n            if (isChildNode(temp)) {\n              curr = temp;\n            }\n          }\n        }\n\n        const bundleParents = findBundleParent(d.parent, bundleMap);\n        let collapsedParent;\n\n        let allExpanded = true;\n\n        for (const j in bundleParents) {\n          if (!expandedClusterList.includes(bundleParents[j])) {\n            allExpanded = false;\n            collapsedParent = bundleParents[j];\n            break;\n          }\n        }\n\n        if (\n          bundledNodes.includes(d.parent) &&\n          bundleMap &&\n          !Object.keys(bundleMap).includes(d.parent) &&\n          !allExpanded\n        ) {\n          return collapsedParent;\n        }\n\n        return d.parent;\n      }\n\n      return null;\n    });\n\n  for (let i = 0; i < nodeList.length; i++) {\n    const bundleParents = findBundleParent(nodeList[i].id, bundleMap);\n\n    let allExpanded = true;\n\n    for (const j in bundleParents) {\n      if (!expandedClusterList.includes(bundleParents[j])) {\n        allExpanded = false;\n        break;\n      }\n    }\n\n    if (\n      bundledNodes.includes(nodeList[i].id) &&\n      !allExpanded &&\n      bundleMap &&\n      !Object.keys(bundleMap).includes(nodeList[i].id)\n    ) {\n      nodeList.splice(i, 1);\n      i--;\n    }\n  }\n\n  const stratifiedTree = strat(nodeList);\n\n  // //console.log(JSON.parse(JSON.stringify(stratifiedTree)));\n\n  const stratifiedList: StratifiedList<T, S> = stratifiedTree.descendants();\n  const stratifiedMap: StratifiedMap<T, S> = {};\n\n  stratifiedList.forEach((c) => {\n    stratifiedMap[c.id!] = c;\n  });\n  treeLayout(stratifiedMap, current, root);\n\n  let maxHeight = 0;\n  let maxWidth = 0;\n\n  for (const j in stratifiedList) {\n    if (stratifiedList[j].depth > maxHeight) {\n      maxHeight = stratifiedList[j].depth;\n    }\n\n    if ((stratifiedList[j] as any).width > maxWidth) {\n      maxWidth = (stratifiedList[j] as any).width;\n    }\n  }\n\n  const links = stratifiedTree.links();\n\n  const xOffset = gutter;\n  const yOffset = verticalSpace;\n\n  function regularGlyph(node: ProvenanceNode<T, S>) {\n    if (eventConfig) {\n      const { eventType }: { eventType: any } = node.metadata;\n\n      if (\n        eventType &&\n        eventType in eventConfig &&\n        eventType !== 'Root' &&\n        eventConfig[eventType].regularGlyph\n      ) {\n        return eventConfig[eventType].regularGlyph;\n      }\n    }\n\n    return (\n      <circle\n        className={treeColor(false)}\n        r={regularCircleRadius}\n        strokeWidth={regularCircleStroke}\n      />\n    );\n  }\n\n  function getY(height: number) {\n    const y = yOffset * height + 25;\n\n    return y;\n  }\n\n  function bundleGlyph(node: ProvenanceNode<T, S>) {\n    if (eventConfig) {\n      const { eventType }: { eventType: any } = node.metadata;\n\n      if (eventType && eventType in eventConfig && eventType !== 'Root') {\n        return eventConfig[eventType].bundleGlyph;\n      }\n    }\n\n    return (\n      <circle\n        className={treeColor(false)}\n        r={regularCircleRadius}\n        strokeWidth={regularCircleStroke}\n      />\n    );\n  }\n\n  let shiftLeft = 0;\n\n  if (maxWidth === 0) {\n    shiftLeft = 30;\n  } else if (maxWidth === 1) {\n    shiftLeft = 52;\n  } else if (maxWidth > 1) {\n    shiftLeft = 74;\n  }\n\n  const svgWidth = width;\n\n  const overflowStyle = {\n    overflowX: 'auto',\n    overflowY: 'auto',\n  } as React.CSSProperties;\n\n  const tabsStyle = {\n    backgroundColor: 'lightgrey',\n    width: '270px',\n  } as React.CSSProperties;\n\n  const bookmarkTabView = (\n    <svg\n      height={maxHeight < height ? height : maxHeight}\n      id=\"bookmarkView\"\n      style={{ overflow: 'visible' }}\n      width={svgWidth}\n    >\n      <g id=\"globalG\" transform={translate(shiftLeft, topOffset)}>\n        <BookmarkListView\n          currentNode={current}\n          eventConfig={eventConfig}\n          graph={prov ? (prov.graph as any) : undefined}\n        />\n      </g>\n    </svg>\n  );\n\n  const graphTabView = (\n    <div>\n      <div id=\"undoRedoDiv\">\n        <UndoRedoButton\n          graph={prov ? (prov.graph as any) : undefined}\n          redoCallback={() => {\n            if (prov) {\n              if (ephemeralUndo) {\n                prov.goForwardToNonEphemeral();\n              } else {\n                prov.goForwardOneStep();\n              }\n            }\n          }}\n          undoCallback={() => {\n            if (prov) {\n              if (ephemeralUndo) {\n                prov.goBackToNonEphemeral();\n              } else {\n                prov.goBackOneStep();\n              }\n            }\n          }}\n        />\n      </div>\n\n      <svg\n        height={maxHeight < height ? height : maxHeight}\n        id=\"topSvg\"\n        style={{ overflow: 'visible' }}\n        width={svgWidth}\n      >\n        <rect fill=\"none\" height={height} stroke=\"none\" width={width} />\n        <g id=\"globalG\" transform={translate(shiftLeft, topOffset)}>\n          <NodeGroup\n            data={links}\n            keyAccessor={(link) => `${link.source.id}${link.target.id}`}\n            {...linkTransitions(\n              xOffset,\n              yOffset,\n              clusterVerticalSpace,\n              backboneGutter - gutter,\n              duration,\n              annotationOpen,\n              annotationHeight,\n            )}\n          >\n            {(linkArr) => (\n              <>\n                {linkArr.map((link) => {\n                  const { key, state } = link;\n\n                  return (\n                    <g key={key}>\n                      <Link {...state} fill=\"#ccc\" stroke=\"#ccc\" strokeWidth={linkWidth} />\n                    </g>\n                  );\n                })}\n              </>\n            )}\n          </NodeGroup>\n          <NodeGroup\n            data={stratifiedList}\n            keyAccessor={(d) => d.id}\n            {...nodeTransitions(\n              xOffset,\n              yOffset,\n              clusterVerticalSpace,\n              backboneGutter - gutter,\n              duration,\n              annotationOpen,\n              annotationHeight,\n            )}\n          >\n            {(nodes) => (\n              <>\n                {nodes.map((node) => {\n                  const { data: d, key, state } = node;\n                  const popupTrigger = (\n                    <g\n                      key={key}\n                      transform={\n                        d.width === 0 ? translate(state.x, state.y) : translate(state.x, state.y)\n                      }\n                      onClick={() => {\n                        if (changeCurrent) {\n                          changeCurrent(d.id);\n                        }\n                      }}\n                      onMouseOut={() => {\n                        setBookmark(null);\n                      }}\n                      onMouseOver={() => {\n                        setBookmark(d.id);\n                      }}\n                    >\n                      {d.width === 0 && prov ? (\n                        <g>\n                          <rect\n                            height=\"25\"\n                            opacity=\"0\"\n                            transform=\"translate(0, -12.5)\"\n                            width=\"200\"\n                          />\n                          ,\n                          <BackboneNode\n                            addToWorkflow={addToWorkflow}\n                            annotationContent={annotationContent}\n                            annotationOpen={annotationOpen}\n                            approvedFunction={approvedFunction}\n                            bookmark={bookmark}\n                            bundleMap={bundleMap}\n                            clusterLabels={clusterLabels}\n                            current={current === d.id}\n                            currentDataset={currentDataset}\n                            duration={duration}\n                            editAnnotations={editAnnotations}\n                            eventConfig={eventConfig}\n                            exemptList={expandedClusterList}\n                            expandedClusterList={expandedClusterList}\n                            first={first}\n                            iconOnly={iconOnly}\n                            node={d.data}\n                            nodeCreationMap={nodeCreationMap}\n                            nodeMap={stratifiedMap}\n                            popupContent={popupContent}\n                            prov={prov}\n                            radius={backboneCircleRadius}\n                            rejectedFunction={rejectedFunction}\n                            setAnnotationOpen={setAnnotationOpen}\n                            setBookmark={setBookmark}\n                            setExemptList={setExpandedClusterList}\n                            strokeWidth={backboneCircleStroke}\n                            textSize={textSize}\n                          />\n                        </g>\n                      ) : popupContent !== undefined ? (\n                        <Popup\n                          content={popupContent(d.data)}\n                          trigger={\n                            <g\n                              onClick={() => {\n                                setAnnotationOpen(-1);\n                              }}\n                            >\n                              {keys.includes(d.id) ? bundleGlyph(d.data) : regularGlyph(d.data)}\n                            </g>\n                          }\n                        />\n                      ) : (\n                        <g\n                          onClick={() => {\n                            setAnnotationOpen(-1);\n                          }}\n                        >\n                          {regularGlyph(d.data)}\n                        </g>\n                      )}\n                    </g>\n                  );\n\n                  return popupTrigger;\n                })}\n              </>\n            )}\n          </NodeGroup>\n          <NodeGroup\n            data={keys}\n            keyAccessor={(key) => `${key}`}\n            {...bundleTransitions(\n              xOffset,\n              verticalSpace,\n              clusterVerticalSpace,\n              backboneGutter - gutter,\n              duration,\n              expandedClusterList,\n              stratifiedMap,\n              stratifiedList,\n              annotationOpen,\n              annotationHeight,\n              bundleMap,\n            )}\n          >\n            {(bundle) => (\n              <>\n                {bundle.map((b) => {\n                  const { key, state } = b;\n\n                  if (\n                    bundleMap === undefined ||\n                    (stratifiedMap[b.key] as any).width !== 0 ||\n                    state.validity === false\n                  ) {\n                    return null;\n                  }\n\n                  return (\n                    <g\n                      key={key}\n                      transform={translate(\n                        state.x - gutter + 5,\n                        state.y - clusterVerticalSpace / 2,\n                      )}\n                    >\n                      <rect\n                        fill=\"none\"\n                        height={state.height}\n                        rx=\"10\"\n                        ry=\"10\"\n                        stroke=\"rgb(248, 191, 132)\"\n                        strokeWidth=\"2px\"\n                        style={{ opacity: state.opacity }}\n                        width={iconOnly ? 42 : sideOffset - 15}\n                      />\n                    </g>\n                  );\n                })}\n              </>\n            )}\n          </NodeGroup>\n        </g>\n      </svg>\n    </div>\n  );\n\n  const panes = [\n    {\n      menuItem: { key: 'Graph', icon: 'share alternate', content: 'Graph' },\n      render: () => <Tab.Pane attached={false}>{graphTabView}</Tab.Pane>,\n    },\n    {\n      menuItem: {\n        key: 'Bookmarks/Annotations',\n        icon: 'bookmark',\n        content: 'Bookmarks/Annotations',\n      },\n      render: () => <Tab.Pane attached={false}>{bookmarkTabView}</Tab.Pane>,\n    },\n  ];\n\n  // const brushedNodes: string[] = [];\n\n  // const brush = d3\n  //   .brushY()\n  //   .extent([\n  //     [15, 0],\n  //     [50, 800],\n  //   ])\n  //   .on('end', (e) => {\n  //     brushedNodes = [];\n\n  //     if (!e.selection) {\n  //       return;\n  //     }\n\n  //     for (const j of stratifiedList) {\n  //       const y = getY(j.depth);\n\n  //       if (j.id && y > e.selection[0] && y < e.selection[1]) {\n  //         brushedNodes.push(j.id);\n  //       }\n  //     }\n\n  //     if (brushCallback) {\n  //       brushCallback(brushedNodes);\n  //     }\n  //   });\n\n  // d3.select<any, any>('#topSvg').call(brush);\n\n  return (\n    <div className={container} id=\"prov-vis\" style={overflowStyle}>\n      <Tab menu={{ secondary: true, pointing: true }} panes={panes} />\n    </div>\n  );\n}\n\nexport default observer(ProvVis);\n","import translate from '../../../utils/transform';\n\ntype AddTaskGlyphProps = {\n  size?: number;\n  fill?: string;\n  scale?: number;\n};\n\n//Occurs on selecting rectangular brush\nexport function ChangeBrushType({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g transform={translate(-size / 2, -size / 2)}>\n        <svg height={size} viewBox=\"0 0 141.75 141.75\" width={size}>\n          <g id=\"Layer 1\">\n            <path\n              d=\"M0+141.75L141.069+0.305731\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"8\"\n            />\n            <path\n              d=\"M76.2578+103.486L90.5601+114.114C90.5601+114.114+99.8156+137.498+74.2147+137.498C53.7829+137.498+48.8808+110.711+49.6965+109.863C49.6965+109.863+60.7858+122.325+61.9556+116.24C63.9988+105.611+76.2578+103.486+76.2578+103.486ZM127.585+49.613C127.308+49.6166+127.031+49.6388+126.751+49.6794C124.356+50.0268+121.717+51.7745+118.137+55.3776L84.3591+88.0407C84.3585+88.0411+84.3578+88.0402+84.3573+88.0407C82.4109+89.8348+81.776+93.0922+82.5535+96.6415C83.3425+100.243+85.4619+103.608+88.3851+105.635C91.2896+107.65+95.1882+108.221+99.2129+107.403C103.001+106.633+106.521+104.693+108.654+102.179C108.654+102.179+108.653+102.178+108.654+102.177C108.654+102.177+108.655+102.178+108.655+102.177L134.486+66.7279C134.487+66.7273+134.486+66.7266+134.486+66.726C136.375+63.9384+137.395+61.4407+137.462+59.166C137.537+56.6101+136.4+54.3632+133.911+52.4215C131.424+50.4808+129.522+49.5881+127.585+49.613Z\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"8\"\n            />\n            <path\n              d=\"M17.5647+7.49443L61.7224+7.49443C66.5892+7.49443+70.5345+12.5807+70.5345+18.8549L70.5345+50.7774C70.5345+57.0516+66.5892+62.1379+61.7224+62.1379L17.5647+62.1379C12.6979+62.1379+8.75258+57.0516+8.75258+50.7774L8.75258+18.8549C8.75258+12.5807+12.6979+7.49443+17.5647+7.49443Z\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"8\"\n            />\n          </g>\n        </svg>\n      </g>\n    </g>\n  );\n}\n\n//Occurs on clear all click ???\nexport function ClearAll({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf2ed;\n        </text>\n      </g>\n    </g>\n  );\n}\n\n//Occurs on clear all click ???\nexport function Filter({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf0b0;\n        </text>\n      </g>\n    </g>\n  );\n}\n\n//Occurs on removing a brush\nexport function RemoveBrush({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf057;\n        </text>\n      </g>\n    </g>\n  );\n}\n\n//Occurs on shifting a rectangle size, dragging it ???\nexport function ChangeBrush({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf044;\n        </text>\n      </g>\n    </g>\n  );\n}\n\n//Occurs on invert\nexport function Invert({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf042;\n        </text>\n      </g>\n    </g>\n  );\n}\n\nexport function TurnPrediction({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g transform={translate(-size / 2, -size / 2)}>\n        <svg height={size} viewBox=\"0 0 141.75 141.75\" width={size}>\n          <g id=\"Layer 1\">\n            <path\n              d=\"M11.34-11.34L11.6801+130.41L153.09+130.41\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"miter\"\n              strokeWidth=\"25\"\n            />\n            <path\n              d=\"M41.0944+103.248C41.0944+96.3307+46.8061+90.7234+53.8519+90.7234C60.8977+90.7234+66.6094+96.4351+66.6094+103.481C66.6094+110.527+60.8977+116.238+53.8519+116.238C46.8061+116.238+41.0944+110.165+41.0944+103.248Z\"\n              fill={fill}\n              opacity=\"1\"\n            />\n            <path\n              d=\"M28.3369+70.6417C28.3369+63.7248+34.0486+58.1175+41.0944+58.1175C48.1402+58.1175+53.8519+63.8292+53.8519+70.875C53.8519+77.9208+48.1402+83.6325+41.0944+83.6325C34.0486+83.6325+28.3369+77.5587+28.3369+70.6417Z\"\n              fill={fill}\n              opacity=\"1\"\n            />\n            <path\n              d=\"M66.6094+83.3992C66.6094+76.4823+72.3211+70.875+79.3669+70.875C86.4127+70.875+92.1244+76.5867+92.1244+83.6325C92.1244+90.6783+86.4127+96.39+79.3669+96.39C72.3211+96.39+66.6094+90.3162+66.6094+83.3992Z\"\n              fill={fill}\n              opacity=\"1\"\n            />\n            <path\n              d=\"M53.8519+57.8842C53.8519+50.9673+59.5636+45.36+66.6094+45.36C73.6552+45.36+79.3669+51.0717+79.3669+58.1175C79.3669+65.1633+73.6552+70.875+66.6094+70.875C59.5636+70.875+53.8519+64.8012+53.8519+57.8842Z\"\n              fill={fill}\n              opacity=\"1\"\n            />\n            <path\n              d=\"M101.341+31.4476C101.341+24.5307+107.053+18.9234+114.098+18.9234C121.144+18.9234+126.856+24.6352+126.856+31.6809C126.856+38.7267+121.144+44.4384+114.098+44.4384C107.053+44.4384+101.341+38.3646+101.341+31.4476Z\"\n              fill={fill}\n              opacity=\"1\"\n            />\n            <path\n              d=\"M90.001+31.2403C90.001+18.175+100.79+7.58342+114.098+7.58342C127.407+7.58342+138.196+18.3722+138.196+31.6809C138.196+44.9896+127.407+55.7784+114.098+55.7784C100.79+55.7784+90.001+44.3056+90.001+31.2403Z\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"8\"\n            />\n          </g>\n        </svg>\n      </g>\n    </g>\n  );\n}\n\n//When the check is clicked\nexport function LockPrediction({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf0eb;\n        </text>\n      </g>\n    </g>\n  );\n}\n\n//When a rectangular brush is added\nexport function AddBrush({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf5cb;\n        </text>\n      </g>\n    </g>\n  );\n}\n\n//When a point is individually deselected\nexport function PointDeselection({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf12d;\n        </text>\n      </g>\n    </g>\n  );\n}\n\n//When a brush or individual selection is made\nexport function PointSelection({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf1fc;\n        </text>\n      </g>\n    </g>\n  );\n}\n\n//When add plot is clicked, or initial loading of data.\nexport function AddPlot({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g transform={translate(-size / 2, -size / 2)}>\n        <svg height={size} viewBox=\"0 0 141.75 141.75\" width={size}>\n          <g id=\"Layer 1\">\n            <path\n              d=\"M11.34-11.34L11.6801+130.41L153.09+130.41\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"miter\"\n              strokeWidth=\"25\"\n            />\n            <path\n              d=\"M77.7957+28.35L77.7957+99.225\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"butt\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"25\"\n            />\n            <path\n              d=\"M113.4+63.8289L42.525+63.7875\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"butt\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"25\"\n            />\n          </g>\n        </svg>\n      </g>\n    </g>\n  );\n}\n\n//Whenever a new dataset is selected\nexport function LoadDataset({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf0ce;\n        </text>\n      </g>\n    </g>\n  );\n}\n\nexport function MultiBrush({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g transform={translate(-size / 2, -size / 2)}>\n        <svg height={size} viewBox=\"0 0 141.75 141.75\" width={size}>\n          <g id=\"Layer 1\">\n            <path\n              d=\"M70.875+133.084C94.2246+133.264+117.574+113.829+117.574+87.3323C117.574+60.8354+117.574+0+117.574+0\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"butt\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"15\"\n            />\n            <path\n              d=\"M70.875+133.084C47.5254+133.264+24.1758+113.829+24.1758+87.3323C24.1758+60.8354+24.1758+0+24.1758+0\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"butt\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"15\"\n            />\n          </g>\n        </svg>\n      </g>\n    </g>\n  );\n}\n\nexport function SwitchCategoryVisibility({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf61f;\n        </text>\n      </g>\n    </g>\n  );\n}\n\nexport function ChangeBrushSize({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g transform={translate(-size / 2, -size / 2)}>\n        <svg height={size} viewBox=\"0 0 141.75 141.75\" width={size}>\n          <g id=\"Layer 1\">\n            <path\n              d=\"M76.8252+103.165L90.6711+113.451C90.6711+113.451+99.6313+136.08+74.8472+136.08C55.0673+136.08+50.3216+110.158+51.1113+109.337C51.1113+109.337+61.8468+121.397+62.9792+115.508C64.9572+105.222+76.8252+103.165+76.8252+103.165ZM126.515+51.0305C126.247+51.0339+125.979+51.0555+125.708+51.0948C123.388+51.431+120.834+53.1223+117.368+56.6091L84.6679+88.2186C84.6674+88.219+84.6667+88.2181+84.6662+88.2186C82.7819+89.9548+82.1673+93.1071+82.92+96.5419C83.6838+100.027+85.7355+103.283+88.5655+105.246C91.3773+107.195+95.1515+107.748+99.0478+106.956C102.715+106.212+106.122+104.333+108.187+101.901C108.188+101.9+108.187+101.9+108.187+101.899C108.188+101.899+108.189+101.9+108.189+101.899L133.196+67.5932C133.196+67.5927+133.195+67.592+133.196+67.5915C135.024+64.8937+136.012+62.4766+136.077+60.2753C136.149+57.8019+135.048+55.6274+132.639+53.7484C130.231+51.8702+128.39+51.0064+126.515+51.0305Z\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"8\"\n            />\n            <path\n              d=\"M7.0875+29.2572L49.6125+29.2572\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"12.58\"\n            />\n            <path\n              d=\"M28.4705+8.505L28.35+51.03\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"12.58\"\n            />\n            <path\n              d=\"M28.4705+72.2925L70.9955+29.7675\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"5\"\n            />\n            <path\n              d=\"M58.1175+62.3878L58.1175+62.3878L70.0025+62.3878L93.555+62.3878\"\n              fill=\"none\"\n              opacity=\"1\"\n              stroke={fill}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"12.58\"\n            />\n          </g>\n        </svg>\n      </g>\n    </g>\n  );\n}\n\nexport function ChangeCategory({ size = 15, fill = '#ccc' }: AddTaskGlyphProps) {\n  return (\n    <g>\n      <circle fill=\"white\" r={size - size / 4} />\n      <g>\n        <text\n          dominantBaseline=\"middle\"\n          fill={fill}\n          fontFamily=\"FontAwesome\"\n          fontSize={size}\n          textAnchor=\"middle\"\n        >\n          &#xf61f;\n        </text>\n      </g>\n    </g>\n  );\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable no-unused-vars */\nimport { NodeID, Provenance, ProvenanceGraph } from '@visdesignlab/trrack';\nimport { configure } from 'mobx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { BundleMap, OriginMap } from '../Utils/BundleMap';\nimport { EventConfig } from '../Utils/EventConfig';\n\nimport ProvVis from './ProvVis';\nimport UndoRedoButton from './UndoRedoButton';\n\nexport type ProvVisConfig = {\n  eventConfig: EventConfig<any>;\n  editAnnotations: boolean;\n  bundleMap: BundleMap;\n  iconOnly: boolean;\n  iconSize: number;\n  height: number;\n  width: number;\n  sideOffset: number;\n  backboneGutter: number;\n  gutter: number;\n  verticalSpace: number;\n  regularCircleRadius: number;\n  backboneCircleRadius: number;\n  regularCircleStroke: number;\n  backboneCircleStroke: number;\n  topOffset: number;\n  textSize: number;\n  linkWidth: number;\n  duration: number;\n};\nconfigure({ isolateGlobalState: true });\nexport function ProvVisCreator<T, S extends string, A>(\n  node: Element,\n  prov: Provenance<T, S, A>,\n  currentDataset: string,\n  approvedFunction: (id: NodeID) => void,\n  rejectedFunction: (id: NodeID) => void,\n  nodeCreationMap: OriginMap,\n  callback?: (id: NodeID) => void,\n  brushCallback?: (selected: string[]) => void,\n  ephemeralUndo = false,\n  fauxRoot: NodeID = prov.graph.root,\n\n  config: Partial<ProvVisConfig> = {},\n) {\n  prov.addGlobalObserver(() => {\n    ReactDOM.render(\n      <ProvVis\n        {...config}\n        // eslint-disable-next-line no-console\n        addToWorkflow={(id: string) => console.log(id)}\n        approvedFunction={approvedFunction}\n        brushCallback={brushCallback}\n        changeCurrent={callback}\n        current={prov.graph.current}\n        currentDataset={currentDataset}\n        ephemeralUndo={ephemeralUndo}\n        nodeCreationMap={nodeCreationMap}\n        nodeMap={prov.graph.nodes}\n        prov={prov as any}\n        rejectedFunction={rejectedFunction}\n        root={fauxRoot}\n        undoRedoButtons\n      />,\n      node,\n    );\n  });\n\n  ReactDOM.render(\n    <ProvVis\n      {...config}\n      // eslint-disable-next-line no-console\n      addToWorkflow={(id: string) => console.log(id)}\n      approvedFunction={approvedFunction}\n      brushCallback={brushCallback}\n      changeCurrent={callback}\n      current={prov.graph.current}\n      currentDataset={currentDataset}\n      ephemeralUndo={ephemeralUndo}\n      nodeCreationMap={nodeCreationMap}\n      nodeMap={prov.graph.nodes}\n      prov={prov as any}\n      rejectedFunction={rejectedFunction}\n      root={fauxRoot}\n      undoRedoButtons\n    />,\n    node,\n  );\n}\n\nexport function UndoRedoButtonCreator<T, S extends string>(\n  node: Element,\n  graph: ProvenanceGraph<T, S>,\n  undoCallback: () => void,\n  redoCallback: () => void,\n) {\n  ReactDOM.render(\n    <UndoRedoButton graph={graph} redoCallback={redoCallback} undoCallback={undoCallback} />,\n    node,\n  );\n}\n","import { EventConfig } from '../../library/trrack-vis/Utils/EventConfig';\nimport {\n  AddBrush,\n  ChangeBrush,\n  Filter,\n  Invert,\n  PointDeselection,\n  PointSelection,\n  RemoveBrush,\n  TurnPrediction,\n} from '../../library/trrack-vis/Utils/Icons';\nimport { ReapplyEvents } from '../../stores/types/Provenance';\n\nexport const eventConfig: EventConfig<ReapplyEvents> = {\n  'Point Selection': {\n    backboneGlyph: <PointSelection size={22} />,\n    currentGlyph: <PointSelection fill=\"#2185d0\" size={22} />,\n    regularGlyph: <PointSelection size={16} />,\n    bundleGlyph: <PointSelection fill=\"#2185d0\" size={22} />,\n  },\n  'Point Deselection': {\n    backboneGlyph: <PointDeselection size={22} />,\n    currentGlyph: <PointDeselection fill=\"#2185d0\" size={22} />,\n    regularGlyph: <PointDeselection size={16} />,\n    bundleGlyph: <PointDeselection fill=\"#2185d0\" size={22} />,\n  },\n  'Add Brush': {\n    backboneGlyph: <AddBrush size={22} />,\n    currentGlyph: <AddBrush fill=\"#2185d0\" size={22} />,\n    regularGlyph: <AddBrush size={16} />,\n    bundleGlyph: <AddBrush fill=\"#2185d0\" size={22} />,\n  },\n  'Algorithmic Selection': {\n    backboneGlyph: <TurnPrediction size={22} />,\n    currentGlyph: <TurnPrediction fill=\"#2185d0\" size={22} />,\n    regularGlyph: <TurnPrediction size={16} />,\n    bundleGlyph: <TurnPrediction fill=\"#2185d0\" size={22} />,\n  },\n  Invert: {\n    backboneGlyph: <Invert size={22} />,\n    currentGlyph: <Invert fill=\"#2185d0\" size={22} />,\n    regularGlyph: <Invert size={16} />,\n    bundleGlyph: <Invert fill=\"#2185d0\" size={22} />,\n  },\n  'Update Brush': {\n    backboneGlyph: <ChangeBrush size={22} />,\n    currentGlyph: <ChangeBrush fill=\"#2185d0\" size={22} />,\n    regularGlyph: <ChangeBrush size={16} />,\n    bundleGlyph: <ChangeBrush fill=\"#2185d0\" size={22} />,\n  },\n  'Remove Brush': {\n    backboneGlyph: <RemoveBrush size={22} />,\n    currentGlyph: <RemoveBrush fill=\"#2185d0\" size={22} />,\n    regularGlyph: <RemoveBrush size={16} />,\n    bundleGlyph: <RemoveBrush fill=\"#2185d0\" size={22} />,\n  },\n  Filter: {\n    backboneGlyph: <Filter size={22} />,\n    currentGlyph: <Filter fill=\"#2185d0\" size={22} />,\n    regularGlyph: <Filter size={16} />,\n    bundleGlyph: <Filter fill=\"#ccc\" size={22} />,\n  },\n};\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/no-empty-function */\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { observer } from 'mobx-react';\nimport { useCallback } from 'react';\n\nimport { ProvVis } from '../library/trrack-vis';\nimport { useStore } from '../stores/RootStore';\n\nimport { eventConfig } from './utils/EventConfig';\n\nconst ProvenanceTree = () => {\n  const {\n    projectStore: { datasetVersionFromKey, dataset_id },\n    exploreStore: { nodeCreationMap, provenance, approveNode, rejectNode, workflow },\n  } = useStore();\n  const { graph } = provenance;\n\n  const changeCurrent = useCallback(\n    (nodeId: string) => {\n      provenance.goToNode(nodeId);\n    },\n    [provenance],\n  );\n\n  const addToWorkflow = useCallback(\n    (id: string) => {\n      if (workflow && !workflow.doesCurrentHaveWorkflow) {\n        workflow.addToWorkflow(id);\n      }\n    },\n    [workflow],\n  );\n\n  return (\n    <ProvVis\n      key={graph.root}\n      addToWorkflow={addToWorkflow}\n      approvedFunction={approveNode}\n      backboneGutter={40}\n      changeCurrent={changeCurrent}\n      current={graph.current}\n      currentDataset={datasetVersionFromKey(dataset_id)}\n      ephemeralUndo={false}\n      eventConfig={eventConfig}\n      nodeCreationMap={nodeCreationMap}\n      nodeMap={graph.nodes as any}\n      prov={provenance as any}\n      rejectedFunction={rejectNode}\n      root={graph.root}\n      width={250}\n      undoRedoButtons\n    />\n  );\n};\n\nexport default observer(ProvenanceTree);\n","import { Card, CardContent, CardHeader, createStyles, makeStyles } from '@material-ui/core';\nimport CheckBoxOutlineBlankIcon from '@material-ui/icons/CheckBoxOutlineBlank';\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\nimport { ToggleButton, ToggleButtonGroup } from '@material-ui/lab';\nimport { observer } from 'mobx-react';\n\nimport { useStore } from '../../stores/RootStore';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      minWidth: 250,\n    },\n    content: {\n      display: 'flex',\n      justifyContent: 'center',\n    },\n  }),\n);\n\nconst BrushSelector = () => {\n  const styles = useStyles();\n  const {\n    exploreStore: { brushType, switchBrush },\n  } = useStore();\n\n  return (\n    <Card className={styles.root}>\n      <CardHeader title=\"Brush Type\" />\n      <CardContent className={styles.content}>\n        <ToggleButtonGroup\n          size=\"small\"\n          value={brushType}\n          exclusive\n          onChange={(_, bt) => switchBrush(bt)}\n        >\n          <ToggleButton value=\"Rectangular\">\n            <CheckBoxOutlineBlankIcon />\n          </ToggleButton>\n          <ToggleButton value=\"Freeform Small\">\n            <RadioButtonUncheckedIcon fontSize=\"small\" />\n          </ToggleButton>\n          <ToggleButton value=\"Freeform Medium\">\n            <RadioButtonUncheckedIcon />\n          </ToggleButton>\n          <ToggleButton value=\"Freeform Large\">\n            <RadioButtonUncheckedIcon fontSize=\"large\" />\n          </ToggleButton>\n        </ToggleButtonGroup>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default observer(BrushSelector);\n","import { SymbolType } from 'd3';\nimport { createContext } from 'react';\n\nimport { AggregateBy } from './../types/Interactions';\n\nexport type AggMap = { [column: string]: AggregateBy };\n\ntype GlobalPlotAttributes = {\n  showCategory: boolean;\n  labelMap: { [k: string]: string };\n  selectedCategoryColumn: string | null;\n  categoryMap: { [key: string]: SymbolType };\n  hoveredCategory: string | null;\n  setHoveredCategory: (cat: string | null) => void;\n  aggregateOptions: AggMap | null;\n  setAggregateOptions: (agg: AggMap) => void;\n};\n\nexport const GlobalPlotAttributeContext = createContext<GlobalPlotAttributes | null>(null);\n","import { Button, makeStyles } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { FC } from 'react';\nimport { ReactNode } from 'react-transition-group/node_modules/@types/react';\n\nimport { useStore } from '../../stores/RootStore';\nimport translate from '../../utils/transform';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n  },\n});\n\ntype Props = {\n  disabled?: boolean;\n  label: string;\n  path?: string | null;\n  shape?: ReactNode | null;\n  transform?: string;\n  width?: string;\n  onClick?: () => void;\n  onMouseEnter?: () => void;\n  onMouseLeave?: () => void;\n};\n\nconst Symbol: FC<Props> = ({\n  disabled = false,\n  path,\n  shape,\n  label,\n  onClick,\n  onMouseEnter,\n  onMouseLeave,\n  width = 25,\n  transform = 'rotate(0)',\n}) => {\n  const styles = useStyles();\n  const {\n    exploreStore: { setHighlightMode, setHighlightPredicate },\n  } = useStore();\n\n  return (\n    <div className={styles.root}>\n      <Button\n        disabled={disabled}\n        startIcon={\n          <svg height=\"25\" viewBox=\"0 0 25 25\" width={width}>\n            {path && <path d={path} opacity=\"0.5\" transform={`${translate(25 / 2)}${transform}`} />}\n            {shape && shape}\n          </svg>\n        }\n        onClick={() => {\n          if (onClick) onClick();\n        }}\n        onMouseEnter={() => {\n          if (onMouseEnter) {\n            onMouseEnter();\n          } else {\n            setHighlightMode(true);\n            setHighlightPredicate((p) => p.category === label);\n          }\n        }}\n        onMouseLeave={() => {\n          if (onMouseLeave) {\n            onMouseLeave();\n          } else {\n            setHighlightMode(false);\n            setHighlightPredicate(null);\n          }\n        }}\n      >\n        {label}\n      </Button>\n    </div>\n  );\n};\n\nexport default observer(Symbol);\n","import {\n  Button,\n  Card,\n  CardContent,\n  CardHeader,\n  createStyles,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  makeStyles,\n  Switch,\n  TextField,\n  Theme,\n  Typography,\n} from '@material-ui/core';\nimport { Autocomplete, createFilterOptions } from '@material-ui/lab';\nimport { symbol, symbols } from 'd3';\nimport { observer } from 'mobx-react';\nimport { FormEvent, useContext, useMemo, useState } from 'react';\n\nimport { GlobalPlotAttributeContext } from '../../contexts/CategoryContext';\nimport { useStore } from '../../stores/RootStore';\n\nimport Symbol from './Symbol';\n\ntype CategoryOption = {\n  inputValue?: string;\n  title: string;\n};\n\ntype NewCategory = {\n  name: string;\n  options: string;\n};\n\nconst filter = createFilterOptions<CategoryOption>();\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: { minWidth: 250 },\n    fc: { margin: theme.spacing(1), minWidth: 200 },\n    form: {\n      '& .MuiTextField-root': {\n        margin: theme.spacing(1),\n        width: '25ch',\n      },\n    },\n  }),\n);\n\nconst CategoriesCard = () => {\n  const styles = useStyles();\n  const {\n    exploreStore: {\n      toggleShowCategories,\n      doesHaveCategories,\n      data,\n      changeCategoryColumn,\n      handleCategorization,\n      selections,\n    },\n    projectStore: { addCategoryColumn },\n  } = useStore();\n\n  const { showCategory = false, selectedCategoryColumn = null, categoryMap = {} } =\n    useContext(GlobalPlotAttributeContext) || {};\n\n  const categoryOptions: CategoryOption[] = useMemo(() => {\n    if (!data) return [];\n\n    return data.categoricalColumns.map((c) => ({\n      title: c,\n    }));\n  }, [data]);\n\n  const [openDialog, setOpenDialog] = useState(false);\n  const [dialogValue, setDialogValue] = useState<NewCategory>({ name: '', options: '' });\n\n  const handleDialogClose = () => {\n    setDialogValue({ name: '', options: '' });\n    setOpenDialog(false);\n  };\n\n  const handleSubmit = (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    addCategoryColumn(dialogValue.name, dialogValue.options);\n    setOpenDialog(false);\n  };\n\n  if (!data) return <div>Loading</div>;\n\n  return (\n    <>\n      <Card className={styles.root}>\n        <CardHeader\n          action={\n            <Switch\n              checked={showCategory}\n              disabled={!doesHaveCategories}\n              size=\"small\"\n              onChange={toggleShowCategories}\n            />\n          }\n          subheader=\"Enable category encoding\"\n          title=\"Categories\"\n        />\n        {!doesHaveCategories ? (\n          <CardContent>No category column in the dataset!</CardContent>\n        ) : (\n          <CardContent>\n            <Autocomplete\n              disabled={!showCategory}\n              filterOptions={(options, params) => {\n                const filtered = filter(options, params);\n\n                if (params.inputValue !== '') {\n                  filtered.push({\n                    inputValue: params.inputValue,\n                    title: `Add \"${params.inputValue}\"`,\n                  });\n                }\n\n                return filtered;\n              }}\n              getOptionLabel={(option) => {\n                if (typeof option === 'string') return option;\n\n                if (option.inputValue) return option.inputValue;\n\n                return option.title;\n              }}\n              getOptionSelected={(option, value) => option.title === value.title}\n              options={categoryOptions}\n              renderInput={(params) => (\n                <TextField {...params} label=\"Showing categories\" variant=\"outlined\" />\n              )}\n              renderOption={(opt) => (\n                <Typography variant=\"button\">{opt.title.toUpperCase()}</Typography>\n              )}\n              value={selectedCategoryColumn ? { title: selectedCategoryColumn } : null}\n              clearOnBlur\n              handleHomeEndKeys\n              selectOnFocus\n              onChange={(event, newValue) => {\n                if (typeof newValue === 'string') {\n                  setTimeout(() => {\n                    setOpenDialog(true);\n                    setDialogValue({ name: newValue, options: '' });\n                  });\n                } else if (newValue && newValue.inputValue) {\n                  setOpenDialog(true);\n                  setDialogValue({ name: newValue.inputValue, options: '' });\n                } else {\n                  changeCategoryColumn(newValue?.title || null);\n                }\n              }}\n            />\n            {selectedCategoryColumn === null ? (\n              <CardContent>Loading...</CardContent>\n            ) : (\n              Object.entries(categoryMap).map(([col, sym]) => (\n                <Symbol\n                  key={col}\n                  disabled={!showCategory}\n                  label={col}\n                  path={symbol(sym).size(100)()}\n                  onClick={() => {\n                    if (selections.length > 0) handleCategorization(selectedCategoryColumn, col);\n                  }}\n                />\n              ))\n            )}\n          </CardContent>\n        )}\n      </Card>\n      <Dialog open={openDialog} onClose={handleDialogClose}>\n        <form className={styles.form} onSubmit={handleSubmit}>\n          <DialogTitle>Add a new categorical dimension.</DialogTitle>\n          <DialogContent>\n            <DialogContentText>\n              Specify the options you want, seperated by commas (,)\n            </DialogContentText>\n            <TextField\n              id=\"category-name\"\n              label=\"Category Name\"\n              type=\"text\"\n              value={dialogValue.name}\n              autoFocus\n              onChange={(event) => setDialogValue({ ...dialogValue, name: event.target.value })}\n            />\n            <FormControl fullWidth>\n              <TextField\n                helperText={`Max ${symbols.length - 1} options supported.`}\n                id=\"category-options\"\n                label=\"Options\"\n                type=\"text\"\n                value={dialogValue.options}\n                autoFocus\n                fullWidth\n                multiline\n                onChange={(event) =>\n                  setDialogValue({\n                    ...dialogValue,\n                    options: event.target.value,\n                  })\n                }\n              />\n            </FormControl>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={handleDialogClose}>Cancel</Button>\n            <Button\n              disabled={\n                dialogValue.options.length === 0 ||\n                dialogValue.options.split(',').length >= symbols.length\n              }\n              type=\"submit\"\n            >\n              Add\n            </Button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </>\n  );\n};\n\nexport default observer(CategoriesCard);\n","import {\n  Button,\n  createStyles,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  InputLabel,\n  makeStyles,\n  MenuItem,\n  Select,\n  Theme,\n} from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { useContext, useEffect, useState } from 'react';\n\nimport { AggMap, GlobalPlotAttributeContext } from '../../contexts/CategoryContext';\nimport { useStore } from '../../stores/RootStore';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    formControl: {\n      margin: theme.spacing(1),\n      minWidth: 200,\n    },\n    selectEmpty: {\n      marginTop: theme.spacing(2),\n    },\n  }),\n);\n\ntype Props = {\n  open: boolean;\n  onClose: () => void;\n  onSet: () => void;\n};\n\nconst AggregateDialog = ({ open, onSet, onClose }: Props) => {\n  const styles = useStyles();\n  const {\n    exploreStore: { data },\n  } = useStore();\n\n  const {\n    setAggregateOptions = () => {\n      throw new Error('SOmething went wrong');\n    },\n  } = useContext(GlobalPlotAttributeContext) || {};\n\n  const [optionsMap, setOptionsMap] = useState<AggMap>({});\n\n  useEffect(() => {\n    if (!data) return;\n\n    if (Object.keys(optionsMap).length === 0) {\n      const { numericColumns } = data;\n      const opts: AggMap = {};\n\n      numericColumns.forEach((col) => {\n        opts[col] = 'Mean';\n      });\n\n      setOptionsMap(opts);\n    }\n  }, [optionsMap, data]);\n\n  const options = ['Mean', 'Median', 'Sum', 'Min', 'Max'];\n\n  if (!data) return <div>Loading...</div>;\n\n  const { numericColumns = [], columnInfo } = data;\n\n  const canSet = Object.keys(optionsMap).length === numericColumns.length;\n\n  return (\n    <Dialog open={open} onClose={onClose}>\n      <DialogTitle>Aggregate</DialogTitle>\n      <DialogContent>\n        <DialogContentText>Select how each numeric column should be aggregated.</DialogContentText>\n        {numericColumns.map((column) => {\n          return (\n            <div key={column}>\n              <FormControl className={styles.formControl}>\n                <InputLabel id={`${column}_label`}>{columnInfo[column].fullname}</InputLabel>\n                <Select\n                  id={column}\n                  labelId={`${column}_label`}\n                  value={optionsMap[column]}\n                  onChange={(ev) => {\n                    setOptionsMap(\n                      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                      (opt) => ({ ...opt, [column]: ev.target.value as string } as any),\n                    );\n                  }}\n                >\n                  {options.map((opt) => (\n                    <MenuItem key={opt} value={opt}>\n                      {opt}\n                    </MenuItem>\n                  ))}\n                </Select>\n                <FormHelperText>{columnInfo[column].unit}</FormHelperText>\n              </FormControl>\n            </div>\n          );\n        })}\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose}>Cancel</Button>\n        <Button\n          disabled={!canSet}\n          onClick={() => {\n            localStorage.setItem('aggOpt', JSON.stringify(optionsMap));\n            setAggregateOptions(optionsMap);\n            onClose();\n            onSet();\n          }}\n        >\n          Set\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default observer(AggregateDialog);\n","import { Box, Button, IconButton, InputAdornment, TextField } from '@material-ui/core';\nimport CheckIcon from '@material-ui/icons/Check';\nimport VisibilityIcon from '@material-ui/icons/Visibility';\nimport VisibilityOffIcon from '@material-ui/icons/VisibilityOff';\nimport { observer } from 'mobx-react';\nimport { useContext, useState } from 'react';\n\nimport { GlobalPlotAttributeContext } from '../../contexts/CategoryContext';\nimport { useStore } from '../../stores/RootStore';\nimport { getSelections } from '../../stores/ViewState';\n\nimport AggregateDialog from './AggregateDialog';\n\nconst AggregationPanel = () => {\n  const {\n    exploreStore: { state, handleAggregate, hideAggregateMembers, toggleHideAggregateMembers },\n  } = useStore();\n\n  const [showAggregateDialog, setShowAggregateDialog] = useState(false);\n\n  const { aggregateOptions } = useContext(GlobalPlotAttributeContext) || {};\n\n  const isSelectionEmpty = getSelections(state).length === 0;\n\n  const [aggLabel, setAggLabel] = useState('');\n  const [showAggLabel, setShowAggLabel] = useState(false);\n\n  return (\n    <Box m={1}>\n      <Button\n        color=\"primary\"\n        variant=\"outlined\"\n        onClick={() => {\n          if (aggregateOptions === null) {\n            setShowAggregateDialog(true);\n          } else {\n            setShowAggLabel(!showAggLabel);\n          }\n        }}\n      >\n        Aggregate\n      </Button>\n      <IconButton size=\"medium\" onClick={() => toggleHideAggregateMembers()}>\n        {hideAggregateMembers ? <VisibilityOffIcon /> : <VisibilityIcon />}\n      </IconButton>\n      <AggregateDialog\n        open={showAggregateDialog}\n        onClose={() => setShowAggregateDialog(false)}\n        onSet={() => {\n          setShowAggLabel(true);\n        }}\n      />\n      {showAggLabel && (\n        <TextField\n          InputProps={{\n            endAdornment: (\n              <InputAdornment position=\"end\">\n                <IconButton\n                  color=\"primary\"\n                  disabled={aggLabel.length === 0 || isSelectionEmpty}\n                  size=\"small\"\n                  onClick={() => {\n                    if (aggregateOptions) {\n                      handleAggregate(aggLabel, aggregateOptions);\n                      setAggLabel('');\n                      setShowAggLabel(false);\n                    }\n                  }}\n                >\n                  <CheckIcon />\n                </IconButton>\n              </InputAdornment>\n            ),\n          }}\n          value={aggLabel}\n          onChange={(e) => setAggLabel(e.target.value)}\n        />\n      )}\n    </Box>\n  );\n};\n\nexport default observer(AggregationPanel);\n","import { Box, Button, IconButton, InputAdornment, Switch, TextField } from '@material-ui/core';\nimport CheckIcon from '@material-ui/icons/Check';\nimport { observer } from 'mobx-react';\nimport { useContext, useState } from 'react';\n\nimport { GlobalPlotAttributeContext } from '../../contexts/CategoryContext';\nimport { CUSTOM_LABEL } from '../../stores/ExploreStore';\nimport { useStore } from '../../stores/RootStore';\nimport { getSelections } from '../../stores/ViewState';\nimport translate from '../../utils/transform';\n\nconst Labels = () => {\n  const {\n    exploreStore: {\n      showLabelLayer,\n      toggleLabelLayer,\n      handleLabelling,\n      state,\n      setHighlightMode,\n      setHighlightPredicate,\n    },\n  } = useStore();\n\n  const { labelMap = {} } = useContext(GlobalPlotAttributeContext) || {};\n\n  const [label, setLabel] = useState('');\n  const [showLabel, setShowLabel] = useState(false);\n\n  const isSelectionEmpty = getSelections(state).length === 0;\n\n  return (\n    <Box m={1}>\n      <Button\n        color=\"primary\"\n        variant=\"outlined\"\n        onClick={() => {\n          if (!showLabel) toggleLabelLayer(true);\n          setShowLabel(!showLabel);\n          setLabel('');\n        }}\n      >\n        Label\n      </Button>\n      <Switch\n        checked={showLabelLayer}\n        color=\"primary\"\n        size=\"small\"\n        onChange={() => toggleLabelLayer()}\n      />\n      {showLabel && (\n        <TextField\n          InputProps={{\n            endAdornment: (\n              <InputAdornment position=\"end\">\n                <IconButton\n                  color=\"primary\"\n                  disabled={label.length === 0 || isSelectionEmpty}\n                  size=\"small\"\n                  onClick={() => {\n                    handleLabelling(label);\n                    setLabel('');\n                    setShowLabel(false);\n                  }}\n                >\n                  <CheckIcon />\n                </IconButton>\n              </InputAdornment>\n            ),\n          }}\n          value={label}\n          onChange={(e) => setLabel(e.target.value)}\n        />\n      )}\n      <div>\n        {showLabelLayer &&\n          Object.entries(labelMap).map(([label, color]) => {\n            return (\n              <div key={label}>\n                <Button\n                  startIcon={\n                    <svg key={label} height=\"25\" viewBox=\"0 0 25 25\" width=\"25\">\n                      <circle className={color} r=\"5\" transform={translate(12.5)} />\n                    </svg>\n                  }\n                  disableFocusRipple\n                  disableRipple\n                  onMouseEnter={() => {\n                    setHighlightMode(true);\n                    setHighlightPredicate((p) => (p[CUSTOM_LABEL] || []).includes(label));\n                  }}\n                  onMouseLeave={() => {\n                    setHighlightMode(false);\n                    setHighlightPredicate(null);\n                  }}\n                >\n                  {label}\n                </Button>\n              </div>\n            );\n          })}\n      </div>\n    </Box>\n  );\n};\n\nexport default observer(Labels);\n","import {\n  Box,\n  Button,\n  Card,\n  CardContent,\n  CardHeader,\n  createStyles,\n  makeStyles,\n  Menu,\n  MenuItem,\n} from '@material-ui/core';\nimport ArrowRightIcon from '@material-ui/icons/ArrowRight';\nimport { observer } from 'mobx-react';\nimport { useState } from 'react';\n\nimport { useStore } from '../../stores/RootStore';\n\nimport AggregationPanel from './AggregationPanel';\nimport Labels from './Labels';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      minWidth: 250,\n    },\n    content: {\n      display: 'flex',\n      justifyContent: 'center',\n    },\n  }),\n);\n\nconst Transformations = () => {\n  const styles = useStyles();\n\n  const {\n    exploreStore: { handleFilter },\n  } = useStore();\n\n  const [filterAnchorEl, setFilterAnchorEl] = useState<null | HTMLElement>(null);\n\n  type AnchorType = typeof filterAnchorEl;\n  type SetterType = typeof setFilterAnchorEl;\n\n  const handleToggle = (setter: SetterType, target: AnchorType) => {\n    setter(target);\n  };\n\n  const handleClose = (setter: SetterType) => setter(null);\n\n  return (\n    <Card className={styles.root}>\n      <CardHeader title=\"Transforms\" />\n      <CardContent>\n        <Box m={1}>\n          <Button\n            color=\"primary\"\n            endIcon={<ArrowRightIcon />}\n            variant=\"outlined\"\n            onClick={(e) => handleToggle(setFilterAnchorEl, e.currentTarget)}\n          >\n            Filter\n          </Button>\n          <Menu\n            anchorEl={filterAnchorEl}\n            anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\n            open={Boolean(filterAnchorEl)}\n            keepMounted\n            onClose={() => handleClose(setFilterAnchorEl)}\n          >\n            <MenuItem\n              onClick={() => {\n                handleFilter('In');\n                handleClose(setFilterAnchorEl);\n              }}\n            >\n              In\n            </MenuItem>\n            <MenuItem\n              onClick={() => {\n                handleFilter('Out');\n                handleClose(setFilterAnchorEl);\n              }}\n            >\n              Out\n            </MenuItem>\n          </Menu>\n        </Box>\n\n        <Labels />\n        <AggregationPanel />\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default observer(Transformations);\n","import { createStyles, makeStyles, Theme } from '@material-ui/core';\nimport clsx from 'clsx';\nimport { observer } from 'mobx-react';\nimport { FC } from 'react';\n\nimport BrushSelector from './BrushSelector';\nimport CategoriesCard from './CategoriesCard';\nimport Transformations from './Transformations';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      display: 'flex',\n      flexFlow: 'column',\n      gap: theme.spacing(1),\n      padding: theme.spacing(2),\n    },\n  }),\n);\n\ntype Props = {\n  classes?: string | string[];\n};\n\nconst SidePanel: FC<Props> = ({ classes = [] }) => {\n  const styles = useStyles();\n\n  return (\n    <div className={clsx(classes, styles.root)}>\n      <BrushSelector />\n      <Transformations />\n      <CategoriesCard />\n    </div>\n  );\n};\n\nexport default observer(SidePanel);\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport {\n  Button,\n  Chip,\n  createStyles,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  FormControl,\n  InputLabel,\n  makeStyles,\n  MenuItem,\n  Select,\n  Theme,\n} from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport { useStore } from '../stores/RootStore';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    formControl: {\n      margin: theme.spacing(1),\n      minWidth: 200,\n    },\n    selectEmpty: {\n      marginTop: theme.spacing(2),\n    },\n  }),\n);\n\ntype Props = {\n  show: boolean;\n  onClose: () => void;\n};\n\nconst AddPCPDialog = ({ show, onClose }: Props) => {\n  const styles = useStyles();\n\n  const {\n    exploreStore: { data, addPCP },\n  } = useStore();\n\n  const [_dimensions, setDimensions] = useState<string[]>([]);\n\n  const dimensions = useMemo(() => {\n    return [...new Set(_dimensions)];\n  }, [_dimensions]);\n\n  const handleClose = useCallback(() => {\n    setDimensions([]);\n    onClose();\n  }, [onClose]);\n\n  if (!data) return <div>Test</div>;\n\n  return (\n    <Dialog open={show} onClose={handleClose}>\n      <DialogContent>\n        <DialogContentText>Select dimensions</DialogContentText>\n        <div>\n          {dimensions.map((d) => (\n            <Chip\n              key={d}\n              label={d}\n              onClick={() => {\n                setDimensions((dim) => dim.filter((di) => d !== di));\n              }}\n            />\n          ))}\n        </div>\n        <FormControl className={styles.formControl}>\n          <InputLabel id=\"x-col-label\">Dimensions</InputLabel>\n          <Select\n            id=\"x-col\"\n            labelId=\"x-col-label\"\n            value={[]}\n            multiple\n            onChange={(ev: any) => {\n              const d = ev.target.value;\n\n              if (dimensions.includes(d)) return;\n\n              setDimensions((dims) => {\n                const d = ev.target.value;\n\n                return [d, ...dims];\n              });\n            }}\n          >\n            {data.numericColumns.map((opt) => (\n              <MenuItem key={opt} disabled={dimensions.includes(opt)} value={opt}>\n                {opt}\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClose}>Cancel</Button>\n        <Button\n          onClick={() => {\n            if (dimensions.length > 0) {\n              addPCP(dimensions);\n            }\n            handleClose();\n          }}\n        >\n          Add\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default observer(AddPCPDialog);\n","import {\n  createStyles,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  FormControl,\n  InputLabel,\n  makeStyles,\n  MenuItem,\n  Select,\n  Theme,\n} from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { useCallback, useState } from 'react';\nimport { Button } from 'semantic-ui-react';\n\nimport { useStore } from '../stores/RootStore';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    formControl: {\n      margin: theme.spacing(1),\n      minWidth: 200,\n    },\n    selectEmpty: {\n      marginTop: theme.spacing(2),\n    },\n  }),\n);\ntype Props = {\n  show: boolean;\n  onClose: () => void;\n};\n\nconst AddScatterplotDialog = ({ show, onClose }: Props) => {\n  const styles = useStyles();\n\n  const {\n    exploreStore: { data, addScatterplot },\n  } = useStore();\n\n  const [x, setX] = useState('');\n  const [y, setY] = useState('');\n\n  const handleClose = useCallback(() => {\n    setX('');\n    setY('');\n    onClose();\n  }, [onClose]);\n\n  if (!data) return <div>Test</div>;\n\n  return (\n    <Dialog open={show} onClose={handleClose}>\n      <DialogContent>\n        <DialogContentText>Select dimensions</DialogContentText>\n\n        <FormControl className={styles.formControl}>\n          <InputLabel id=\"x-col-label\">X</InputLabel>\n          <Select\n            id=\"x-col\"\n            labelId=\"x-col-label\"\n            value={x}\n            onChange={(ev) => {\n              setX(ev.target.value as string);\n            }}\n          >\n            {data.numericColumns.map((opt) => (\n              <MenuItem key={opt} value={opt}>\n                {opt}\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n\n        <FormControl className={styles.formControl}>\n          <InputLabel id=\"y-col-label\">Y</InputLabel>\n          <Select\n            id=\"y-col\"\n            labelId=\"y-col-label\"\n            value={y}\n            onChange={(ev) => {\n              setY(ev.target.value as string);\n            }}\n          >\n            {data.numericColumns.map((opt) => (\n              <MenuItem key={opt} value={opt}>\n                {opt}\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClose}>Cancel</Button>\n        <Button\n          disabled={!x || !y}\n          onClick={() => {\n            addScatterplot(x, y);\n            handleClose();\n          }}\n        >\n          Add\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default observer(AddScatterplotDialog);\n","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { makeStyles } from '@material-ui/core';\nimport clsx from 'clsx';\nimport { quadtree, ScaleLinear, select } from 'd3';\nimport { observer } from 'mobx-react';\nimport { FC, useEffect, useMemo, useRef, useState } from 'react';\n\nimport translate from '../../utils/transform';\n\nexport type BrushSize = 20 | 35 | 50;\n\nconst useStyles = makeStyles(() => ({\n  brushStyle: {\n    cursor: 'grabbing',\n    stroke: 'gray',\n    opacity: 1,\n    transition: 'opacity 0.5s',\n  },\n  brushDownSelection: {\n    stroke: '#028A0F',\n  },\n  brushDownDeselection: {\n    stroke: 'rgb(244, 106, 15)',\n  },\n  brushHide: {\n    opacity: 0,\n    transition: 'opacity 0.5s',\n  },\n}));\n\nexport const union_color = '';\nexport type FreeformBrushEvent = 'Start' | 'Brushing' | 'End';\nexport type FreeformBrushAction = 'Selection' | 'Deselection';\n\ntype BrushHandler = (\n  points: string[],\n  event: FreeformBrushEvent,\n  action: FreeformBrushAction,\n) => void;\n\ntype BrushData = { x: number; y: number; id: string; [other: string]: unknown };\n\nfunction isInCircle(\n  center: { x: number; y: number },\n  radius: number,\n  point: { x: number; y: number },\n) {\n  const x_sq = Math.pow(point.x - center.x, 2);\n  const y_sq = Math.pow(point.y - center.y, 2);\n  const distance = Math.sqrt(x_sq + y_sq);\n\n  return distance <= radius;\n}\n\nfunction useQuadSearch(\n  searchArea: { left: number; top: number; width: number; height: number },\n  data: BrushData[],\n  xScale: ScaleLinear<number, number>,\n  yScale: ScaleLinear<number, number>,\n) {\n  const { left, top, width, height } = searchArea;\n  const quadTree = useMemo(() => {\n    const qt = quadtree<BrushData>()\n      .extent([\n        [left - 1, top - 1],\n        [width + 1, height + 1],\n      ])\n      .x((d) => xScale(d.x))\n      .y((d) => yScale(d.y))\n      .addAll(data);\n\n    return qt;\n  }, [left, top, width, height, data, xScale, yScale]);\n\n  const search = (x: number, y: number, radius: number) => {\n    const [x0, x3, y0, y3] = [x - radius, x + radius, y - radius, y + radius];\n    const selectedNodes: string[] = [];\n    // TODO: Figure out the types for this\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    quadTree.visit((node: any, x1, y1, x2, y2) => {\n      if (!node.length) {\n        let newNode = node;\n        do {\n          const {\n            data: d,\n            data: { x: cx, y: cy },\n          } = newNode;\n\n          const isSelected = isInCircle({ x, y }, radius, { x: xScale(cx), y: yScale(cy) });\n\n          if (isSelected) {\n            selectedNodes.push(d.id);\n          }\n        } while ((newNode = newNode.next));\n      }\n\n      return x1 >= x3 || y1 >= y3 || x2 < x0 || y2 < y0;\n    });\n\n    return selectedNodes;\n  };\n\n  return { search };\n}\n\ntype Props = {\n  left: number;\n  right: number;\n  top: number;\n  bottom: number;\n  extentPadding?: number;\n  xScale: ScaleLinear<number, number>;\n  yScale: ScaleLinear<number, number>;\n  onBrush: BrushHandler;\n  data: BrushData[];\n  brushSize?: BrushSize;\n};\n\nconst FreeFormBrush: FC<Props> = ({\n  left = 0,\n  right = 0,\n  top = 0,\n  bottom = 0,\n  extentPadding = 0,\n  onBrush,\n  xScale,\n  yScale,\n  brushSize = 35,\n  data = [],\n}: Props) => {\n  const { brushStyle, brushDownSelection, brushDownDeselection, brushHide } = useStyles();\n  const brushRef = useRef<SVGCircleElement>(null);\n  const layerRef = useRef<SVGRectElement>(null);\n  const selectedPointsRef = useRef<string[]>([]);\n\n  const radius = brushSize || 20;\n\n  const [mouseIn, setMouseIn] = useState(false);\n  const [mouseDown, setMouseDown] = useState(false);\n  const [clickMode, setClickMode] = useState(-1);\n\n  const mode: { [key: number]: FreeformBrushAction } = {\n    0: 'Selection',\n    2: 'Deselection',\n  };\n\n  const [height, width] = [\n    Math.abs(bottom + extentPadding - (top - extentPadding)),\n    Math.abs(left - extentPadding - (right + extentPadding)),\n  ];\n\n  const { search } = useQuadSearch({ left, top, width, height }, data, xScale, yScale);\n\n  function handleMouseDown(event: React.MouseEvent<SVGElement, MouseEvent>) {\n    const targetNode = layerRef.current;\n    setClickMode(event.button);\n    setMouseDown(true);\n\n    if (targetNode) {\n      const target = targetNode.getBoundingClientRect();\n      const [x, y] = [event.clientX - target.left, event.clientY - target.top];\n      const selectedPoints = search(x, y, radius);\n      selectedPointsRef.current = selectedPoints;\n      onBrush(selectedPoints, 'Start', mode[clickMode]);\n    }\n  }\n\n  function handleMouseUp() {\n    const targetNode = layerRef.current;\n\n    if (targetNode) {\n      onBrush(Array.from(new Set(selectedPointsRef.current)), 'End', mode[clickMode]);\n      selectedPointsRef.current = [];\n    }\n    setMouseDown(false);\n    setClickMode(-1);\n  }\n\n  function handleMove(event: MouseEvent) {\n    if (!mouseIn) return;\n    const node = brushRef.current;\n    const targetNode = layerRef.current;\n\n    if (node && targetNode) {\n      const target = targetNode.getBoundingClientRect();\n      const [x, y] = [event.clientX - target.left, event.clientY - target.top];\n\n      const nodeSelection = select(node);\n\n      const edgeX = x + radius >= width + 10 || x - radius <= -10;\n      const edgeY = y + radius >= height + 10 || y - radius <= -10;\n\n      if (!edgeX) nodeSelection.attr('cx', x);\n\n      if (!edgeY) nodeSelection.attr('cy', y);\n\n      if (mouseDown) {\n        const selectedPoints = search(x, y, radius);\n        selectedPointsRef.current.push(...selectedPoints);\n        onBrush(selectedPoints, 'Brushing', mode[clickMode]);\n      }\n    }\n  }\n\n  function addEvent() {\n    window.addEventListener('mousemove', handleMove);\n    window.addEventListener('mouseup', handleMouseUp);\n  }\n\n  function removeEvent() {\n    window.removeEventListener('mousemove', handleMove);\n    window.removeEventListener('mouseup', handleMouseUp);\n  }\n\n  useEffect(() => {\n    addEvent();\n\n    return removeEvent;\n  });\n\n  return (\n    <g\n      transform={translate(-extentPadding, -extentPadding)}\n      onContextMenu={(e) => e.preventDefault()}\n      onMouseDown={handleMouseDown}\n      onMouseEnter={() => setMouseIn(true)}\n      onMouseLeave={() => {\n        if (!mouseDown) setMouseIn(false);\n      }}\n    >\n      <rect ref={layerRef} fill=\"none\" height={height} pointerEvents=\"all\" width={width} />\n      <circle\n        ref={brushRef}\n        className={clsx(brushStyle, {\n          [brushDownSelection]: mouseDown && clickMode === 0,\n          [brushDownDeselection]: mouseDown && clickMode === 2,\n          [brushHide]: !mouseIn,\n        })}\n        fill=\"none\"\n        pointerEvents={mouseDown ? 'all' : 'initial'}\n        r={radius}\n        strokeWidth=\"2\"\n      />\n    </g>\n  );\n};\n\nexport default observer(FreeFormBrush);\n","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { createStyles, makeStyles } from '@material-ui/core';\nimport { ScaleLinear } from 'd3';\nimport { observer } from 'mobx-react';\nimport { useMemo } from 'react';\n\nimport translate from '../../utils/transform';\n\ntype AxisType = 'left' | 'right' | 'top' | 'bottom';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    shadow: {\n      textShadow: '0 0 5px white',\n    },\n  }),\n);\n\ntype Props = {\n  scale: ScaleLinear<number, number>;\n  transform?: string;\n  type: AxisType;\n  label: string | JSX.Element;\n  margin: number;\n  showLabel?: boolean;\n  tickFormatter?: (value: number) => string | number;\n};\n\nconst defaultTickFormatter = (d: number) => {\n  if (d >= 1000000) return `${d.toString()[0]}e${d.toString().length - 1}`;\n\n  if (d >= 500000) return `${(d as number) / 100000}M`;\n\n  if (d >= 1000) return `${(d as number) / 1000}K`;\n\n  return d;\n};\n\nconst Axis = ({\n  transform = '',\n  label,\n  type,\n  scale,\n  margin,\n  showLabel = true,\n  tickFormatter = defaultTickFormatter,\n}: Props) => {\n  const styles = useStyles();\n  const tickLength = 6;\n  const pixelsPerTick = 50;\n  const fontSize = 1;\n  const tickFontHeight = fontSize * 14 * 1.2;\n  const labelFontSize = 15;\n\n  const { ticks, extent } = useMemo(() => {\n    const range = scale.range();\n\n    const width = Math.abs(range[1] - range[0]);\n\n    const numberOfTicksTarget = Math.max(1, Math.floor(width / pixelsPerTick));\n\n    return {\n      ticks: scale\n        .ticks(numberOfTicksTarget)\n        .map((value) => ({ value, formattedValue: tickFormatter(value), offset: scale(value) })),\n      extent: width,\n    };\n  }, [scale, tickFormatter, pixelsPerTick]);\n\n  const labelTransform = (type: AxisType) => {\n    switch (type) {\n      case 'bottom':\n        return translate(Math.max(...scale.range()) / 2, margin - 3);\n      case 'top':\n        return translate(Math.max(...scale.range()) / 2, -(margin - 3));\n      case 'left':\n        return `${translate(-(margin - 3), Math.max(...scale.range()) / 2)}rotate(270)`;\n      case 'right':\n        return `${translate(margin - 3, Math.max(...scale.range()) / 2)}rotate(90)`;\n    }\n  };\n\n  const labelAnchor = (type: AxisType) => {\n    switch (type) {\n      case 'bottom':\n        return 'auto';\n      case 'left':\n        return 'hanging';\n      case 'top':\n        return 'hanging';\n      case 'right':\n        return 'hanging';\n    }\n  };\n\n  const path = (type: AxisType) => {\n    switch (type) {\n      case 'bottom':\n        return `M 0 ${tickLength} v -${tickLength} H ${extent} v ${tickLength}`;\n      case 'left':\n        return `M -${tickLength} 0 h ${tickLength} V ${extent} h -${tickLength}`;\n      case 'top':\n        return `M 0 -${tickLength} v ${tickLength} H ${extent} v -${tickLength}`;\n      case 'right':\n        return `M ${tickLength} 0 h -${tickLength} V ${extent} h ${tickLength}`;\n    }\n  };\n\n  const tickTransform = (type: AxisType, offset: number) => {\n    switch (type) {\n      case 'bottom':\n        return translate(offset, 0);\n      case 'left':\n        return translate(0, offset);\n      case 'top':\n        return translate(offset, 0);\n      case 'right':\n        return translate(0, offset);\n    }\n  };\n\n  const TickLine = ({ type, value }: { type: AxisType; value: string | number }) => {\n    switch (type) {\n      case 'bottom':\n        return (\n          <>\n            <text\n              dominantBaseline=\"middle\"\n              fill=\"none\"\n              fontSize={`${fontSize}rem`}\n              stroke=\"white\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"4\"\n              textAnchor=\"end\"\n              transform={translate(0, tickLength + tickFontHeight / 1.5)}\n            >\n              {value}\n            </text>\n            <line stroke=\"currentColor\" y2={tickLength} />\n            <text\n              className={styles.shadow}\n              dominantBaseline=\"middle\"\n              fontSize={`${fontSize}rem`}\n              textAnchor=\"middle\"\n              transform={translate(0, tickLength + tickFontHeight / 1.5)}\n            >\n              {value}\n            </text>\n          </>\n        );\n      case 'left':\n        return (\n          <>\n            <text\n              dominantBaseline=\"middle\"\n              fill=\"none\"\n              fontSize={`${fontSize}rem`}\n              stroke=\"white\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"4\"\n              textAnchor=\"end\"\n              transform={translate(-10, 0)}\n            >\n              {value}\n            </text>\n            <line stroke=\"currentColor\" transform={translate(-tickLength, 0)} x1={tickLength} />\n            <text\n              className={styles.shadow}\n              dominantBaseline=\"middle\"\n              fontSize={`${fontSize}rem`}\n              textAnchor=\"end\"\n              transform={translate(-10, 0)}\n            >\n              {value}\n            </text>\n          </>\n        );\n      case 'top':\n        return (\n          <>\n            <text\n              dominantBaseline=\"middle\"\n              fill=\"none\"\n              fontSize={`${fontSize}rem`}\n              stroke=\"white\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"4\"\n              textAnchor=\"end\"\n              transform={translate(0, -(tickLength + tickFontHeight / 1.5))}\n            >\n              {value}\n            </text>\n            <line stroke=\"currentColor\" transform={translate(0, -tickLength)} y2={tickLength} />\n            <text\n              className={styles.shadow}\n              dominantBaseline=\"middle\"\n              fontSize={`${fontSize}rem`}\n              textAnchor=\"middle\"\n              transform={translate(0, -(tickLength + tickFontHeight / 1.5))}\n            >\n              {value}\n            </text>\n          </>\n        );\n      case 'right':\n        return (\n          <>\n            <text\n              dominantBaseline=\"middle\"\n              fill=\"none\"\n              fontSize={`${fontSize}rem`}\n              stroke=\"white\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"4\"\n              textAnchor=\"end\"\n              transform={translate(10, 0)}\n            >\n              {value}\n            </text>\n            <line stroke=\"currentColor\" x1={tickLength} />\n            <text\n              className={styles.shadow}\n              dominantBaseline=\"middle\"\n              fontSize={`${fontSize}rem`}\n              textAnchor=\"start\"\n              transform={translate(10, 0)}\n            >\n              {value}\n            </text>\n          </>\n        );\n    }\n  };\n\n  return (\n    <g transform={transform}>\n      <path d={path(type)} fill=\"none\" stroke=\"currentColor\" />\n      {ticks.map(({ formattedValue, value, offset }) => (\n        <g key={value} transform={tickTransform(type, offset)}>\n          <TickLine type={type} value={formattedValue} />\n        </g>\n      ))}\n      {/* Axis Label */}\n      {showLabel && (\n        <text\n          dominantBaseline={labelAnchor(type)}\n          fontSize={labelFontSize}\n          textAnchor=\"middle\"\n          transform={labelTransform(type)}\n        >\n          {label}\n        </text>\n      )}\n    </g>\n  );\n};\n\nexport default observer(Axis);\n","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { createStyles, makeStyles, useTheme } from '@material-ui/core';\nimport clsx from 'clsx';\nimport { line, select } from 'd3';\nimport { observer } from 'mobx-react';\nimport { useCallback } from 'react';\n\nimport { BrushSizeMap } from '../../stores/ExploreStore';\nimport { useStore } from '../../stores/RootStore';\nimport { PCPView } from '../../stores/ViewState';\nimport translate from '../../utils/transform';\nimport FreeFormBrush, { FreeformBrushAction, FreeformBrushEvent } from '../Brushes/FreeFormBrush';\nimport Axis from '../Scatterplot/Axis';\nimport useScatterplotStyle from '../Scatterplot/styles';\n\nimport { usePCP } from './usePCP';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: (props: { height: number; width: number }) => ({\n      width: props.width,\n      height: props.height,\n    }),\n  }),\n);\n\ntype Props = {\n  size: number;\n  margin?: number;\n  view: PCPView;\n};\n\nconst PCP = ({ size, margin = 30, view }: Props) => {\n  const theme = useTheme();\n  const plotSize = size - 2 * theme.spacing(1) - 2;\n  const width = 900;\n  const height = plotSize;\n  const styles = useStyles({ height, width });\n  const plotWidth = width - 2 * margin;\n  const plotHeight = height - 2 * margin;\n  const { dimensions } = view;\n  const {\n    exploreStore: {\n      dataPoints,\n      rangeMap,\n      brushType,\n      data,\n      selectPointsFreeform,\n      state: { selections },\n    },\n  } = useStore();\n  const scatterplotStyles = useScatterplotStyle();\n\n  const groupWidth = 40;\n\n  const { attributeSpreadScale, attributeScales } = usePCP(\n    dataPoints,\n    dimensions,\n    plotHeight,\n    plotWidth,\n    groupWidth,\n    rangeMap,\n  );\n\n  const _freeformBrushHandler = useCallback(\n    (points: string[], event: FreeformBrushEvent, action: FreeformBrushAction) => {\n      if (points.length === 0) return;\n\n      const selectorString = points.map((p) => `#mark${p}`).join(',');\n\n      const isSelecting = action === 'Selection';\n\n      switch (event) {\n        case 'Start':\n        case 'Brushing':\n          select(`#${view.id}`)\n            .selectAll(selectorString)\n            .filter(function () {\n              return select(this).classed(\n                isSelecting ? scatterplotStyles.regularMark : scatterplotStyles.unionMark,\n              );\n            })\n            .classed(scatterplotStyles.intermittentHighlight, true);\n          break;\n        case 'End':\n          select(`#${view.id}`)\n            .selectAll('.marks')\n            .classed(scatterplotStyles.intermittentHighlight, false);\n          selectPointsFreeform(points, view);\n          break;\n      }\n    },\n    [scatterplotStyles, view, selectPointsFreeform],\n  );\n\n  if (!data) return <div>Loading</div>;\n\n  const { columnInfo } = data;\n\n  return (\n    <svg className={styles.root} id={view.id}>\n      <g transform={translate(margin)}>\n        {dataPoints.map((point) => {\n          const lineGen = line();\n          const data = dimensions.map((dim) => {\n            const x = attributeSpreadScale(dim) || 0;\n            const y = attributeScales[dim](point[dim]);\n\n            return [x, y] as [number, number];\n          });\n\n          return (\n            <path\n              key={point.id}\n              className={clsx('marks', {\n                [scatterplotStyles.regularLine]: !selections.includes(point.id),\n                [scatterplotStyles.unionLine]: selections.includes(point.id),\n              })}\n              d={lineGen(data) || ''}\n              fill=\"none\"\n              id={`mark${point.id}`}\n              strokeWidth=\"1\"\n            />\n          );\n        })}\n        {dimensions.map((dim) => {\n          const column = columnInfo[dim];\n\n          const points = dataPoints.map((point) => ({\n            id: point.id,\n            x: 0,\n            y: point[dim],\n          }));\n\n          return (\n            <g key={dim} transform={translate(attributeSpreadScale(dim) || 0, 0)}>\n              {brushType !== 'Rectangular' && brushType !== 'None' && (\n                <FreeFormBrush\n                  bottom={plotHeight}\n                  brushSize={BrushSizeMap[brushType]}\n                  data={points}\n                  left={0}\n                  right={groupWidth}\n                  top={0}\n                  xScale={((d: number) => d) as any}\n                  yScale={attributeScales[dim]}\n                  onBrush={_freeformBrushHandler}\n                />\n              )}\n              <Axis\n                label={dim}\n                margin={0}\n                scale={attributeScales[dim]}\n                showLabel={false}\n                type=\"left\"\n              />\n              <text textAnchor=\"middle\" transform={translate(0, plotHeight + 20)}>\n                <tspan>{column.fullname}</tspan>{' '}\n                {column.unit && <tspan fontStyle=\"italic\">({column.unit})</tspan>}\n              </text>\n              {dataPoints\n                .sort(\n                  (a, b) =>\n                    (selections.includes(a.id) ? 1 : 0) - (selections.includes(b.id) ? 1 : 0),\n                )\n                .map((d) => (\n                  <circle\n                    key={d.id}\n                    className={clsx('marks', {\n                      [scatterplotStyles.regularMark]: !selections.includes(d.id),\n                      [scatterplotStyles.unionMark]: selections.includes(d.id),\n                    })}\n                    cy={attributeScales[dim](d[dim])}\n                    id={`mark${d.id}`}\n                    opacity=\"0.5\"\n                    r=\"5\"\n                  />\n                ))}\n            </g>\n          );\n        })}\n      </g>\n    </svg>\n  );\n};\n\nexport default observer(PCP);\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { scaleLinear, ScaleLinear, scalePoint } from 'd3';\nimport { useMemo } from 'react';\n\nimport { DataPoint } from '../../stores/types/Dataset';\n\nexport function usePCP(\n  data: DataPoint[],\n  dimensions: string[],\n  height: number,\n  width: number,\n  groupWidth: number,\n  rangeMap: any,\n) {\n  const attributeSpreadScale = useMemo(() => {\n    const scale = scalePoint(dimensions, [0 + groupWidth / 2, width - groupWidth / 2]);\n\n    return scale;\n  }, [dimensions, width, groupWidth]);\n\n  const attributeScales = useMemo(() => {\n    const scales: { [attr: string]: ScaleLinear<number, number> } = {};\n\n    dimensions.forEach((dim) => {\n      if (!rangeMap[dim]) scales[dim] = scaleLinear();\n      else {\n        const { min, max } = rangeMap[dim];\n        const scale = scaleLinear().domain([min, max]).range([0, height]).clamp(true).nice();\n        scales[dim] = scale;\n      }\n    });\n\n    return scales;\n  }, [dimensions, rangeMap, height]);\n\n  return { data, dimensions, attributeSpreadScale, attributeScales };\n}\n","import { Box, Tooltip } from '@material-ui/core';\nimport clsx from 'clsx';\nimport { ScaleLinear, symbol, symbolCircle, symbolCross, symbolTriangle, SymbolType } from 'd3';\nimport { observer } from 'mobx-react';\nimport { useCallback, useMemo } from 'react';\n\nimport { HighlightPredicate } from '../../stores/ExploreStore';\nimport { useStore } from '../../stores/RootStore';\nimport translate from '../../utils/transform';\n\nimport { ScatterplotPoint } from './Scatterplot';\nimport useScatterplotStyle from './styles';\n\ntype Props = {\n  dataPoints: ScatterplotPoint[];\n  xScale: ScaleLinear<number, number>;\n  yScale: ScaleLinear<number, number>;\n  highlightMode?: boolean;\n  highlightPredicate?: HighlightPredicate | null;\n  type?: 'Regular' | 'Aggregate';\n};\n\nconst CompareMarks = ({\n  dataPoints,\n  xScale,\n  yScale,\n  type,\n  highlightMode,\n  highlightPredicate,\n}: Props) => {\n  const styles = useScatterplotStyle();\n\n  const {\n    exploreStore: {\n      changes: { added, removed, updated, updateMap, results },\n      // dataset_id, compareTarget\n    },\n  } = useStore();\n\n  const dp = useMemo(() => {\n    const dp: { [id: string]: ScatterplotPoint } = {};\n\n    dataPoints.forEach((point) => {\n      dp[point.iid] = point;\n    });\n\n    return dp;\n  }, [dataPoints]);\n\n  const changePoints = useMemo(() => {\n    const points: {\n      [id: string]: {\n        source: ScatterplotPoint;\n        target: ScatterplotPoint;\n      };\n    } = {};\n\n    updateMap.forEach(({ id, source, target }) => {\n      points[id] = {\n        source: dp[source],\n        target: dp[target],\n      };\n    });\n\n    return Object.values(points);\n  }, [dp, updateMap]);\n\n  const lines = changePoints.map(({ source, target }) => {\n    const cls = [styles.movedLine];\n\n    if (results.includes(source.id)) {\n      cls.push(styles.unionMark);\n    }\n\n    if (highlightMode && highlightPredicate) {\n      if (!highlightPredicate(source)) {\n        cls.push(styles.forceDullMark);\n      }\n    }\n\n    return (\n      <path\n        key={source.id}\n        className={clsx(cls)}\n        d={createComet(xScale(source.x), xScale(target.x), yScale(source.y), yScale(target.y))}\n      />\n    );\n  });\n\n  const mark = useCallback(\n    (point: ScatterplotPoint) => {\n      let sym: SymbolType = symbolCircle;\n      const cls = [];\n\n      let transform = translate(xScale(point.x), yScale(point.y));\n\n      if (results.includes(point.id)) {\n        cls.push(styles.unionMark);\n      }\n\n      if (added.includes(point.id)) {\n        cls.push(styles.newMark);\n        sym = symbolTriangle;\n      } else if (removed.includes(point.id)) {\n        cls.push(styles.removedMark);\n        sym = symbolCross;\n        transform = `${transform}rotate(45)`;\n      } else if (updated.includes(point.id)) {\n        cls.push(styles.movedPoint);\n      } else {\n        cls.push(styles.dullMark);\n      }\n\n      if (highlightMode && highlightPredicate) {\n        if (!highlightPredicate(point)) {\n          cls.push(styles.forceDullMark);\n        }\n      }\n\n      return (\n        <path\n          className={clsx(cls)}\n          d={\n            symbol()\n              .type(sym)\n              .size(type === 'Regular' ? 80 : 100)() || ''\n          }\n          id={`mark${point.id}`}\n          transform={transform}\n        />\n      );\n    },\n    [\n      added,\n      removed,\n      styles,\n      results,\n      type,\n      xScale,\n      yScale,\n      updated,\n      highlightMode,\n      highlightPredicate,\n    ],\n  );\n\n  return (\n    <>\n      {lines}\n      {dataPoints.map((point) => {\n        return (\n          // <Tooltip key={point.id} title={point.tooltip ? point.tooltip : point.label}>\n          <Tooltip\n            key={point.iid}\n            title={\n              type === 'Regular' ? (\n                <Box>\n                  <pre>{JSON.stringify(point, null, 2)}</pre>\n                </Box>\n              ) : (\n                ''\n              )\n            }\n          >\n            {mark(point)}\n          </Tooltip>\n        );\n      })}\n    </>\n  );\n};\n\nexport default observer(CompareMarks);\n\nexport function createComet(x1: number, x2: number, y1: number, y2: number): string {\n  const theta = Math.atan((x1 - x2) / (y1 - y2));\n\n  const xLength = 4.5 * Math.cos(theta);\n  const yLength = 4.5 * Math.sin(theta);\n\n  return `M ${x2 + xLength} ${y2 - yLength} \n  L ${x1} ${y1} \n  L ${x2 - xLength} ${y2 + yLength}\n  z`;\n}\n","import { scaleLinear, ScaleLinear } from 'd3';\nimport { useMemo } from 'react';\n\nexport default function useScale(\n  domain: [number, number],\n  range: [number, number],\n  nice = true,\n): ScaleLinear<number, number> {\n  const scale = useMemo(() => {\n    const scale = scaleLinear().domain(domain).range(range).clamp(true);\n\n    if (nice) scale.nice();\n\n    return scale;\n  }, [domain, range, nice]);\n\n  return scale;\n}\n","import { createStyles, makeStyles } from '@material-ui/core';\nimport clsx from 'clsx';\nimport { FC, useEffect, useState } from 'react';\n\nimport translate from '../../../../utils/transform';\n\nimport { ResizeDirection } from './BrushComponent';\n\ntype Props = {\n  id: string;\n  x: number;\n  y: number;\n  height: number;\n  width: number;\n  onMouseDown: (event: React.MouseEvent<SVGRectElement, MouseEvent>, id: string) => void;\n  onResizeStart: (brushId: string, direction: ResizeDirection) => void;\n  closeHandler: (id: string) => void;\n  resizeHandlerSize?: number;\n};\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    base: {\n      fill: 'green',\n      opacity: 0.1,\n      stroke: 'black',\n      strokeWidth: 2,\n      cursor: 'move',\n      '&:hover': {\n        strokeWidth: 5,\n      },\n    },\n    closeIconText: {\n      fontWeight: 'bolder',\n      fontFamily: 'FontAwesome',\n      fontSize: '1.5rem',\n      fill: 'red',\n    },\n    closeIconBackground: {\n      cursor: 'pointer',\n      fill: '#777',\n      opacity: '0.1',\n    },\n    resizeBase: {\n      pointerEvents: 'all',\n      fill: 'none',\n      stroke: 'none',\n    },\n    ns: {\n      cursor: 'ns-resize',\n    },\n    ew: {\n      cursor: 'ew-resize',\n    },\n    nwse: {\n      cursor: 'nwse-resize',\n    },\n    nesw: {\n      cursor: 'nesw-resize',\n    },\n  }),\n);\n\nconst RectBrush: FC<Props> = ({\n  id,\n  x,\n  y,\n  height,\n  width,\n  onMouseDown,\n  onResizeStart,\n  closeHandler,\n  resizeHandlerSize = 10,\n}: Props) => {\n  const [showIcon, setShowIcon] = useState(false);\n  const [timeoutId, setTimeoutId] = useState(-1);\n\n  const { base, resizeBase, ns, ew, nwse, nesw, closeIconText, closeIconBackground } = useStyles();\n\n  useEffect(() => {\n    return () => clearInterval(timeoutId);\n  });\n\n  const baseRectangle = (\n    <rect\n      className={base}\n      height={height}\n      width={width}\n      onMouseDown={(event: React.MouseEvent<SVGRectElement, MouseEvent>) => {\n        onMouseDown(event, id);\n      }}\n      onMouseEnter={() => {\n        clearInterval(timeoutId);\n        setShowIcon(true);\n      }}\n      onMouseLeave={() => {\n        const tout = setTimeout(() => {\n          setShowIcon(false);\n        }, 900);\n\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        setTimeoutId(tout as any);\n      }}\n    />\n  );\n\n  const northRect = (\n    <rect\n      className={clsx(resizeBase, ns)}\n      height={resizeHandlerSize}\n      width={width - resizeHandlerSize}\n      x={resizeHandlerSize / 2}\n      y={-resizeHandlerSize / 2}\n      onMouseDown={() => onResizeStart(id, 'N')}\n    />\n  );\n\n  const southRect = (\n    <rect\n      className={clsx(resizeBase, ns)}\n      height={resizeHandlerSize}\n      width={width - resizeHandlerSize}\n      x={resizeHandlerSize / 2}\n      y={height - resizeHandlerSize / 2}\n      onMouseDown={() => onResizeStart(id, 'S')}\n    />\n  );\n\n  const westRect = (\n    <rect\n      className={clsx(resizeBase, ew)}\n      height={height - resizeHandlerSize}\n      width={resizeHandlerSize}\n      x={-resizeHandlerSize / 2}\n      y={resizeHandlerSize / 2}\n      onMouseDown={() => onResizeStart(id, 'W')}\n    />\n  );\n\n  const eastRect = (\n    <rect\n      className={clsx(resizeBase, ew)}\n      height={height - resizeHandlerSize}\n      width={resizeHandlerSize}\n      x={width - resizeHandlerSize / 2}\n      y={resizeHandlerSize / 2}\n      onMouseDown={() => onResizeStart(id, 'E')}\n    />\n  );\n\n  const nwRect = (\n    <rect\n      className={clsx(resizeBase, nwse)}\n      height={resizeHandlerSize}\n      width={resizeHandlerSize}\n      x={-resizeHandlerSize / 2}\n      y={-resizeHandlerSize / 2}\n      onMouseDown={() => onResizeStart(id, 'NW')}\n    />\n  );\n  const neRect = (\n    <rect\n      className={clsx(resizeBase, nesw)}\n      height={resizeHandlerSize}\n      width={resizeHandlerSize}\n      x={width - resizeHandlerSize / 2}\n      y={-resizeHandlerSize / 2}\n      onMouseDown={() => onResizeStart(id, 'NE')}\n    />\n  );\n\n  const swRect = (\n    <rect\n      className={clsx(resizeBase, nesw)}\n      height={resizeHandlerSize}\n      width={resizeHandlerSize}\n      x={-resizeHandlerSize / 2}\n      y={height - resizeHandlerSize / 2}\n      onMouseDown={() => onResizeStart(id, 'SW')}\n    />\n  );\n  const seRect = (\n    <rect\n      className={clsx(resizeBase, nwse)}\n      height={resizeHandlerSize}\n      width={resizeHandlerSize}\n      x={width - resizeHandlerSize / 2}\n      y={height - resizeHandlerSize / 2}\n      onMouseDown={() => onResizeStart(id, 'SE')}\n    />\n  );\n\n  return (\n    <g transform={translate(x, y)}>\n      {baseRectangle}\n      {northRect}\n      {southRect}\n      {westRect}\n      {eastRect}\n      {nwRect}\n      {neRect}\n      {swRect}\n      {seRect}\n      <g display={showIcon ? 'visible' : 'none'} transform={translate(width, -10)}>\n        <text className={closeIconText} dominantBaseline=\"middle\" dy=\"1\" textAnchor=\"middle\">\n          &#xf05e;\n        </text>\n        <circle\n          className={closeIconBackground}\n          fill=\"none\"\n          r=\"10\"\n          stroke=\"black\"\n          onClick={() => closeHandler(id)}\n        />\n      </g>\n    </g>\n  );\n};\n\nexport default RectBrush;\n","import { quadtree, ScaleLinear } from 'd3';\nimport { FC, useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { getBrushId } from '../../../../utils/IDGens';\nimport { Brush, BrushAffectType, BrushCollection } from '../Types/Brush';\n\nimport RectBrush from './RectBrush';\n\nexport type BrushSelections = { [key: string]: string[] };\n\ntype Extents = {\n  x1: number;\n  x2: number;\n  y1: number;\n  y2: number;\n};\n\nexport type BrushHandler = (\n  points: BrushSelections,\n  brushes: BrushCollection,\n  type: BrushAffectType,\n  affectedId: string,\n) => void;\n\nexport type ResizeDirection = 'N' | 'S' | 'E' | 'W' | 'NW' | 'NE' | 'SW' | 'SE';\n\ntype BrushData = { x: number; y: number; id: string; [other: string]: unknown };\n\ntype Rectangle = [[number, number], [number, number]];\n\nconst X = 0;\nconst Y = 1;\nconst TOP_LEFT = 0;\nconst BOTTOM_RIGHT = 1;\n\nfunction rectIntersects(rect1: Rectangle, rect2: Rectangle) {\n  return (\n    rect1[TOP_LEFT][X] <= rect2[BOTTOM_RIGHT][X] &&\n    rect2[TOP_LEFT][X] <= rect1[BOTTOM_RIGHT][X] &&\n    rect1[TOP_LEFT][Y] <= rect2[BOTTOM_RIGHT][Y] &&\n    rect2[TOP_LEFT][Y] <= rect1[BOTTOM_RIGHT][Y]\n  );\n}\n\nfunction rectContains(rect: Rectangle, point: [number, number]) {\n  return (\n    rect[TOP_LEFT][X] <= point[X] &&\n    point[X] <= rect[BOTTOM_RIGHT][X] &&\n    rect[TOP_LEFT][Y] <= point[Y] &&\n    point[Y] <= rect[BOTTOM_RIGHT][Y]\n  );\n}\n\nfunction useQuadSearch(\n  searchArea: { left: number; top: number; right: number; bottom: number },\n  data: BrushData[],\n  xScale: ScaleLinear<number, number>,\n  yScale: ScaleLinear<number, number>,\n) {\n  const { left, top, right, bottom } = searchArea;\n  const quadTree = useMemo(() => {\n    const qt = quadtree<BrushData>()\n      .extent([\n        [left - 1, top - 1],\n        [right + 1, bottom + 1],\n      ])\n      .x((d) => xScale(d.x))\n      .y((d) => yScale(d.y))\n      .addAll(data);\n\n    return qt;\n  }, [left, top, right, bottom, data, xScale, yScale]);\n\n  const search = (left: number, top: number, right: number, bottom: number) => {\n    const selectedNodes: string[] = [];\n\n    quadTree.visit((node, x1, y1, x2, y2) => {\n      const overlaps = rectIntersects(\n        [\n          [left, top],\n          [right, bottom],\n        ],\n        [\n          [x1, y1],\n          [x2, y2],\n        ],\n      );\n\n      if (!overlaps) return true;\n\n      if (!node.length) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        let newNode: any = node;\n        do {\n          const d = newNode.data;\n          const cx = xScale(d.x);\n          const cy = yScale(d.y);\n\n          if (\n            rectContains(\n              [\n                [left, top],\n                [right, bottom],\n              ],\n              [cx, cy],\n            )\n          ) {\n            selectedNodes.push(d.id);\n          }\n        } while ((newNode = newNode.next));\n      }\n\n      return false;\n    });\n\n    return selectedNodes;\n  };\n\n  return { search };\n}\n\ntype Props = {\n  left: number;\n  bottom: number;\n  top: number;\n  right: number;\n  xScale: ScaleLinear<number, number>;\n  yScale: ScaleLinear<number, number>;\n  data: BrushData[];\n  brushes: BrushCollection;\n  onBrushHandler: BrushHandler;\n  disableBrush?: boolean;\n};\n\nconst BrushComponent: FC<Props> = ({\n  left,\n  right,\n  top,\n  bottom,\n  brushes,\n  xScale,\n  yScale,\n  data,\n  onBrushHandler,\n  disableBrush = false,\n}: Props) => {\n  const overlayRef = useRef<SVGRectElement>(null);\n  const [mouseDownCreation, setMouseDownCreation] = useState(false);\n  const [mouseDownMove, setMouseDownMove] = useState(false);\n  const [mouseDownResize, setMouseDownResize] = useState(false);\n  const [resizeDirection, setResizeDirection] = useState<ResizeDirection | null>(null);\n  const [activeBrush, setActiveBrush] = useState<Brush | null>(null);\n  const [diff, setDiff] = useState<{ x: number; y: number } | null>(null);\n\n  const [height, width] = [Math.abs(top - bottom), Math.abs(left - right)];\n\n  const { pixelX, pixelY, extentToData, extentToPixel } = useMemo(() => {\n    // const yDomainMax = yScale.domain()[1];\n    const yScaleUpdated = yScale.copy().domain(yScale.domain()).range(yScale.range());\n\n    const pixelX = (x: number) => xScale(x);\n    const pixelY = (y: number) => yScaleUpdated(y);\n\n    const dataX = (x: number) => xScale.invert(x);\n    const dataY = (y: number) => yScaleUpdated.invert(y);\n\n    const extentToData = ({ x1, y1, x2, y2 }: Extents) => ({\n      x1: dataX(x1),\n      x2: dataX(x2),\n      y1: dataY(y1),\n      y2: dataY(y2),\n    });\n\n    const extentToPixel = ({ x1, x2, y1, y2 }: Extents) => ({\n      x1: pixelX(x1),\n      x2: pixelX(x2),\n      y1: pixelY(y1),\n      y2: pixelY(y2),\n    });\n\n    return { dataX, dataY, pixelX, pixelY, extentToPixel, extentToData };\n  }, [xScale, yScale]);\n\n  const { search } = useQuadSearch({ left, top, right, bottom }, data, xScale, yScale);\n\n  const onBrush = useCallback(\n    (brushes: BrushCollection, type: BrushAffectType, affectedId: string) => {\n      if (disableBrush) return;\n      const selections: BrushSelections = {};\n\n      Object.values(brushes).forEach((br) => {\n        const { x1, x2, y1, y2 } = br.extents;\n        const selected = search(pixelX(x1), pixelY(y2), pixelX(x2), pixelY(y1));\n        selections[br.id] = selected;\n      });\n\n      onBrushHandler(selections, brushes, type, affectedId);\n    },\n    [onBrushHandler, search, disableBrush, pixelX, pixelY],\n  );\n\n  // ##################################################################### //\n  // ############################## Removal ############################## //\n  // ##################################################################### //\n\n  const closeBrushHandler = useCallback(\n    (id: string) => {\n      const brush = brushes[id];\n\n      if (!brush) throw new Error('Brush does not exist');\n\n      delete brushes[id];\n\n      onBrush({ ...brushes }, 'Remove', id);\n    },\n    [brushes, onBrush],\n  );\n\n  // ##################################################################### //\n  // ############################## Creation ############################# //\n  // ##################################################################### //\n\n  const creationMouseDownHandler = useCallback(\n    (event: React.MouseEvent<SVGRectElement, MouseEvent>) => {\n      const dimensions = event.currentTarget.getBoundingClientRect();\n\n      const extents: Extents = extentToData({\n        x1: event.clientX - dimensions.left,\n        x2: event.clientX - dimensions.left,\n        y1: event.clientY - dimensions.top,\n        y2: event.clientY - dimensions.top,\n      });\n\n      const brush: Brush = {\n        id: getBrushId(),\n        extents,\n      };\n\n      setMouseDownCreation(true);\n      setActiveBrush(brush);\n      //\n    },\n    [extentToData],\n  );\n\n  const creationMouseMoveHandler = useCallback(\n    (event: MouseEvent) => {\n      const targetNode = overlayRef.current;\n\n      if (!targetNode || !activeBrush) return;\n\n      const { left, top } = targetNode.getBoundingClientRect();\n\n      const { x1, y2 } = extentToPixel(activeBrush.extents);\n\n      const x2 = event.clientX - left;\n      const y1 = event.clientY - top;\n\n      // if (x2 < 0) x2 = 0;\n\n      // if (x2 >= width) x2 = right;\n\n      // if (y2 < 0) y2 = 0;\n\n      // if (y2 >= height) y2 = bottom;\n      // right, bottom, height, width\n\n      activeBrush.extents = extentToData({ x1, x2, y1, y2 });\n\n      setActiveBrush({ ...activeBrush });\n      //\n    },\n    [activeBrush, extentToData, extentToPixel],\n  );\n\n  const creationMouseUpHandler = useCallback(() => {\n    if (!activeBrush) return;\n\n    let { x1, x2, y1, y2 } = activeBrush.extents;\n\n    const isNewBrushRedundant = Math.abs(x1 - x2) < 0.00001 || Math.abs(y1 - y2) < 0.00001;\n\n    if (!isNewBrushRedundant) {\n      if (x1 > x2) [x1, x2] = [x2, x1];\n\n      if (y1 > y2) [y1, y2] = [y2, y1];\n\n      activeBrush.extents = correctBrushExtents({ x1, x2, y1, y2 });\n\n      brushes[activeBrush.id] = activeBrush;\n\n      onBrush({ ...brushes }, 'Add', activeBrush.id);\n    }\n\n    setActiveBrush(null);\n    setMouseDownCreation(false);\n  }, [activeBrush, brushes, onBrush]);\n\n  // ##################################################################### //\n  // ################################ Move ############################### //\n  // ##################################################################### //\n\n  const moveMouseDownHandler = useCallback(\n    (event: React.MouseEvent<SVGRectElement, MouseEvent>, id: string) => {\n      const targetNode = overlayRef.current;\n\n      if (!targetNode || mouseDownCreation) return;\n\n      const brush = brushes[id];\n\n      if (!brush) throw new Error('Something went wrong! Brush does not exist.');\n\n      const { left, top } = targetNode.getBoundingClientRect();\n      const { x1: x, y2: y } = extentToPixel(brush.extents);\n\n      const [currX, currY] = [event.clientX - left, event.clientY - top];\n      const [diffX, diffY] = [Math.abs(currX - x), Math.abs(currY - y)];\n\n      setDiff({ x: diffX, y: diffY });\n      setActiveBrush(brush);\n      setMouseDownMove(true);\n    },\n    [brushes, mouseDownCreation, extentToPixel],\n  );\n\n  const moveMouseMoveHandler = useCallback(\n    (event: MouseEvent) => {\n      const targetNode = overlayRef.current;\n\n      if (!targetNode || !activeBrush || !diff) return;\n\n      let { x1, x2, y1, y2 } = extentToPixel(activeBrush.extents);\n      // [x1, x2, y1, y2] = [x1 * width, x2 * width, y1 * height, y2 * height];\n\n      const [brushHeight, brushWidth] = [Math.abs(y2 - y1), Math.abs(x2 - x1)];\n\n      const { x: diffX, y: diffY } = diff;\n\n      const { left, top } = targetNode.getBoundingClientRect();\n\n      let [newX, newY] = [event.clientX - left - diffX, event.clientY - top - diffY];\n\n      if (newX < 0) newX = 0;\n\n      if (newX + brushWidth > width) newX = width - brushWidth;\n\n      if (newY < 0) newY = 0;\n\n      if (newY + brushHeight > height) newY = height - brushHeight;\n\n      [x1, x2, y2, y1] = [newX, newX + brushWidth, newY, newY + brushHeight];\n\n      setActiveBrush({ ...activeBrush, extents: extentToData({ x1, x2, y1, y2 }) });\n    },\n    [activeBrush, diff, extentToPixel, extentToData, height, width],\n  );\n\n  const moveMouseUpHandler = useCallback(() => {\n    if (!activeBrush) return;\n\n    brushes[activeBrush.id] = activeBrush;\n\n    onBrush({ ...brushes }, 'Update', activeBrush.id);\n\n    setActiveBrush(null);\n    setMouseDownMove(false);\n  }, [activeBrush, brushes, onBrush]);\n\n  // ##################################################################### //\n  // ############################### Resize ############################## //\n  // ##################################################################### //\n\n  const resizeMouseDownHandler = useCallback(\n    (brushId: string, direction: ResizeDirection) => {\n      const brush = brushes[brushId];\n\n      if (!brush) throw new Error('Something went wrong! Brush does not exist.');\n\n      setActiveBrush(brush);\n      setMouseDownResize(true);\n      setResizeDirection(direction);\n    },\n    [brushes],\n  );\n\n  const resizeMouseMoveHandler = useCallback(\n    (event: MouseEvent) => {\n      const targetNode = overlayRef.current;\n\n      if (!targetNode || !activeBrush || !resizeDirection) return;\n\n      const { left, top } = targetNode.getBoundingClientRect();\n\n      let { x1, x2, y1, y2 } = extentToPixel(activeBrush.extents);\n\n      switch (resizeDirection) {\n        case 'N':\n          y2 = event.clientY - top;\n          break;\n        case 'S':\n          y1 = event.clientY - top;\n          break;\n        case 'W':\n          x1 = event.clientX - left;\n          break;\n        case 'E':\n          x2 = event.clientX - left;\n          break;\n        case 'NW':\n          x1 = event.clientX - left;\n          y2 = event.clientY - top;\n          break;\n        case 'NE':\n          y2 = event.clientY - top;\n          x2 = event.clientX - left;\n          break;\n        case 'SW':\n          x1 = event.clientX - left;\n          y1 = event.clientY - top;\n          break;\n        case 'SE':\n          y1 = event.clientY - top;\n          x2 = event.clientX - left;\n          break;\n        default:\n          throw new Error('Wrong Resize Direction');\n      }\n\n      activeBrush.extents = extentToData({ x1, x2, y1, y2 });\n\n      setActiveBrush({ ...activeBrush });\n    },\n    [activeBrush, resizeDirection, extentToPixel, extentToData],\n  );\n\n  const resizeMouseUpHandler = useCallback(() => {\n    if (!activeBrush) return;\n\n    activeBrush.extents = correctBrushExtents(activeBrush.extents);\n\n    brushes[activeBrush.id] = activeBrush;\n\n    onBrush({ ...brushes }, 'Update', activeBrush.id);\n    setActiveBrush(null);\n    setResizeDirection(null);\n    setMouseDownResize(false);\n  }, [activeBrush, brushes, onBrush]);\n\n  // ##################################################################### //\n  // ############################## Effects ############################## //\n  // ##################################################################### //\n\n  useEffect(() => {\n    if (!mouseDownCreation && !mouseDownMove && !mouseDownResize) return;\n\n    if (mouseDownCreation) {\n      window.addEventListener('mousemove', creationMouseMoveHandler);\n      window.addEventListener('mouseup', creationMouseUpHandler);\n    }\n\n    if (mouseDownMove) {\n      window.addEventListener('mousemove', moveMouseMoveHandler);\n      window.addEventListener('mouseup', moveMouseUpHandler);\n    }\n\n    if (mouseDownResize) {\n      window.addEventListener('mousemove', resizeMouseMoveHandler);\n      window.addEventListener('mouseup', resizeMouseUpHandler);\n    }\n\n    return () => {\n      if (mouseDownCreation) {\n        window.removeEventListener('mousemove', creationMouseMoveHandler);\n        window.removeEventListener('mouseup', creationMouseUpHandler);\n      }\n\n      if (mouseDownMove) {\n        window.removeEventListener('mousemove', moveMouseMoveHandler);\n        window.removeEventListener('mouseup', moveMouseUpHandler);\n      }\n\n      if (mouseDownResize) {\n        window.removeEventListener('mousemove', resizeMouseMoveHandler);\n        window.removeEventListener('mouseup', resizeMouseUpHandler);\n      }\n    };\n  }, [\n    mouseDownCreation,\n    creationMouseMoveHandler,\n    creationMouseUpHandler,\n    mouseDownMove,\n    moveMouseMoveHandler,\n    moveMouseUpHandler,\n    mouseDownResize,\n    resizeMouseUpHandler,\n    resizeMouseMoveHandler,\n  ]);\n\n  // ##################################################################### //\n  // ############################## Elements ############################# //\n  // ##################################################################### //\n\n  const renderActiveBrush = useCallback(() => {\n    if (!activeBrush) return <g />;\n\n    const { x1, x2, y1, y2 } = correctBrushExtents(extentToPixel(activeBrush.extents));\n\n    return (\n      <RectBrush\n        closeHandler={closeBrushHandler}\n        height={y2 - y1}\n        id={activeBrush.id}\n        width={x2 - x1}\n        x={x1}\n        y={y1}\n        onMouseDown={moveMouseDownHandler}\n        onResizeStart={resizeMouseDownHandler}\n      />\n    );\n  }, [activeBrush, moveMouseDownHandler, resizeMouseDownHandler, closeBrushHandler, extentToPixel]);\n\n  const overlay = (\n    <rect\n      ref={overlayRef}\n      cursor={disableBrush ? 'default' : 'crosshair'}\n      fill=\"none\"\n      height={height}\n      pointerEvents={disableBrush ? 'none' : 'all'}\n      width={width}\n      onMouseDown={creationMouseDownHandler}\n    />\n  );\n\n  let brushList = Object.values(brushes);\n\n  if (activeBrush) brushList = brushList.filter((b) => b.id !== activeBrush.id);\n\n  const renderedBrushes = (\n    <g>\n      {renderActiveBrush()}\n      {Object.values(brushList).map((brush) => {\n        const { x1, x2, y1, y2 } = extentToPixel(brush.extents);\n\n        return (\n          <RectBrush\n            key={brush.id}\n            closeHandler={closeBrushHandler}\n            height={y1 - y2}\n            id={brush.id}\n            width={x2 - x1}\n            x={x1}\n            y={y2}\n            onMouseDown={moveMouseDownHandler}\n            onResizeStart={resizeMouseDownHandler}\n          />\n        );\n      })}\n    </g>\n  );\n\n  const [bottomLayer, topLayer] = mouseDownCreation\n    ? [renderedBrushes, overlay]\n    : [overlay, renderedBrushes];\n\n  return (\n    <g id=\"brush-component\">\n      {bottomLayer}\n      {topLayer}\n    </g>\n  );\n};\n\nexport default BrushComponent;\n\nfunction correctBrushExtents(input: { x1: number; x2: number; y1: number; y2: number }) {\n  let { x1, x2, y1, y2 } = input;\n\n  if (x2 < x1) {\n    [x1, x2] = [x2, x1];\n  }\n\n  if (y2 < y1) {\n    [y1, y2] = [y2, y1];\n  }\n\n  return { x1, x2, y1, y2 };\n}\n","import { observer } from 'mobx-react';\nimport { FC } from 'react';\n\nimport { IPNS, ISNP, MATCHES } from '../../utils/ColorSpec';\nimport translate from '../../utils/transform';\n\ntype Props = {\n  offset?: number;\n};\n\nconst Legend: FC<Props> = ({ offset = 0 }: Props) => {\n  return (\n    <g transform={translate(offset, -10)}>\n      <g transform={translate(0, 20)}>\n        <circle fill={MATCHES} r=\"5\" />\n        <text dominantBaseline=\"middle\" dx=\"10\">\n          Matches\n        </text>\n      </g>\n      <g transform={translate(0, 40)}>\n        <circle fill={IPNS} r=\"5\" />\n        <text dominantBaseline=\"middle\" dx=\"10\">\n          Not Selected\n        </text>\n      </g>\n      <g transform={translate(0, 60)}>\n        <circle fill={ISNP} r=\"5\" />\n        <text dominantBaseline=\"middle\" dx=\"10\">\n          Not Predicted\n        </text>\n      </g>\n    </g>\n  );\n};\n\nexport default observer(Legend);\n","import { Box, Tooltip } from '@material-ui/core';\nimport clsx from 'clsx';\nimport { ScaleLinear, symbol, SymbolType } from 'd3';\nimport { observer } from 'mobx-react';\nimport { FC, useContext, useMemo } from 'react';\n\nimport { GlobalPlotAttributeContext } from '../../contexts/CategoryContext';\nimport { ColorPredicate, CUSTOM_LABEL, HighlightPredicate } from '../../stores/ExploreStore';\nimport { useStore } from '../../stores/RootStore';\nimport translate from '../../utils/transform';\nimport { BrushSelections } from '../Brushes/Rectangular Brush/Components/BrushComponent';\n\nimport { ScatterplotPoint } from './Scatterplot';\nimport useScatterplotStyle from './styles';\n\ntype Props = {\n  datapoints: ScatterplotPoint[];\n  xScale: ScaleLinear<number, number>;\n  yScale: ScaleLinear<number, number>;\n  freeformSelections: string[];\n  brushSelections: BrushSelections;\n  symbolMap: { [key: string]: SymbolType } | null;\n  highlightMode?: boolean;\n  highlightPredicate?: HighlightPredicate | null;\n  colorPredicate?: ColorPredicate | null;\n  type?: 'Regular' | 'Aggregate';\n};\n\nconst Marks: FC<Props> = ({\n  datapoints,\n  freeformSelections,\n  brushSelections,\n  xScale,\n  yScale,\n  symbolMap,\n  type = 'Regular',\n  highlightMode = false,\n  highlightPredicate = null,\n  colorPredicate = null,\n}) => {\n  const classes = useScatterplotStyle();\n\n  const {\n    exploreStore: { showLabelLayer, setHighlightMode, setHighlightPredicate, state },\n  } = useStore();\n\n  // Maybe get as prop\n  const { labelMap = {} } = useContext(GlobalPlotAttributeContext) || {};\n\n  // Hack behaviour to combine\n  const selectedPoints: string[] = useMemo(() => {\n    const sels: string[] = [...freeformSelections];\n\n    Object.values(brushSelections).forEach((s) => sels.push(...s));\n\n    return [...new Set(sels)];\n  }, [freeformSelections, brushSelections]);\n\n  const cls = (point: ScatterplotPoint, color = 'NA') => {\n    const cope = colorPredicate !== null ? colorPredicate(point) : '';\n\n    return clsx('marks', {\n      [classes.unionMark]: selectedPoints.includes(point.id),\n      [classes.regularMark]: !selectedPoints.includes(point.id),\n      [classes.dullMark]:\n        highlightMode && highlightPredicate !== null && !highlightPredicate(point),\n      [color]: color !== 'NA',\n      [cope]: colorPredicate !== null,\n    });\n  };\n\n  const mark = (point: ScatterplotPoint, color: string) => {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const fieldProps: any = {};\n\n    if (type === 'Aggregate') {\n      fieldProps['onMouseEnter'] = () => {\n        setHighlightMode(true);\n        setHighlightPredicate((p) => {\n          const { aggregates } = state;\n\n          const currAgg = aggregates[point.id];\n\n          const members = currAgg.values;\n\n          return members.includes(p.id);\n        });\n      };\n      fieldProps['onMouseLeave'] = () => {\n        setHighlightMode(false);\n        setHighlightPredicate(null);\n      };\n    }\n\n    return symbolMap ? (\n      <path\n        className={cls(point, color)}\n        d={symbol(symbolMap[point.category || '-']).size(type === 'Aggregate' ? 100 : 80)() || ''}\n        id={`mark${point.id}`}\n        opacity=\"0.5\"\n        transform={translate(xScale(point.x), yScale(point.y))}\n        {...fieldProps}\n      />\n    ) : (\n      <circle\n        className={cls(point, color)}\n        cx={xScale(point.x)}\n        cy={yScale(point.y)}\n        id={`mark${point.id}`}\n        opacity=\"0.5\"\n        r={type === 'Aggregate' ? 10 : 5}\n        {...fieldProps}\n      />\n    );\n  };\n\n  return (\n    <>\n      {datapoints.map((point) => {\n        const label = (point[CUSTOM_LABEL] || [])[0];\n\n        let color = 'NA';\n\n        if (showLabelLayer) color = labelMap[label];\n\n        return (\n          // <Tooltip key={point.id} title={point.tooltip ? point.tooltip : point.label}>\n          <Tooltip\n            key={point.id}\n            title={\n              type === 'Regular' ? (\n                <Box>\n                  <pre>{JSON.stringify(point, null, 2)}</pre>\n                  {/* {point.label} */}\n                </Box>\n              ) : (\n                ''\n              )\n            }\n          >\n            {mark(point, color)}\n          </Tooltip>\n        );\n      })}\n    </>\n  );\n};\n\nexport default observer(Marks);\n","import { makeStyles } from '@material-ui/core';\nimport clsx from 'clsx';\nimport { ScaleLinear } from 'd3';\nimport { observer } from 'mobx-react';\nimport { FC, Fragment, useMemo } from 'react';\n\nimport translate from '../../utils/transform';\n\nconst HatchPattern = () => {\n  return (\n    <defs>\n      <pattern\n        height=\"4\"\n        id=\"pattern\"\n        patternTransform=\"rotate(45)\"\n        patternUnits=\"userSpaceOnUse\"\n        width=\"4\"\n      >\n        <rect fill=\"black\" height=\"4\" opacity=\"0.5\" transform=\"translate(0,0)\" width=\"2\" />\n      </pattern>\n    </defs>\n  );\n};\n\ntype Props = {\n  info: any;\n  xScale: ScaleLinear<number, number>;\n  yScale: ScaleLinear<number, number>;\n};\n\nconst useStyles = makeStyles(() => ({\n  lineBase: {\n    strokeWidth: 2,\n    strokeOpacity: 0.3,\n  },\n  line: {\n    stroke: 'black',\n  },\n  hatch: {\n    strokeWidth: 5,\n    stroke: 'url(#pattern)',\n  },\n}));\n\nconst Skyline: FC<Props> = ({ info, xScale, yScale }: Props) => {\n  const classes = useStyles();\n  const { frontier } = info;\n\n  const [x_sense, y_sense] = info.sense;\n\n  const { scaled_frontier } = useMemo(() => {\n    const scaled_frontier: { x: number; y: number }[] = frontier.map((val: number[]) => ({\n      x: xScale(val[0]),\n      y: yScale(val[1]),\n    }));\n\n    return { scaled_frontier };\n  }, [xScale, yScale, frontier]);\n\n  const { x_lines, y_lines } = useMemo(() => {\n    let x_lines = <g />;\n    let y_lines = <g />;\n\n    x_lines = (\n      <g className=\"frontier-x\">\n        {[...scaled_frontier]\n          .sort((a, b) => (x_sense === 'max' ? a.x - b.x : b.x - a.x))\n          // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          .map((n, idx, arr) => {\n            const key = `${n.x}-${n.y}`;\n            let [x1, x2, y1, y2] = [0, 0, 0, 0];\n\n            if (idx === 0) {\n              x1 = x_sense === 'max' ? xScale.range()[0] : n.x;\n              x2 = x_sense === 'max' ? n.x : xScale.range()[1];\n              y1 = n.y;\n              y2 = n.y;\n            } else {\n              const p = arr[idx - 1];\n              x1 = p.x;\n              x2 = n.x;\n              y1 = n.y;\n              y2 = n.y;\n            }\n\n            return (\n              <Fragment key={key}>\n                <line\n                  className={clsx(classes.lineBase, classes.line)}\n                  x1={x1}\n                  x2={x2}\n                  y1={y1}\n                  y2={y2}\n                />\n                <line\n                  className={clsx(classes.lineBase, classes.hatch)}\n                  transform={translate(0, 5)}\n                  x1={x1}\n                  x2={x2}\n                  y1={y1}\n                  y2={y2}\n                />\n              </Fragment>\n            );\n          })}\n      </g>\n    );\n\n    y_lines = (\n      <g>\n        {[...scaled_frontier]\n          .sort((a, b) => (y_sense === 'max' ? a.y - b.y : b.y - a.y))\n          .map((n, idx, arr) => {\n            const key = `${n.x}-${n.y}`;\n\n            let [x1, x2, y1, y2] = [0, 0, 0, 0];\n\n            if (idx === arr.length - 1) {\n              x1 = n.x;\n              x2 = n.x;\n              y1 = y_sense === 'max' ? n.y : yScale.range()[1];\n              y2 = y_sense === 'max' ? yScale.range()[0] : n.y;\n            } else {\n              const p = arr[idx + 1];\n              x1 = n.x;\n              x2 = n.x;\n              y1 = n.y;\n              y2 = p.y;\n            }\n\n            return (\n              <Fragment key={key}>\n                <line\n                  className={clsx(classes.lineBase, classes.line)}\n                  x1={x1}\n                  x2={x2}\n                  y1={y1}\n                  y2={y2}\n                />\n                <line\n                  className={clsx(classes.lineBase, classes.hatch)}\n                  transform={translate(-5, 0)}\n                  x1={x1}\n                  x2={x2}\n                  y1={y1}\n                  y2={y2}\n                />\n              </Fragment>\n            );\n          })}\n      </g>\n    );\n\n    return { x_lines, y_lines };\n  }, [scaled_frontier, x_sense, y_sense, xScale, yScale, classes]);\n\n  return (\n    <g>\n      <HatchPattern />\n      {x_lines}\n      {y_lines}\n    </g>\n  );\n};\n\nexport default observer(Skyline);\n","import { line, ScaleLinear } from 'd3';\nimport { observer } from 'mobx-react';\n\nimport { useStore } from '../../stores/RootStore';\n\nimport SkylineOverlay from './SkylineOverlay';\n\ntype Props = {\n  xScale: ScaleLinear<number, number>;\n  yScale: ScaleLinear<number, number>;\n};\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst Overlay = ({ xScale, yScale }: Props) => {\n  const {\n    exploreStore: { hoveredPrediction, dataPoints },\n  } = useStore();\n\n  const lineGen = line()\n    .x((d) => xScale(d[0]))\n    .y((d) => yScale(d[1]));\n\n  if (hoveredPrediction) {\n    switch (hoveredPrediction.intent) {\n      case 'Cluster': {\n        const { hull = [] } = hoveredPrediction.info;\n\n        if (hull.length > 0) {\n          return (\n            <g>\n              <path d={`${lineGen(hull)} Z` || ''} fill=\"gray\" opacity=\"0.4\" stroke=\"black\" />\n            </g>\n          );\n        }\n\n        break;\n      }\n      case 'Multivariate Optimization': {\n        const { edges = [] } = hoveredPrediction.info;\n        const { dimensions } = hoveredPrediction;\n        const { sense } = hoveredPrediction.params;\n\n        const points = dataPoints\n          .filter((d) => edges.includes(d.id))\n          .map((d) => [d[dimensions[0]], d[dimensions[1]]]);\n\n        const info = {\n          sense,\n          frontier: points,\n        };\n\n        return <SkylineOverlay info={info} xScale={xScale} yScale={yScale} />;\n      }\n      default:\n        break;\n    }\n  }\n\n  return <></>;\n};\n\nexport default observer(Overlay);\n","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { createStyles, makeStyles, useTheme } from '@material-ui/core';\nimport { extent, select, SymbolType } from 'd3';\nimport { observer } from 'mobx-react';\nimport { useCallback, useMemo } from 'react';\n\nimport useScale from '../../hooks/useScale';\nimport { BrushSizeMap, BrushType } from '../../stores/ExploreStore';\nimport { useStore } from '../../stores/RootStore';\nimport { ScatterplotView } from '../../stores/ViewState';\nimport translate from '../../utils/transform';\nimport FreeFormBrush, { FreeformBrushAction, FreeformBrushEvent } from '../Brushes/FreeFormBrush';\nimport BrushComponent, {\n  BrushSelections,\n} from '../Brushes/Rectangular Brush/Components/BrushComponent';\nimport { BrushAffectType, BrushCollection } from '../Brushes/Rectangular Brush/Types/Brush';\n\nimport Axis from './Axis';\nimport CompareMarks from './CompareMarks';\nimport Legend from './Legend';\nimport Marks from './Marks';\nimport Overlay from './Overlay';\nimport useScatterplotStyle from './styles';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: (props: { dimension: number }) => ({\n      width: props.dimension,\n      height: props.dimension,\n    }),\n  }),\n);\n\nexport type ScatterplotPoint = {\n  id: string;\n  iid: string;\n  label: string;\n  x: number;\n  y: number;\n  category?: string;\n  tooltip?: string | JSX.Element;\n  customlabel?: string[];\n  customCategoryAssignment?: { [categoryName: string]: string };\n};\n\ntype Props = {\n  view: ScatterplotView;\n  points: ScatterplotPoint[];\n  aggregatePoints: ScatterplotPoint[];\n  size: number;\n  xAxisLabel: string | JSX.Element | ((x_col: string) => string | JSX.Element);\n  yAxisLabel: string | JSX.Element | ((y_col: string) => string | JSX.Element);\n  margin?: number;\n  brushType: BrushType;\n  showCategories: boolean;\n  categoryMap?: { [key: string]: SymbolType } | null;\n  _x_extents?: [number, number] | null;\n  _y_extents?: [number, number] | null;\n  freeformBrushHandler: (\n    points: string[],\n    spec: ScatterplotView,\n    action: FreeformBrushAction,\n  ) => void;\n  rectangularBrushHandler: (\n    spec: ScatterplotView,\n    brushes: BrushCollection,\n    type: BrushAffectType,\n    affectedBrushId: string,\n  ) => void;\n  selections: string[];\n};\n\nconst Scatterplot = ({\n  view,\n  size,\n  margin = 0,\n  xAxisLabel,\n  yAxisLabel,\n  brushType,\n  points,\n  freeformBrushHandler,\n  aggregatePoints,\n  showCategories,\n  categoryMap = null,\n  rectangularBrushHandler,\n  selections,\n  _x_extents = null,\n  _y_extents = null,\n}: Props) => {\n  // Calculate Dimensions\n  const theme = useTheme();\n  const plotSize = size - 2 * theme.spacing(1) - 2;\n  const dimension = plotSize - 2 * margin;\n  const styles = useStyles({ dimension: plotSize });\n  const scatterplotStyles = useScatterplotStyle();\n  // Dimensions Calculated\n\n  const {\n    exploreStore: {\n      highlightMode,\n      highlightPredicate,\n      colorPredicate,\n      showMatchesLegend,\n      compareMode,\n    },\n  } = useStore();\n\n  // Get Scales\n  const { x_extents, y_extents } = useMemo(() => {\n    if (_x_extents !== null && _y_extents !== null) {\n      return { x_extents: _x_extents, y_extents: _y_extents };\n    }\n\n    if (points.length === 0)\n      return { x_extents: [0, 0] as [number, number], y_extents: [0, 0] as [number, number] };\n    const x_extents = extent(points.map((d) => d.x)) as [number, number];\n    const y_extents = extent(points.map((d) => d.y)) as [number, number];\n\n    return { x_extents, y_extents };\n  }, [points, _x_extents, _y_extents]);\n\n  const xScale = useScale(x_extents, [0, dimension]);\n  const yScale = useScale(y_extents, [dimension, 0]);\n  // Scales Complete\n\n  // Freeform Brush\n  const _freeformBrushHandler = useCallback(\n    (affectedPoints: string[], event: FreeformBrushEvent, action: FreeformBrushAction) => {\n      if (affectedPoints.length === 0) return;\n      const selectorString = affectedPoints.map((p) => `#mark${p}`).join(',');\n\n      const isSelecting = action === 'Selection';\n\n      switch (event) {\n        case 'Start':\n        case 'Brushing':\n          select(`#${view.id}`)\n            .selectAll(selectorString)\n            .filter(function () {\n              return select(this).classed(\n                isSelecting ? scatterplotStyles.regularMark : scatterplotStyles.unionMark,\n              );\n            })\n            .classed(scatterplotStyles.intermittentHighlight, true);\n          break;\n        case 'End':\n          select(`#${view.id}`)\n            .selectAll('.marks')\n            .classed(scatterplotStyles.intermittentHighlight, false);\n          freeformBrushHandler(affectedPoints, view, action);\n          break;\n      }\n    },\n    [scatterplotStyles, freeformBrushHandler, view],\n  );\n  // Freeform Done\n\n  // Rectangular Brush\n  const _rectBrushHandler = useCallback(\n    (\n      _selections: BrushSelections,\n      brushes: BrushCollection,\n      type: BrushAffectType,\n      affectedId: string,\n    ) => {\n      rectangularBrushHandler(view, brushes, type, affectedId);\n    },\n    [rectangularBrushHandler, view],\n  );\n  // Rectangular Done\n\n  if (showCategories && !categoryMap) throw new Error('Categories not defined');\n\n  return (\n    <svg className={styles.root} id={view.id}>\n      <defs>\n        <clipPath id=\"clip\" width={dimension}>\n          <rect fill=\"none\" height={dimension} width={dimension} />\n        </clipPath>\n      </defs>\n      <g transform={translate(margin)}>\n        {showMatchesLegend && <Legend offset={dimension - 25} />}\n        <BrushComponent\n          bottom={dimension}\n          brushes={view.brushes}\n          data={points}\n          disableBrush={brushType !== 'Rectangular'}\n          left={0}\n          right={dimension}\n          top={0}\n          xScale={xScale}\n          yScale={yScale}\n          onBrushHandler={_rectBrushHandler}\n        />\n        {brushType !== 'Rectangular' && brushType !== 'None' && (\n          <FreeFormBrush\n            bottom={dimension}\n            brushSize={BrushSizeMap[brushType]}\n            data={points}\n            left={0}\n            right={dimension}\n            top={0}\n            xScale={xScale}\n            yScale={yScale}\n            onBrush={_freeformBrushHandler}\n          />\n        )}\n        <Axis\n          label={typeof xAxisLabel === 'function' ? xAxisLabel(view.x) : xAxisLabel}\n          margin={margin}\n          scale={xScale}\n          transform={translate(0, dimension)}\n          type=\"bottom\"\n        />\n        <Axis\n          label={typeof yAxisLabel === 'function' ? yAxisLabel(view.y) : yAxisLabel}\n          margin={margin}\n          scale={yScale}\n          transform={translate(0)}\n          type=\"left\"\n        />\n        <Marks\n          brushSelections={{}}\n          datapoints={aggregatePoints}\n          freeformSelections={[]}\n          highlightMode={highlightMode}\n          highlightPredicate={() => false}\n          symbolMap={null}\n          type=\"Aggregate\"\n          xScale={xScale}\n          yScale={yScale}\n        />\n        {compareMode ? (\n          <CompareMarks\n            dataPoints={points}\n            highlightMode={highlightMode}\n            highlightPredicate={highlightPredicate}\n            type=\"Regular\"\n            xScale={xScale}\n            yScale={yScale}\n          />\n        ) : (\n          <Marks\n            brushSelections={view.brushSelections}\n            colorPredicate={colorPredicate}\n            datapoints={points}\n            freeformSelections={selections}\n            highlightMode={highlightMode}\n            highlightPredicate={highlightPredicate}\n            symbolMap={showCategories ? categoryMap : null}\n            xScale={xScale}\n            yScale={yScale}\n          />\n        )}\n        <Overlay xScale={xScale} yScale={yScale} />\n      </g>\n    </svg>\n  );\n};\n\nexport default observer(Scatterplot);\n","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport {\n  Chip,\n  createStyles,\n  FormControlLabel,\n  IconButton,\n  makeStyles,\n  Paper,\n  Switch,\n  Theme,\n  useTheme,\n} from '@material-ui/core';\nimport AddIcon from '@material-ui/icons/Add';\nimport AspectRatioIcon from '@material-ui/icons/AspectRatio';\nimport CloseIcon from '@material-ui/icons/Close';\nimport { SpeedDial, SpeedDialAction, SpeedDialIcon } from '@material-ui/lab';\nimport { symbol, symbolCross, symbolTriangle } from 'd3';\nimport { observer } from 'mobx-react';\nimport { useCallback, useContext, useState } from 'react';\n\nimport { GlobalPlotAttributeContext } from '../contexts/CategoryContext';\nimport { CUSTOM_CATEGORY_ASSIGNMENT } from '../stores/ExploreStore';\nimport { useStore } from '../stores/RootStore';\nimport translate from '../utils/transform';\n\nimport AddPCPDialog from './AddPCPDialog';\nimport AddScatterplotDialog from './AddScatterplotDialog';\nimport PCP from './PCP/PCP';\nimport { createComet } from './Scatterplot/CompareMarks';\nimport Scatterplot, { ScatterplotPoint } from './Scatterplot/Scatterplot';\nimport useScatterplotStyle from './Scatterplot/styles';\nimport Symbol from './SidePanel/Symbol';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: () => ({\n      width: '100%',\n      height: '100%',\n      display: 'grid',\n      overflow: 'hidden',\n      gridTemplateRows: 'min-content min-content auto',\n      gridTemplateAreas: \"'version' 'compare' 'vis'\",\n    }),\n    chips: {\n      gridArea: 'version',\n      display: 'flex',\n      justifyContent: 'center',\n      flexWrap: 'wrap',\n      '& > *': {\n        margin: theme.spacing(0.5),\n      },\n    },\n    compare: {\n      gridArea: 'compare',\n      display: 'flex',\n      justifyContent: 'center',\n      flexDirection: 'row',\n    },\n    speedDial: {\n      position: 'absolute',\n      bottom: theme.spacing(2),\n      left: theme.spacing(2),\n    },\n    vis: {\n      gridArea: 'vis',\n      display: 'flex',\n      gap: theme.spacing(2),\n      flexFlow: 'column',\n      overlfow: 'auto',\n      justifyContent: 'center',\n      alignItems: 'center',\n    },\n    paperContainer: {\n      height: 'min-content',\n    },\n    paper: () => ({\n      position: 'relative',\n      display: 'flex',\n      justifyContent: 'center',\n      alignContent: 'center',\n      padding: theme.spacing(1),\n    }),\n    visContainer: { overflow: 'auto', padding: '1em' },\n    closeIcon: {\n      position: 'absolute',\n      left: 0,\n      top: 0,\n    },\n    sidePanel: {\n      gridArea: 'side',\n      minWidth: '200px',\n    },\n  }),\n);\n\nconst Visualization = () => {\n  const [open, setOpen] = useState(false);\n  const {\n    projectStore: { project, dataset_id, setDatasetId },\n    exploreStore: {\n      state: { scatterplots, freeformSelections, pcps },\n      selectPointsFreeform,\n      compareTarget,\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      changes: { updated, added, removed },\n      setCompareTarget,\n      brushType,\n      compareData,\n      showGlobalScale,\n      setShowGlobalScale,\n      dataPoints,\n      aggregateDataPoints,\n      unselectPointsFreeform,\n      setHighlightMode,\n      setHighlightPredicate,\n      compareMode,\n      switchCompareMode,\n      removeScatterplot,\n      handleBrushSelection,\n      data,\n      rangeMap,\n    },\n  } = useStore();\n  const theme = useTheme();\n\n  const n_plots = scatterplots.length + 1;\n\n  const spContainerDimension = 500;\n\n  const { showCategory = false, selectedCategoryColumn = null, categoryMap = {} } =\n    useContext(GlobalPlotAttributeContext) || {};\n\n  const [showDialog, setShowDialog] = useState(false);\n  const [showPCPDialog, setShowPCPDialog] = useState(false);\n  const spStyles = useScatterplotStyle();\n\n  const styles = useStyles({ dimension: spContainerDimension, showCategory });\n\n  const labelMaker = useCallback(\n    (col_name: string) => {\n      if (!data) return '';\n      const { columnInfo } = data;\n\n      const column = columnInfo[col_name];\n\n      return (\n        <>\n          <tspan fontWeight=\"bold\">{column.short}</tspan> <tspan>|</tspan>{' '}\n          <tspan>{column.fullname}</tspan>{' '}\n          {column.unit && <tspan fontStyle=\"italic\">({column.unit})</tspan>}\n        </>\n      );\n    },\n    [data],\n  );\n\n  if (!project) return <div>Something went wrong!</div>;\n\n  if (!data) return <div>Loading</div>;\n\n  const pcp = pcps.map((view) => {\n    return (\n      <div key={view.id} className={styles.paperContainer}>\n        <Paper className={styles.paper}>\n          <PCP size={spContainerDimension - 2 * theme.spacing(1)} view={view} />\n        </Paper>\n      </div>\n    );\n  });\n\n  const sps = scatterplots.map((view) => {\n    const { x, y } = view;\n\n    let points: ScatterplotPoint[] = [];\n    let aggregatePoints: ScatterplotPoint[] = [];\n\n    if (data) {\n      const dps = compareMode ? compareData.data : dataPoints;\n      const aggDps = compareMode ? [] : aggregateDataPoints;\n\n      aggregatePoints = aggDps.map((d) => {\n        let selectedCategory =\n          showCategory && selectedCategoryColumn ? (d[selectedCategoryColumn] as string) : '-';\n\n        if (d[CUSTOM_CATEGORY_ASSIGNMENT]) {\n          selectedCategory = d[CUSTOM_CATEGORY_ASSIGNMENT];\n        }\n\n        return {\n          x: d[x] as number,\n          y: d[y] as number,\n          label: d[data.labelColumn] as string,\n          category: selectedCategory,\n          ...d,\n        };\n      });\n\n      points = dps.map((d) => {\n        let selectedCategory =\n          showCategory && selectedCategoryColumn ? (d[selectedCategoryColumn] as string) : '-';\n\n        if (d[CUSTOM_CATEGORY_ASSIGNMENT]) {\n          selectedCategory = d[CUSTOM_CATEGORY_ASSIGNMENT];\n        }\n\n        return {\n          x: d[x] as number,\n          y: d[y] as number,\n          label: d[data.labelColumn] as string,\n          category: selectedCategory,\n          ...d,\n        };\n      });\n    }\n\n    const x_range = rangeMap[x];\n    const y_range = rangeMap[y];\n\n    return (\n      <div key={view.id} className={styles.paperContainer}>\n        <Paper className={styles.paper} elevation={3}>\n          {n_plots > 1 && (\n            <IconButton className={styles.closeIcon} onClick={() => removeScatterplot(view.id)}>\n              <CloseIcon />\n            </IconButton>\n          )}\n          <Scatterplot\n            _x_extents={[x_range.min, x_range.max]}\n            _y_extents={[y_range.min, y_range.max]}\n            aggregatePoints={aggregatePoints}\n            brushType={brushType}\n            categoryMap={categoryMap}\n            freeformBrushHandler={(points, view, action) => {\n              if (action === 'Selection') selectPointsFreeform(points, view);\n              else unselectPointsFreeform(points, view);\n            }}\n            margin={60}\n            points={points}\n            rectangularBrushHandler={handleBrushSelection}\n            selections={freeformSelections}\n            showCategories={showCategory}\n            size={spContainerDimension - 2 * theme.spacing(1)}\n            view={view}\n            xAxisLabel={labelMaker}\n            yAxisLabel={labelMaker}\n          />\n        </Paper>\n      </div>\n    );\n  });\n\n  return (\n    <>\n      <div className={styles.root}>\n        <div className={styles.chips}>\n          {project.datasets.map((d) => (\n            <Chip\n              key={d.id}\n              color={\n                dataset_id === d.id\n                  ? 'primary'\n                  : compareMode && compareTarget === d.id\n                  ? 'secondary'\n                  : 'default'\n              }\n              disabled={compareMode && d.id === dataset_id}\n              label={d.version}\n              onClick={() => {\n                if (compareMode) {\n                  setCompareTarget(d.id);\n                } else {\n                  setDatasetId(d.id);\n                }\n              }}\n            />\n          ))}\n          <FormControlLabel\n            control={<Switch onChange={() => switchCompareMode(!compareMode)} />}\n            label=\"Compare\"\n          />\n        </div>\n        <div className={styles.compare}>\n          {compareMode && (\n            <>\n              <Symbol\n                label=\"Added\"\n                path={symbol().type(symbolTriangle).size(100)() || ''}\n                onMouseEnter={() => {\n                  setHighlightMode(true);\n                  setHighlightPredicate((point) => {\n                    return added.includes(point.id);\n                  });\n                }}\n                onMouseLeave={() => {\n                  setHighlightMode(false);\n                  setHighlightPredicate(null);\n                }}\n              />\n              <Symbol\n                label=\"Removed\"\n                path={symbol().type(symbolCross).size(100)() || ''}\n                transform=\"rotate(45)\"\n                onMouseEnter={() => {\n                  setHighlightMode(true);\n                  setHighlightPredicate((point) => {\n                    return removed.includes(point.id);\n                  });\n                }}\n                onMouseLeave={() => {\n                  setHighlightMode(false);\n                  setHighlightPredicate(null);\n                }}\n              />\n              <Symbol\n                label=\"Updated\"\n                shape={\n                  <g transform={translate(5, 10)}>\n                    <path\n                      className={spStyles.movedLine}\n                      d={createComet(0, 15, 0, 0)}\n                      // fill=\"gray\"\n                      // opacity=\"0.8\"\n                    />\n                    <circle className={spStyles.movedPoint} r=\"4\" />\n                    <circle className={spStyles.movedPoint} r=\"4\" transform={translate(15, 0)} />\n                  </g>\n                }\n                width=\"40\"\n                onMouseEnter={() => {\n                  setHighlightMode(true);\n                  setHighlightPredicate((point) => {\n                    return updated.includes(point.id);\n                  });\n                }}\n                onMouseLeave={() => {\n                  setHighlightMode(false);\n                  setHighlightPredicate(null);\n                }}\n              />\n            </>\n          )}\n        </div>\n        <div className={styles.visContainer}>\n          <div className={styles.vis}>\n            {pcp}\n            {sps}\n          </div>\n        </div>\n      </div>\n      <SpeedDial\n        ariaLabel=\"SpeedDial example\"\n        className={styles.speedDial}\n        icon={<SpeedDialIcon />}\n        open={open}\n        onClose={() => setOpen(false)}\n        onOpen={() => setOpen(true)}\n      >\n        <SpeedDialAction\n          icon={<AddIcon />}\n          tooltipPlacement=\"right\"\n          tooltipTitle=\"Add Scatteplot\"\n          tooltipOpen\n          onClick={() => setShowDialog(true)}\n        />\n        <SpeedDialAction\n          icon={<AddIcon />}\n          tooltipPlacement=\"right\"\n          tooltipTitle=\"Add PCP\"\n          tooltipOpen\n          onClick={() => setShowPCPDialog(true)}\n        />\n        <SpeedDialAction\n          icon={<AspectRatioIcon />}\n          tooltipPlacement=\"right\"\n          tooltipTitle={showGlobalScale ? 'Fit' : 'Global'}\n          tooltipOpen\n          onClick={() => setShowGlobalScale(!showGlobalScale)}\n        />\n      </SpeedDial>\n      <AddScatterplotDialog show={showDialog} onClose={() => setShowDialog(false)} />\n      <AddPCPDialog show={showPCPDialog} onClose={() => setShowPCPDialog(false)} />\n    </>\n  );\n};\n\nexport default observer(Visualization);\n","import {\n  Button,\n  ButtonGroup,\n  Card,\n  CardContent,\n  CardHeader,\n  createStyles,\n  Divider,\n  makeStyles,\n  Theme,\n  Typography,\n} from '@material-ui/core';\nimport {\n  Timeline,\n  TimelineConnector,\n  TimelineContent,\n  TimelineDot,\n  TimelineItem,\n  TimelineSeparator,\n} from '@material-ui/lab';\nimport { observer } from 'mobx-react';\nimport { useMemo } from 'react';\nimport { useHistory } from 'react-router';\n\nimport { useStore } from '../stores/RootStore';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      minWidth: 400,\n      display: 'grid',\n      gridTemplateRows: 'min-content min-content 1fr',\n      overflow: 'auto',\n    },\n    center: {\n      margin: '0 auto',\n    },\n    list: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n      gap: 10,\n      padding: theme.spacing(1),\n    },\n    card: {\n      minWidth: 400,\n    },\n    margin: {\n      margin: theme.spacing(1),\n    },\n  }),\n);\nconst CustomWorkflowView = () => {\n  const styles = useStyles();\n  const {\n    exploreStore: { workflow },\n  } = useStore();\n  const history = useHistory();\n\n  const { customWorkflows = {}, setCurrentWorkflow } = workflow || {};\n\n  const workflows = useMemo(() => {\n    return Object.values(customWorkflows);\n  }, [customWorkflows]);\n\n  return (\n    <div className={styles.root}>\n      <div className={styles.center}>\n        <Typography variant=\"h4\">Workflows</Typography>\n      </div>\n      <div className={styles.list}>\n        {workflows.map((wf) => (\n          <Card key={wf.id} className={styles.card} raised>\n            <CardHeader\n              action={\n                <ButtonGroup>\n                  <Button\n                    onClick={() => {\n                      history.push({ pathname: '/explore', search: `?workflow=${wf.id}` });\n                    }}\n                  >\n                    Load\n                  </Button>\n                  <Button\n                    onClick={() => {\n                      if (setCurrentWorkflow) setCurrentWorkflow(wf.id);\n                    }}\n                  >\n                    Edit\n                  </Button>\n                </ButtonGroup>\n              }\n              title={wf.name}\n            />\n            <Divider />\n            <CardContent>\n              <Timeline align=\"alternate\">\n                {(wf.order || []).map((id, idx) => {\n                  const node = wf.graph.nodes[id];\n\n                  return (\n                    <TimelineItem key={node.id}>\n                      <TimelineSeparator>\n                        <TimelineDot color=\"primary\" />\n                        {idx !== wf.order.length - 1 && <TimelineConnector />}\n                      </TimelineSeparator>\n                      <TimelineContent>{node.label}</TimelineContent>\n                    </TimelineItem>\n                  );\n                })}\n              </Timeline>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default observer(CustomWorkflowView);\n","import {\n  Button,\n  createStyles,\n  IconButton,\n  Input,\n  makeStyles,\n  Theme,\n  Typography,\n} from '@material-ui/core';\nimport CheckIcon from '@material-ui/icons/Check';\nimport CloseButton from '@material-ui/icons/Close';\nimport SyncIcon from '@material-ui/icons/Sync';\nimport SyncDisabledIcon from '@material-ui/icons/SyncDisabled';\nimport {\n  Timeline,\n  TimelineConnector,\n  TimelineContent,\n  TimelineDot,\n  TimelineItem,\n  TimelineOppositeContent,\n  TimelineSeparator,\n} from '@material-ui/lab';\nimport { observer } from 'mobx-react';\nimport { useState } from 'react';\n\nimport { useStore } from '../stores/RootStore';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      minWidth: 450,\n      display: 'grid',\n      gridTemplateRows: 'min-content min-content 1fr',\n    },\n    add: {\n      margin: '0 auto',\n    },\n    margin: {\n      margin: theme.spacing(1),\n    },\n    icon: {\n      margin: theme.spacing(2),\n    },\n  }),\n);\n\nconst EditWorkflow = () => {\n  const styles = useStyles();\n  const {\n    exploreStore: { workflow },\n  } = useStore();\n  const [workflowName, setWorkflowName] = useState('');\n\n  if (!workflow) return <div>Error</div>;\n\n  const {\n    setCurrentWorkflow,\n    currentWorkflow,\n    setWorkflowName: swn,\n    removeFromWorkflow,\n    isSyncing,\n    toggleSync,\n  } = workflow;\n\n  const order = currentWorkflow?.order || [];\n\n  return (\n    <div className={styles.root}>\n      <div className={styles.add}>\n        {!currentWorkflow ? (\n          <Button\n            disabled={Boolean(currentWorkflow)}\n            onClick={() => {\n              setCurrentWorkflow();\n            }}\n          >\n            Create New Workflow\n          </Button>\n        ) : (\n          <div className={styles.margin}>\n            <Button\n              color=\"primary\"\n              disabled={!currentWorkflow.name}\n              variant=\"contained\"\n              onClick={toggleSync}\n            >\n              {isSyncing === 'Syncing' ? 'Stop' : 'Start'} Sync\n            </Button>\n            <IconButton disableFocusRipple disableRipple>\n              {isSyncing === 'Not Syncing' && <SyncDisabledIcon />}\n              {isSyncing === 'Syncing' && <SyncIcon />}\n            </IconButton>\n          </div>\n        )}\n      </div>\n      {currentWorkflow && currentWorkflow.name === '' && (\n        <div className={styles.add}>\n          <Input\n            placeholder=\"Workflow Name\"\n            value={workflowName}\n            onChange={(e) => setWorkflowName(e.target.value)}\n          />\n          <IconButton disabled={workflowName === ''} onClick={() => swn(workflowName)}>\n            <CheckIcon />\n          </IconButton>\n        </div>\n      )}\n      {currentWorkflow && currentWorkflow.name !== '' && (\n        <div className={styles.add}>\n          <Typography variant=\"button\">{currentWorkflow.name}</Typography>\n        </div>\n      )}\n      {currentWorkflow && currentWorkflow.graph && (\n        <div>\n          <Timeline>\n            {order.map((id, idx) => {\n              const node = currentWorkflow.graph?.nodes[id];\n\n              if (!node) return null;\n\n              return (\n                <TimelineItem key={node.id}>\n                  <TimelineOppositeContent>\n                    <IconButton\n                      color=\"secondary\"\n                      size=\"small\"\n                      onClick={() => removeFromWorkflow(node.id)}\n                    >\n                      <CloseButton />\n                    </IconButton>\n                  </TimelineOppositeContent>\n                  <TimelineSeparator>\n                    <TimelineDot color=\"primary\" />\n                    {idx !== order.length - 1 && <TimelineConnector />}\n                  </TimelineSeparator>\n                  <TimelineContent>{node.label}</TimelineContent>\n                </TimelineItem>\n              );\n            })}\n          </Timeline>\n        </div>\n      )}\n      {!currentWorkflow && (\n        <div className={styles.add}>\n          <Typography variant=\"button\">No custom workflow to edit</Typography>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default observer(EditWorkflow);\n","import { createStyles, makeStyles, Theme } from '@material-ui/core';\nimport { observer } from 'mobx-react';\n\nimport CustomWorkflowView from './CustomWorkflowView';\nimport EditWorkflow from './EditWorkflow';\nimport ProvenanceTree from './ProvenanceTree';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      minWidth: '500px',\n      display: 'grid',\n      gridTemplateColumns: 'min-content 1fr 1fr',\n      margin: theme.spacing(1),\n      overflow: 'hidden',\n    },\n  }),\n);\n\nconst WorkflowMenu = () => {\n  const styles = useStyles();\n\n  return (\n    <div className={styles.root}>\n      <div>\n        <ProvenanceTree />\n      </div>\n      <EditWorkflow />\n      <CustomWorkflowView />\n    </div>\n  );\n};\n\nexport default observer(WorkflowMenu);\n","import { useEffect, useState } from 'react';\nimport { useHistory, useLocation } from 'react-router-dom';\n\nfunction useWorkflowFromURL() {\n  const [workflow, setWorkflow] = useState<string | null>(null);\n\n  const location = useLocation();\n  const history = useHistory();\n  const search = new URLSearchParams(location.search);\n  const wf = search.get('workflow');\n\n  useEffect(() => {\n    const wf_to_set = wf ? wf : Date.now().toString();\n\n    if (workflow === wf_to_set) return;\n    setWorkflow(wf_to_set);\n\n    history.replace({\n      search: `?workflow=${wf_to_set}`,\n    });\n  }, [wf, workflow, history]);\n\n  return { history, location, workflowId: workflow };\n}\nexport default useWorkflowFromURL;\n","import { createStyles, Drawer, Fab, makeStyles, Theme } from '@material-ui/core';\nimport AccountTreeIcon from '@material-ui/icons/AccountTree';\nimport { schemeSet1, symbols, SymbolType } from 'd3';\nimport { observer } from 'mobx-react';\nimport { useEffect, useMemo, useState } from 'react';\n\nimport PredictionsTable from '../components/Predictions/PredictionsTable';\nimport ProvenanceTree from '../components/ProvenanceTree';\nimport SidePanel from '../components/SidePanel';\nimport Visualization from '../components/Visualization';\nimport WorkflowMenu from '../components/WorkflowMenu';\nimport { AggMap, GlobalPlotAttributeContext } from '../contexts/CategoryContext';\nimport useWorkflowFromURL from '../hooks/useWorflow';\nimport { useStore } from '../stores/RootStore';\n\nconst useStyles = makeStyles((theme: Theme) => {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const c: any = {};\n\n  schemeSet1.forEach((col) => {\n    c[col] = { fill: col };\n  });\n\n  return createStyles({\n    root: {\n      display: 'grid',\n      gridTemplateColumns: 'min-content 5fr 2fr 1fr',\n      height: '100vh',\n      width: '100vw',\n      overflow: 'hidden',\n    },\n    workflowButton: {\n      position: 'absolute',\n      right: theme.spacing(2),\n      bottom: theme.spacing(16),\n      'z-index': 100000,\n    },\n    subroot: {\n      overflow: 'hidden',\n    },\n    drawer: {\n      overflow: 'hidden',\n    },\n    ...c,\n  });\n});\n\nconst Explore = () => {\n  const styles = useStyles();\n  const {\n    projectStore: { dataset_id },\n    exploreStore: {\n      addScatterplot,\n      addPCP,\n      data,\n      workflow,\n      provenance,\n      loadWorkflow,\n      showCategories,\n      selectedCategoryColumn,\n      changeCategoryColumn,\n      state: { labels },\n    },\n  } = useStore();\n\n  const [hoveredCategory, setHoveredCategory] = useState<string | null>(null);\n  const [aggregateOptions, setAggregateOptions] = useState<AggMap | null>(null);\n  const [showWorkflowMenu, setShowWorkflowMenu] = useState(false);\n\n  const { workflowId } = useWorkflowFromURL();\n\n  const aggOpt = localStorage.getItem('aggOpt');\n\n  useEffect(() => {\n    if (!workflowId) return;\n\n    if (!workflow) {\n      loadWorkflow(workflowId);\n    } else if (workflow.id !== workflowId) {\n      loadWorkflow(workflowId);\n    }\n  }, [workflowId, loadWorkflow, workflow]);\n\n  useEffect(() => {\n    if (JSON.stringify(aggregateOptions) !== aggOpt) {\n      if (aggOpt) {\n        setAggregateOptions(JSON.parse(aggOpt));\n      }\n    }\n  }, [aggregateOptions, aggOpt]);\n\n  useEffect(() => {\n    if (!selectedCategoryColumn && data && data.categoricalColumns.length > 0) {\n      const col = localStorage.getItem('category-column');\n\n      changeCategoryColumn(\n        col && data.categoricalColumns.includes(col) ? col : data.categoricalColumns[0],\n      );\n    }\n  }, [selectedCategoryColumn, changeCategoryColumn, data]);\n\n  const categories = useMemo(() => {\n    return selectedCategoryColumn ? data?.columnInfo[selectedCategoryColumn]?.options || [] : [];\n  }, [data, selectedCategoryColumn]);\n\n  const labelMap = useMemo(() => {\n    const m: { [key: string]: string } = {};\n\n    Object.keys(labels).forEach((l, i) => {\n      m[l] = styles[schemeSet1[i]];\n    });\n\n    return m;\n  }, [labels, styles]);\n\n  const categoryMap = useMemo(() => {\n    if (categories.length > symbols.length - 1)\n      throw new Error(`Cannot support more categorical values than ${symbols.length - 1}`);\n\n    const catMap: { [key: string]: SymbolType } = {\n      Unassigned: symbols[0],\n    };\n\n    categories.forEach((d, i) => {\n      catMap[d] = symbols[i + 1];\n    });\n\n    return catMap;\n  }, [categories]);\n\n  useEffect(() => {\n    if (data !== null && provenance.current.label === 'Root') addScatterplot();\n    // if (data !== null && provenance.current.label === 'Root') addPCP();\n  }, [addScatterplot, data, provenance, addPCP]);\n\n  if (!dataset_id) {\n    if (workflowId) return <div>Loading</div>;\n\n    return <div>Please go to projects</div>;\n  }\n\n  return (\n    <>\n      <div className={styles.root}>\n        <GlobalPlotAttributeContext.Provider\n          value={{\n            showCategory: showCategories,\n            selectedCategoryColumn,\n            categoryMap,\n            labelMap,\n            hoveredCategory,\n            setHoveredCategory,\n            aggregateOptions,\n            setAggregateOptions,\n          }}\n        >\n          <SidePanel />\n          <div className={styles.subroot}>\n            <Visualization />\n          </div>\n          <PredictionsTable />\n          <div>\n            <ProvenanceTree />\n          </div>\n          {!showWorkflowMenu && (\n            <Fab className={styles.workflowButton} onClick={() => setShowWorkflowMenu(true)}>\n              <AccountTreeIcon />\n            </Fab>\n          )}\n          <Drawer\n            anchor=\"right\"\n            className={styles.drawer}\n            open={showWorkflowMenu}\n            onClose={() => setShowWorkflowMenu(false)}\n          >\n            <WorkflowMenu />\n          </Drawer>\n        </GlobalPlotAttributeContext.Provider>\n      </div>\n    </>\n  );\n};\n\nexport default observer(Explore);\n","import { createStyles, makeStyles } from '@material-ui/core';\nimport { DataGrid } from '@material-ui/data-grid';\nimport { observer } from 'mobx-react';\nimport { useMemo } from 'react';\n\nimport { useStore } from '../stores/RootStore';\nimport { Data } from '../stores/types/Dataset';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      height: '100vh',\n      width: '100%',\n      display: 'flex',\n      flexDirection: 'column',\n    },\n  }),\n);\n\nfunction useDataGrid(data: Data | null, headerHeight = 56) {\n  const { rows = [], columns = [] } = useMemo(() => {\n    if (!data) return { rows: [], columns: [] };\n\n    const { columnInfo, columns, values, labelColumn } = data;\n\n    const organizedColumns = [labelColumn, ...columns.filter((c) => c !== labelColumn)];\n\n    const cols = organizedColumns\n      .filter((col) => !['id', 'iid'].includes(col))\n      .map((col) => ({\n        field: col,\n        headerName: columnInfo[col].fullname,\n        description: columnInfo[col].unit || '',\n        flex: 1,\n      }));\n\n    return { rows: values, columns: cols };\n  }, [data]);\n\n  return { rows, columns, headerHeight };\n}\n\nconst DataView = () => {\n  const styles = useStyles();\n\n  const headerHeight = 56;\n\n  const {\n    projectStore: { data },\n  } = useStore();\n\n  const { rows, columns } = useDataGrid(data, headerHeight);\n\n  return (\n    <div className={styles.root}>\n      {rows.length > 0 && columns.length > 0 && (\n        <DataGrid columns={columns} headerHeight={56} rows={rows} autoPageSize pagination />\n      )}\n    </div>\n  );\n};\n\nexport default observer(DataView);\n","import {\n  createStyles,\n  Divider,\n  Drawer,\n  IconButton,\n  makeStyles,\n  Theme,\n  Typography,\n} from '@material-ui/core';\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport ArrowRightIcon from '@material-ui/icons/ArrowRight';\nimport DescriptionIcon from '@material-ui/icons/Description';\nimport FolderIcon from '@material-ui/icons/Folder';\nimport LaunchIcon from '@material-ui/icons/Launch';\nimport { TreeItem, TreeView } from '@material-ui/lab';\nimport { observer } from 'mobx-react';\nimport { useHistory } from 'react-router-dom';\n\nimport { useStore } from '../stores/RootStore';\nimport { Projects } from '../stores/types/Project';\n\nconst useStyles = (drawerWidth: number) => {\n  return makeStyles((theme: Theme) =>\n    createStyles({\n      root: {\n        display: 'flex',\n      },\n      appbar: {\n        width: `calc(100% - ${drawerWidth}px)`,\n        marginLeft: drawerWidth,\n      },\n      drawer: {\n        width: drawerWidth,\n        flexShrink: 0,\n      },\n      drawerPaper: {\n        width: drawerWidth,\n      },\n      // necessary for content to be below app bar\n      toolbar: {\n        ...theme.mixins.toolbar,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n      },\n    }),\n  )();\n};\n\ntype Props = {\n  projects: Projects;\n};\n\nconst Sidebar = ({ projects }: Props) => {\n  const drawerWidth = 240;\n  const styles = useStyles(drawerWidth);\n  const {\n    exploreStore: { changeCategoryColumn },\n    projectStore: { setCurrentProject, setDatasetId, project, dataset_id },\n  } = useStore();\n  const history = useHistory();\n\n  return (\n    <Drawer\n      className={styles.drawer}\n      classes={{\n        paper: styles.drawerPaper,\n      }}\n      variant=\"permanent\"\n    >\n      <div className={styles.toolbar}>\n        <Typography variant=\"h4\">Projects</Typography>\n      </div>\n      <Divider />\n      <TreeView\n        defaultCollapseIcon={<ArrowDropDownIcon />}\n        defaultEndIcon={<div style={{ width: 24 }} />}\n        defaultExpandIcon={<ArrowRightIcon />}\n        expanded={project ? [project.id.toString()] : []}\n        selected={dataset_id ? dataset_id : ''}\n      >\n        {projects.map((p) => {\n          return (\n            <StyledTreeItem\n              key={p.id}\n              labelIcon={FolderIcon}\n              labelText={p.name}\n              nodeId={p.id}\n              onClick={() => {\n                setCurrentProject(p.id);\n                changeCategoryColumn(null);\n              }}\n            >\n              {p.datasets.map((d) => {\n                return (\n                  <StyledTreeItem\n                    key={d.id}\n                    labelIcon={DescriptionIcon}\n                    labelText={d.version}\n                    launchHandler={() => {\n                      history.push('/explore');\n                    }}\n                    nodeId={d.id}\n                    showLaunch\n                    onClick={() => {\n                      setDatasetId(d.id);\n                    }}\n                  />\n                );\n              })}\n            </StyledTreeItem>\n          );\n        })}\n      </TreeView>\n    </Drawer>\n  );\n};\n\nexport default observer(Sidebar);\n\nconst useTreeItemStyles = makeStyles((theme: Theme) => ({\n  root: {\n    color: theme.palette.text.secondary,\n    '&:hover > $content': {\n      backgroundColor: theme.palette.action.hover,\n    },\n    '&:focus > $content, &$selected > $content': {\n      backgroundColor: `var(--tree-view-bg-color, ${theme.palette.grey[400]})`,\n      color: 'var(--tree-view-color)',\n    },\n    '&:focus > $content $label, &:hover > $content $label, &$selected > $content $label': {\n      backgroundColor: 'transparent',\n    },\n  },\n  content: {\n    color: theme.palette.text.secondary,\n    borderTopRightRadius: theme.spacing(2),\n    borderBottomRightRadius: theme.spacing(2),\n    paddingRight: theme.spacing(1),\n    fontWeight: theme.typography.fontWeightMedium,\n    '$expanded > &': {\n      fontWeight: theme.typography.fontWeightRegular,\n    },\n  },\n  group: {\n    marginLeft: 0,\n    '& $content': {\n      paddingLeft: theme.spacing(2),\n    },\n  },\n  expanded: {},\n  selected: {},\n  label: {\n    fontWeight: 'inherit',\n    color: 'inherit',\n  },\n  labelRoot: {\n    display: 'flex',\n    alignItems: 'center',\n    padding: theme.spacing(0.5, 0),\n  },\n  labelIcon: {\n    marginRight: theme.spacing(1),\n  },\n  labelText: {\n    fontWeight: 'inherit',\n    flexGrow: 1,\n  },\n}));\n\ntype StyledTreeItemProps = {\n  bgColor?: string;\n  color?: string;\n  labelInfo?: string;\n  labelText?: string;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  labelIcon: any;\n  nodeId: string;\n  showLaunch?: boolean;\n  launchHandler?: (event: React.MouseEvent) => void;\n  onClick?: () => void;\n  [key: string]: unknown;\n};\n\nfunction StyledTreeItem(props: StyledTreeItemProps) {\n  const classes = useTreeItemStyles();\n  const {\n    labelText,\n    labelIcon: LabelIcon,\n    labelInfo,\n    color,\n    bgColor,\n    nodeId,\n    onClick,\n    showLaunch = false,\n    launchHandler,\n    ...other\n  } = props;\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const style: any = {\n    '--tree-view-color': color,\n    '--tree-view-bg-color': bgColor,\n  };\n\n  return (\n    <TreeItem\n      classes={{\n        root: classes.root,\n        content: classes.content,\n        expanded: classes.expanded,\n        selected: classes.selected,\n        group: classes.group,\n        label: classes.label,\n      }}\n      label={\n        <div className={classes.labelRoot}>\n          <LabelIcon className={classes.labelIcon} color=\"inherit\" />\n          <Typography className={classes.labelText} variant=\"body2\">\n            {labelText}\n          </Typography>\n          <Typography color=\"inherit\" variant=\"caption\">\n            {labelInfo}\n          </Typography>\n          {showLaunch && (\n            <IconButton\n              size=\"small\"\n              onClick={(event) => {\n                if (launchHandler) launchHandler(event);\n              }}\n            >\n              <LaunchIcon />\n            </IconButton>\n          )}\n        </div>\n      }\n      nodeId={nodeId}\n      style={style}\n      onClick={onClick}\n      {...other}\n    />\n  );\n}\n","import { FC, memo, ReactNode } from 'react';\n\ntype Props = {\n  condition: boolean;\n  else?: ReactNode | (() => ReactNode);\n  children: ReactNode;\n};\n\nconst If: FC<Props> = ({ condition, children, else: elseComponent = null }) => {\n  if (!condition) {\n    if (typeof elseComponent === 'function') return elseComponent();\n\n    return elseComponent;\n  }\n\n  return <>{children}</>;\n};\n\nexport default memo(If);\n","/* eslint-disable react-hooks/exhaustive-deps */\nimport { createStyles, makeStyles } from '@material-ui/core';\nimport Axios from 'axios';\nimport { observer } from 'mobx-react';\nimport { useEffect } from 'react';\nimport { useQuery } from 'react-query';\n\nimport { PROJECT } from '..';\nimport DataView from '../components/DataView';\nimport Sidebar from '../components/Sidebar';\nimport If from '../components/utils/If';\nimport { useStore } from '../stores/RootStore';\nimport { Project } from '../stores/types/Project';\n\nconst fetchAllProjects = async () => {\n  const { data } = await Axios.get<Project[]>(`${PROJECT}/all`);\n\n  return data;\n};\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      display: 'flex',\n    },\n    project: {\n      height: '100vh',\n      width: '100%',\n      display: 'flex',\n      flexDirection: 'column',\n    },\n  }),\n);\n\nconst Projects = () => {\n  const styles = useStyles();\n\n  const {\n    projectStore: { project, dataset_id, projects: prj, setProjects },\n  } = useStore();\n\n  const { isLoading, isError, error, data: projects = [] } = useQuery<Project[], Error>(\n    'projects',\n    fetchAllProjects,\n  );\n\n  useEffect(() => {\n    if (isLoading) return;\n\n    if (projects.length > 0 && Object.values(prj).length === 0) setProjects(projects);\n  }, [isLoading, projects]);\n\n  if (isLoading) return <div>Loading Projects</div>;\n\n  if (isError && error) return <div>{error.message}</div>;\n\n  return (\n    <div className={styles.root}>\n      <Sidebar projects={projects} />\n      <If condition={Boolean(project && dataset_id)}>\n        <DataView />\n      </If>\n    </div>\n  );\n};\n\nexport default observer(Projects);\n","import { ApolloClient, ApolloProvider, createHttpLink, InMemoryCache } from '@apollo/client';\nimport { CssBaseline } from '@material-ui/core';\nimport whyDidYouRender from '@welldone-software/why-did-you-render';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { QueryClientProvider } from 'react-query';\nimport { HashRouter, Redirect, Route, Switch } from 'react-router-dom';\n\nimport BaseLayout from './layouts/BaseLayout';\nimport { store, StoreContext } from './stores/RootStore';\nimport Explore from './views/Explore';\nimport Projects from './views/Projects';\n\nexport const API =\n  process.env.NODE_ENV === 'development' ? 'http://localhost' : 'https://reusing.sci.utah.edu';\nexport const PROJECT = `${API}/project`;\nexport const DATA = `${API}/data`;\nexport const PREDICT = `${API}/predict`;\nexport const COMPUTE = `${API}/compute`;\n\nconst httpLink = createHttpLink({\n  uri:\n    process.env.NODE_ENV === 'development'\n      ? 'http://localhost/graphql/'\n      : 'https://reusing.sci.utah.edu/graphql/',\n});\n\nexport const apolloClient = new ApolloClient({\n  link: httpLink,\n  cache: new InMemoryCache(),\n  headers: {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*',\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    'Access-Control-Allow-Credentials': true as any,\n  },\n});\n\nwhyDidYouRender(React, {\n  trackAllPureComponents: true,\n  exclude: [/XGrid|RowCells|GridCell/],\n});\n\nconst App = () => {\n  return (\n    <ApolloProvider client={apolloClient}>\n      <StoreContext.Provider value={store}>\n        <QueryClientProvider client={store.query}>\n          <CssBaseline>\n            <BaseLayout>\n              <HashRouter>\n                <Switch>\n                  <Redirect from=\"/\" to=\"/project\" exact />\n                  <Route component={Projects} path=\"/project\" exact />\n                  <Route component={Explore} path=\"/explore\" exact />\n                </Switch>\n              </HashRouter>\n            </BaseLayout>\n          </CssBaseline>\n        </QueryClientProvider>\n      </StoreContext.Provider>\n    </ApolloProvider>\n  );\n};\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// TODO: Uncomment\n// reportWebVitals(console.log);\n"],"sourceRoot":""}