(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{548:function(e,t,n){"use strict";n.r(t),n.d(t,"API",(function(){return mc})),n.d(t,"PROJECT",(function(){return vc})),n.d(t,"DATA",(function(){return yc})),n.d(t,"PREDICT",(function(){return wc})),n.d(t,"COMPUTE",(function(){return kc})),n.d(t,"apolloClient",(function(){return Sc}));var r=n(342),c=n(653),a=n(657),i=n(665),o=n(650),s=n(312),l=n.n(s),d=n(0),u=n.n(d),j=n(25),h=n.n(j),b=n(340),f=n(181),p=n(39),g=n(8),O=n(77),x=n(553),m=n(624),v=n(625),y=n(626),w=n(317),k=n.n(w),C=n(13),S=n(621),M=n(551),N=n(552),A=n(18),L=n(56),E=n(10),z=n(658),P=n(22),W=n.n(P),I=n(38),B=n(28),T=n(60),F=n(76),_=n(15),R=n(172),D=(n(516),{apiKey:"AIzaSyB8jzc6Gck2Rt-rrw-ZbACudr5VqESRNRY",authDomain:"reusing-intent.firebaseapp.com",databaseURL:"https://reusing-intent-default-rtdb.firebaseio.com",projectId:"reusing-intent",storageBucket:"reusing-intent.appspot.com",messagingSenderId:"290275127628",appId:"1:290275127628:web:1441a32bfafc7880ff5fe9",measurementId:"G-G4HW82CZ7W"});function G(){var e=0===R.a.apps.length?R.a.initializeApp(D):R.a.app(),t=R.a.database(e),n=function(){var e=Object(I.a)(W.a.mark((function e(n){var r;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.ref(n).get();case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{app:e,db:t,ref:n}}function H(e){return J.apply(this,arguments)}function J(){return(J=Object(I.a)(W.a.mark((function e(t){var n,r,c;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=G(),r=n.ref,e.next=3,r(t);case 3:return c=e.sent.val(),e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){return U.apply(this,arguments)}function U(){return(U=Object(I.a)(W.a.mark((function e(t){var n,r;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=G(),r=n.ref,e.next=3,r(t);case 3:return e.abrupt("return",e.sent.exists());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){return $.apply(this,arguments)}function $(){return($=Object(I.a)(W.a.mark((function e(t){var n,r;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(B.a)({},"/".concat(t.id),t),r=G(),r.db.ref().update(n);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e){return Y.apply(this,arguments)}function Y(){return(Y=Object(I.a)(W.a.mark((function e(t){var n,r,c;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=G(),r=n.ref,e.t0=Object,e.next=4,r("/");case 4:if(e.t1=e.sent.val(),e.t1){e.next=7;break}e.t1={};case 7:return e.t2=e.t1,c=e.t0.values.call(e.t0,e.t2),e.abrupt("return",c.filter((function(e){return"Custom"===e.type&&e.project===t})));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){var t=e.intent,n=e.algorithm,r=e.info;return{intent:t,algorithm:n,params:e.params,dimensions:e.dimensions,info:r}}function K(){return"plot".concat((new Date).getTime().toString())}function Q(){return"agg".concat((new Date).getTime().toString())}function ee(){return Object(F.createAction)((function(e,t){e.interaction=t})).saveStateMode("Complete")}var te=ee().setEventType("Add Scatterplot").setLabel("Add Scatterplot"),ne=ee().setEventType("Add Scatterplot").setLabel("Add PCP"),re=ee().setEventType("Remove Scatterplot").setLabel("Remove Scatterplot"),ce=ee().setEventType("Point Selection").setLabel("Select points"),ae=(ee().setEventType("Point Deselection").setLabel("Unselect points"),ee().setLabel("Brush").setEventType("Add Brush")),ie=ee().setLabel("Brush").setEventType("Update Brush"),oe=ee().setLabel("Brush").setEventType("Remove Brush"),se=ee().setLabel("Intent Selection").setEventType("Algorithmic Selection"),le=ee().setLabel("Filter Selections").setEventType("Filter"),de=ee().setLabel("Label Selections").setEventType("Label"),ue=ee().setLabel("Categorize Selections").setEventType("Categorize"),je=ee().setLabel("Aggregate Selections").setEventType("Label"),he=(ee().setLabel("Replace Aggregate"),n(72)),be=n.n(he),fe=function(){var e=Object(I.a)(W.a.mark((function e(t,n,r){var c,a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.post("".concat(kc,"/compare"),{base:t,target:n,provenance:r});case 2:return c=e.sent,a=c.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function pe(){return(pe=Object(I.a)(W.a.mark((function e(t,n,r){var c,a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==r.length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.prev=2,e.next=5,be.a.post("".concat(wc,"/"),{data:t||[],dimensions:n,selections:r});case 5:return c=e.sent,a=c.data,e.abrupt("return",a);case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}var ge=function(){var e=Object(I.a)(W.a.mark((function e(){var t,n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.get("".concat(vc,"/all"));case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oe={interaction:{i_type:"Root"}},xe=n(27),me={views:{},labels:{},filteredPoints:[],categoryAssignments:{},freeformSelections:[],aggregates:{},selections:[]};function ve(e){var t=Object(xe.a)(e.freeformSelections);return Object.values(e.views).forEach((function(e){Object.values(e.brushSelections).forEach((function(e){return t.push.apply(t,Object(xe.a)(e))}))})),Object(xe.a)(new Set(t)).sort()}function ye(){return(ye=Object(I.a)(W.a.mark((function e(t,n){var r,c;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.post("".concat(kc,"/state"),{data:t,provenance:n});case 2:return r=e.sent,c=r.data,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var we,ke={root:"",current:"",nodes:{}},Ce=function(){function e(t,n,r,c){var a=this,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"Default",l=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Object(L.a)(this,e),this.id=void 0,this.project=void 0,this.project_name=void 0,this.order=[],this.name=null,this.graph=void 0,this.type="Default",this.committed=void 0,this.customWorkflows={},this.currentWorkflow=null,this.currentWorkflowReaction=null,this.isSyncing="Not Syncing",this.syncStatus="syncing",this.getAllCustomWorkflows=function(){var e=Object(I.a)(W.a.mark((function e(t){var n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X(t);case 2:n=e.sent,Object(E.runInAction)((function(){var e={};n.forEach((function(t){e[t.id]=t})),a.customWorkflows=e}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.setCurrentWorkflow=function(e){if(e)console.log("Test"),a.currentWorkflow=a.customWorkflows[e];else{var t={id:Date.now().toString(),type:"Custom",name:"",project:a.project,project_name:a.project_name,graph:ke,order:[]};a.currentWorkflow=t}},this.setProject=function(e){a.project=e},this.removeFromWorkflow=function(e){if(a.currentWorkflow&&a.currentWorkflow.graph){var t=a.currentWorkflow.order;a.currentWorkflow.order=t.filter((function(t){return t!==e})),delete a.currentWorkflow.graph.nodes[e]}},this.addToWorkflow=function(e){if(a.currentWorkflow){for(var t=Object(E.toJS)(a.graph),n=t.nodes[e],r=[];r.push(n.id),Object(F.isChildNode)(n);){n=t.nodes[n.parent]}var c={current:(r=r.reverse())[r.length-1],root:r[0],nodes:{}};r.forEach((function(e){var n=t.nodes[e];c.nodes[n.id]=Object(E.toJS)(n)})),a.currentWorkflow.graph=c,a.currentWorkflow.order=r}},this.setWorkflowName=function(e){a.currentWorkflow&&(a.currentWorkflow.name=e)},this.updateGraph=function(e){Object(E.runInAction)((function(){a.graph=e}))},this.toJS=function(){return{id:a.id,project:a.project,graph:a.graph}},this.toggleSync=function(){a.isSyncing="Syncing"===a.isSyncing?"Not Syncing":"Syncing",a.currentWorkflowReaction&&a.currentWorkflowReaction(),a.isSyncing?a.currentWorkflowReaction=Object(E.reaction)((function(){return Object(E.toJS)(a.currentWorkflow)}),(function(e){e&&a.syncCustomWorkflow(e)}),{fireImmediately:!0}):a.currentWorkflowReaction=null},this.syncCustomWorkflow=function(e){var t=e.id,n=e.type,r=e.name,c=e.graph,a=e.project,i=e.project_name,o=e.order;""!==c.root&&""!==c.current&&""!==r&&(o.forEach((function(e,t){c.nodes[e].children=t!==o.length-1?[c.nodes[o[t+1]].id]:[];var n=c.nodes[e];Object(F.isChildNode)(n)&&0!==t&&(n.parent=c.nodes[o[t-1]].id),c.nodes[e]=n})),c.current=o[o.length-1],c.root=o[0],q({id:t,name:r,graph:c,type:n,project:a,project_name:i,order:o}))},this.sync=function(){a.committed=!0,q({id:a.id,project:a.project,project_name:a.project_name,graph:a.graph,order:a.order,name:a.name,type:a.type})},this.id=t,this.project=n,this.name=i,this.type=s,this.project_name=r,this.order=o,this.graph=c,this.committed=l,Object(E.makeAutoObservable)(this),this.getAllCustomWorkflows(n),Object(E.reaction)((function(){return Object(E.toJS)(a.graph)}),(function(){return a.sync()}))}return Object(T.a)(e,[{key:"doesCurrentHaveWorkflow",get:function(){var e;return Boolean(""!==(null===(e=this.currentWorkflow)||void 0===e?void 0:e.graph.root))}}]),e}(),Se={"Freeform Small":20,"Freeform Medium":35,"Freeform Large":50},Me={data:[],compare:{}},Ne=function(){function e(t){var n=this;Object(L.a)(this,e),this.root=void 0,this.plotType="none",this.showCategories=!1,this.selectedCategoryColumn=null,this.brushType="Freeform Medium",this.showLabelLayer=!0,this.highlightMode=!1,this.highlightPredicate=null,this.colorPredicate=null,this.hideAggregateMembers=!1,this.showMatchesLegend=!1,this.predictions={isLoading:!1,values:[]},this.provenance=void 0,this.workflow=null,this.compareMode=!1,this.compareTarget=null,this.compareData=Me,this.hoveredPrediction=null,this.import=!1,this.showGlobalScale=!1,this.record={},this.lastAccessed="",this.stateHelper=function(e,t){var r=""!==n.lastAccessed?Object(E.toJS)(n.record[n.lastAccessed]):me;t&&(r=Object(E.toJS)(t),n.lastAccessed=e);var c=Object.values(r.views).filter((function(e){return"Scatterplot"===e.type})),a=Object.values(r.views).filter((function(e){return"PCP"===e.type}));return Object(A.a)(Object(A.a)({},r),{},{scatterplots:c,pcps:a})},this.addScatterplot=function(e,t){if(n.data)if("none"===n.plotType&&(n.plotType="scatterplot"),e&&t){var r={i_type:"ViewSpec",id:K(),action:"Add",type:"Scatterplot",dimensions:[e,t]};n.provenance.apply(te(r),"Adding scatterplot for ".concat(e,"-").concat(t))}else{var c={i_type:"ViewSpec",id:K(),type:"Scatterplot",action:"Add",dimensions:[n.data.numericColumns[0],n.data.numericColumns[1]]};n.provenance.apply(te(c),"Adding scatterplot for ".concat(c.dimensions[0],"-").concat(c.dimensions[1]))}},this.addPCP=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(n.data)if(0===e.length){var t={i_type:"ViewSpec",id:K(),type:"PCP",action:"Create",dimensions:n.data.numericColumns.slice(0,4)};n.provenance.apply(ne(t),"Adding PCP")}else{var r={i_type:"ViewSpec",id:K(),type:"PCP",action:"Create",dimensions:e};n.provenance.apply(ne(r),"Adding PCP")}},this.removeScatterplot=function(e){n.provenance.apply(re({i_type:"ViewSpec",id:e,action:"Remove",type:"Scatterplot",dimensions:[]}),"Remove Scatterplot")},this.selectPointsFreeform=function(e,t){if(n.data){t.spec;var r={i_type:"Selection",type:"Point",action:"Selection",ids:e};n.provenance.apply(ce(r),"Select ".concat(e.length," points"))}},this.unselectPointsFreeform=function(e,t){if(n.data){t.spec;var r=n.state.freeformSelections,c=e.filter((function(e){return r.includes(e)})),a={i_type:"Selection",type:"Point",action:"Deselection",ids:c};n.provenance.apply(ce(a),"Unselect ".concat(c.length," points"))}},this.handleBrushSelection=function(e,t,r,c){var a=t[c],i=e.spec;switch(r){case"Add":var o=a.extents,s=o.x1,l=o.x2,d=o.y1,u=o.y2;if("Scatterplot"===i.type){var j,h=(j={},Object(B.a)(j,i.dimensions[0],{min:s,max:l}),Object(B.a)(j,i.dimensions[1],{min:d,max:u}),j),b={i_type:"Selection",type:"Range",rangeId:a.id,action:"Add",view:i.id,extents:h};n.provenance.apply(ae(b),"Add Brush")}break;case"Update":var f=a.extents,p=f.x1,g=f.x2,O=f.y1,x=f.y2;if("Scatterplot"===i.type){var m,v=(m={},Object(B.a)(m,i.dimensions[0],{min:p,max:g}),Object(B.a)(m,i.dimensions[1],{min:O,max:x}),m);n.provenance.apply(ie({i_type:"Selection",type:"Range",view:i.id,rangeId:a.id,action:"Update",extents:v}),"Update Brush")}break;case"Remove":n.provenance.apply(oe({i_type:"Selection",type:"Range",rangeId:c,action:"Remove",view:i.id,extents:{}}),"Remove Brush")}},this.handleIntentSelection=function(e){n.provenance.apply(se({i_type:"Selection",type:"Algorithmic",apply:Z(e)}),"Apply ".concat(e.intent," selection"))},this.handleFilter=function(e){n.provenance.apply(le({i_type:"Filter",action:e}),"Filter ".concat(e))},this.handleLabelling=function(e){n.provenance.apply(de({i_type:"Label",as:e}),"Assign label ".concat(e))},this.handleCategorization=function(e,t){n.provenance.apply(ue({i_type:"Categorize",in:e,as:t}))},this.handleAggregate=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.provenance.apply(je({i_type:"Aggregation",name:e,id:Q(),drop:r,rules:t}))},this.switchCompareMode=function(e){n.compareMode=e},this.setCompareTarget=function(e){n.compareTarget=e},this.setHoveredPrediction=function(e){n.hoveredPrediction=e},this.loadWorkflow=function(){var e=Object(I.a)(W.a.mark((function e(t){var r,c,a,i,o,s,l,d,u,j;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t);case 2:if(e.sent){e.next=8;break}r=n.root.projectStore.project,Object(E.runInAction)((function(){r&&(n.workflow=new Ce(t,r.id,r.name,Object(E.toJS)(n.provenance.graph),null,[],"Default"),n.workflow.sync())})),e.next=31;break;case 8:return Object(E.runInAction)((function(){n.import=!0})),e.next=11,n.query.fetchQuery("projects",(function(){return ge()}));case 11:if(0!==(c=e.sent).length){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,H(t);case 16:if(a=e.sent,i=a.id,o=a.project,s=a.project_name,l=a.graph,d=a.order,u=a.name,j=a.type,n.root.projectStore.setProjects(c),n.root.projectStore.setCurrentProject(o),n.root.projectStore.project){e.next=22;break}return e.abrupt("return");case 22:return e.next=24,n.root.projectStore.getData(n.root.projectStore.project);case 24:Object.entries(l.nodes).forEach((function(e){var t=Object(g.a)(e,2),n=t[0],r=t[1];r.children||(r.children=[]),l.nodes[n]=r})),n.provenance.importProvenanceGraph(l),n.root.projectStore.setDatasetId(n.root.projectStore.projects[o].datasets[0].id),n.updateRecord(n.dataset_id||"",n.provenance.graph),n.refreshPrediction(),Object(E.runInAction)((function(){n.workflow=new Ce(i,o,s,l,u,d,j)})),Object(E.runInAction)((function(){n.import=!1}));case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.refreshPrediction=function(e){var t=e||n.state,r=ve(t),c=function(e){var t=[];return Object.values(e.views).forEach((function(e){"Scatterplot"===e.type&&t.push.apply(t,[e.x,e.y])})),Object(xe.a)(new Set(t))}(t),a=n.dataPoints;0!==r.length?(Object(E.runInAction)((function(){n.predictions.isLoading=!0})),n.query.fetchQuery(["predictions",n.dataset_id,r,c,a],(function(){return function(e,t,n){return pe.apply(this,arguments)}(a,c,r)}),{retry:100}).then((function(e){Object(E.runInAction)((function(){n.predictions={isLoading:!1,values:e}}))}))):Object(E.runInAction)((function(){return n.predictions={isLoading:!1,values:[]}}))},this.approveNode=function(e){var t=(n.provenance.getLatestArtifact(e)||{}).artifact,r=void 0===t?null:t;(r=JSON.parse(JSON.stringify(r)))&&(r.status[n.dataset_id||""]="Accepted",n.provenance.addArtifact(r,e))},this.rejectNode=function(e){var t=(n.provenance.getLatestArtifact(e)||{}).artifact,r=void 0===t?null:t;(r=JSON.parse(JSON.stringify(r)))&&(r.status[n.dataset_id||""]="Rejected",n.provenance.addArtifact(r,e))},this.toggleHideAggregateMembers=function(){return n.hideAggregateMembers=!n.hideAggregateMembers},this.toggleLabelLayer=function(e){n.showLabelLayer=e||!n.showLabelLayer},this.switchBrush=function(e){"on"===n.root.opts.debug&&localStorage.setItem("btype",e),n.brushType=e},this.toggleShowCategories=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n.showCategories="boolean"===typeof e?e:!n.showCategories},this.setHighlightMode=function(e){return n.highlightMode=e},this.setHighlightPredicate=function(e){return n.highlightPredicate=e},this.setColorPredicate=function(e){return n.colorPredicate=e},this.setShowMatchesLegend=function(e){return n.showMatchesLegend=e},this.changeCategoryColumn=function(e){if(n.data&&e){if(!n.data.categoricalColumns.includes(e))throw new Error("Undefined column");n.selectedCategoryColumn=e,localStorage.setItem("category-column",e)}},this.getCompareData=function(e,t){var r=n.provenance.graph;n.query.fetchQuery(["compare",n.dataset_id,n.compareTarget,r],(function(){return fe(n.root.projectStore._data[e].values,n.root.projectStore._data[t].values,r)})).then((function(e){Object(E.runInAction)((function(){n.compareData=e}))}))},this.setShowGlobalScale=function(e){n.showGlobalScale=e},this.updateRecord=function(e,t){n.query.fetchQuery(["state",e,t],(function(){return function(e,t){return ye.apply(this,arguments)}(n.rawDataPoints,t)})).then((function(e){Object(E.runInAction)((function(){n.record=e}))}))},this.root=t,this.provenance=Object(F.initProvenance)(Oe),this.provenance.done(),window.printProvenanceTable=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["id","label"];console.table(Object.values(Object(E.toJS)(n.provenance.graph.nodes)),e)},window.printProvenance=function(){console.log(n.provenance.state)},window.printRawProvenance=function(){console.log(Object(E.toJS)(n.provenance.graph))},Object(E.makeAutoObservable)(this,{updateRecord:E.action,stateHelper:E.action,refreshPrediction:E.action,toggleShowCategories:E.action,setCompareTarget:E.action,switchBrush:E.action,toggleLabelLayer:E.action,switchCompareMode:E.action,toggleHideAggregateMembers:E.action,setHoveredPrediction:E.action});var r=Object(E.when)((function(){return n.showCategories&&null!==n.data}),(function(){n.data&&n.doesHaveCategories&&null===n.selectedCategoryColumn&&(n.selectedCategoryColumn=n.data.categoricalColumns[0])}));if(Object(E.reaction)((function(){return n.data}),(function(e,t,c){e&&(n.doesHaveCategories||r(),c.dispose())})),Object(E.reaction)((function(){return Object(E.toJS)(n.provenance.graph)}),(function(e){n.workflow&&n.workflow.updateGraph(e)})),Object(E.reaction)((function(){return{dataset_id:n.dataset_id,provenance:Object.values(n.provenance.graph.nodes).length}}),(function(e){var t=e.dataset_id;t&&n.updateRecord(t,n.provenance.graph)})),Object(E.reaction)((function(){return n.state}),(function(e){return n.refreshPrediction(e)})),"on"===t.opts.debug){this.toggleShowCategories(t.opts.showCategories);var c=localStorage.getItem("btype");this.switchBrush(c||this.brushType)}Object(E.reaction)((function(){return{mode:n.compareMode,target:n.compareTarget}}),(function(e){var t=e.mode,r=e.target;t&&r&&n.dataset_id&&n.getCompareData(n.dataset_id,r)})),Object(E.reaction)((function(){return Object.values(n.provenance.graph.nodes).length}),(function(){if(!n.import){var e=n.provenance.current;if(Object(F.isChildNode)(e)){var t,r={original_record:n.dataset_id||"",status:{}};null===(t=n.root.projectStore.project)||void 0===t||t.datasets.forEach((function(e){e.id===n.dataset_id?r.status[e.id]="Accepted":r.status[e.id]="Unknown"})),n.provenance.addArtifact(r)}}}))}return Object(T.a)(e,[{key:"query",get:function(){return this.root.query}},{key:"dataset_id",get:function(){return this.root.projectStore.dataset_id}},{key:"base_dataset_id",get:function(){return this.dataset_id}},{key:"data",get:function(){return this.root.projectStore.data}},{key:"rawDataPoints",get:function(){var e;return(null===(e=this.data)||void 0===e?void 0:e.values)||[]}},{key:"nodeCreationMap",get:function(){var e=this,t={};return Object.values(this.provenance.graph.nodes).forEach((function(n){var r=e.provenance.getLatestArtifact(n.id);if(r){var c=r.artifact,a={createdIn:e.root.projectStore.datasetVersionFromKey(c.original_record),approvedIn:Object.entries(c.status).filter((function(e){return"Accepted"===e[1]})).map((function(t){return e.root.projectStore.datasetVersionFromKey(t[0])})),rejectedIn:Object.entries(c.status).filter((function(e){return"Rejected"===e[1]})).map((function(t){return e.root.projectStore.datasetVersionFromKey(t[0])}))};t[n.id]=a}})),t}},{key:"rangeMap",get:function(){var e=Object.values(this.root.projectStore._data),t={};if(this.showGlobalScale)e.forEach((function(e){var n=e.columnInfo,r=e.values,c=void 0===r?[]:r;Object.keys(n).forEach((function(e){var n=Object(_.a)(c.map((function(t){return t[e]}))),r=Object(g.a)(n,2),a=r[0],i=void 0===a?-1:a,o=r[1],s=void 0===o?-1:o;t[e]?(t[e].min=t[e].min<i?t[e].min:i,t[e].max=t[e].max>s?t[e].max:s):t[e]={min:i,max:s}}))}));else{if(!this.data)return t;var n=this.dataPoints,r=this.data.columnInfo;Object.keys(r).forEach((function(e){var r=Object(_.a)(n.map((function(t){return t[e]}))),c=Object(g.a)(r,2),a=c[0],i=void 0===a?-1:a,o=c[1],s=void 0===o?-1:o;t[e]?(t[e].min=t[e].min<i?t[e].min:i,t[e].max=t[e].max>s?t[e].max:s):t[e]={min:i,max:s}}))}return t}},{key:"dataPoints",get:function(){return this.computeDataPoints(this.state,this.rawDataPoints)}},{key:"aggregateDataPoints",get:function(){var e=this.state.aggregates,t=[];return Object.values(e).forEach((function(e){t.push(e.aggregate)})),t}},{key:"computeDataPoints",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length)return t;var c={};return t.filter((function(t){return!e.filteredPoints.includes(t.id)})).forEach((function(e){c[e.id]=Object(E.toJS)(e)})),r&&(Object.entries(e.labels).forEach((function(e){var t=Object(g.a)(e,2),n=t[0];t[1].forEach((function(e){c[e]&&(c[e].customlabel?c[e].customlabel.push(n):c[e].customlabel=[n])}))})),Object.entries(e.categoryAssignments).forEach((function(e){var t=Object(g.a)(e,2),r=t[0],a=t[1];r===n.selectedCategoryColumn&&Object.entries(a).forEach((function(e){var t=Object(g.a)(e,2),n=t[0];t[1].forEach((function(e){c[e].customCategoryAssignment=n}))}))}))),Object.values(c)}},{key:"doesHaveCategories",get:function(){return!!this.data&&this.data.categoricalColumns.length>0}},{key:"changes",get:function(){var e=this.provenance.graph.current,t=this.compareData.compare[e];return t?t.changes:{added:[],removed:[],updated:[],updateMap:[],results:[]}}},{key:"state",get:function(){var e=this.provenance.graph.current,t=this.record[e],n=this.compareData.compare[e];return this.compareMode&&(t=n?n.state:n),this.stateHelper(e,t)}},{key:"selections",get:function(){return this.state.selections}}]),e}(),Ae=n(313),Le=n(654),Ee=Object(Le.a)(we||(we=Object(Ae.a)(["\n  mutation add_category_column($projectId: ID!, $columnName: String!, $options: String!) {\n    addCategoryColumn(projectId: $projectId, columnName: $columnName, options: $options) {\n      errors\n      success\n      columnInfo\n      numericColumns\n      categoricalColumns\n      labelColumn\n      columns\n    }\n  }\n"])));function ze(e,t,n){return Sc.mutate({mutation:Ee,variables:{projectId:e,columnName:t,options:n}})}var Pe=function(){var e=Object(I.a)(W.a.mark((function e(t){var n,r;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.get("".concat(yc,"/").concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=function(){function e(t){var n=this;Object(L.a)(this,e),this.root=void 0,this.project_id=null,this.dataset_id=null,this._data={},this.projects={},this.datasetVersionFromKey=function(e){if(!e)return"";var t=(n._data[e]||{}).version;return void 0===t?"":t},this.setProjects=function(e){var t={};e.forEach((function(e){t[e.id]=e})),Object(E.runInAction)((function(){n.projects=t}))},this.setCurrentProject=function(e){localStorage.removeItem("aggOpt"),n.project_id=e},this.setDatasetId=function(e){n.dataset_id=e},this.addCategoryColumn=function(){var e=Object(I.a)(W.a.mark((function e(t,r){var c,a,i;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.project){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,ze(n.project.id,t,r);case 4:c=e.sent,(a=c.data)&&(i=a.addCategoryColumn,Object(E.runInAction)((function(){if(n.data){if(!n.dataset_id)return;n._data[n.dataset_id]=Object(A.a)(Object(A.a)({},n.data),i),n.root.exploreStore.selectedCategoryColumn=t}})));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.getData=function(){var e=Object(I.a)(W.a.mark((function e(t){var r,c,a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.datasets,c=[],r.forEach((function(e){var t=n.query.fetchQuery(["dataset",e.id],(function(){return Pe(e.id)}));c.push(t)})),(a=Promise.all(c)).then((function(e){var t={};e.forEach((function(e){t[e.id]=e})),Object(E.runInAction)((function(){n._data=t}))})).catch((function(e){throw new Error(e)})),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.root=t,Object(E.makeAutoObservable)(this,{setCurrentProject:E.action}),Object(E.reaction)((function(){return n.project}),(function(e){e&&n.getData(e)}))}return Object(T.a)(e,[{key:"project",get:function(){return this.project_id?this.projects[this.project_id]:null}},{key:"data",get:function(){return this.dataset_id?this._data[this.dataset_id]:null}},{key:"query",get:function(){return this.root.query}}]),e}(),Ie=Object(d.createContext)(void 0);function Be(){var e=Object(d.useContext)(Ie);if(void 0===e)throw new Error("Store is undefined");return e}var Te=new function e(){var t=this;Object(L.a)(this,e),this.projectStore=void 0,this.exploreStore=void 0,this.opts=void 0,this.query=void 0,this.setDebugOpts=function(e){t.opts=Object(A.a)(Object(A.a)({},t.opts),e),localStorage.setItem("debug-opts",JSON.stringify(t.opts))},this.query=new z.a({defaultOptions:{queries:{staleTime:1/0,cacheTime:1/0}}}),this.opts={debug:"off",goToExplore:!1,showCategories:!1};var n=localStorage.getItem("debug-opts");null!==n&&(this.opts=JSON.parse(n),localStorage.setItem("debug-opts",JSON.stringify(this.opts))),this.projectStore=new We(this),this.exploreStore=new Ne(this),Object(E.makeAutoObservable)(this),Object(E.when)((function(){return t.opts.showCategories}),(function(){t.exploreStore.toggleShowCategories(t.opts.showCategories)}))},Fe=n(1),_e=Object(C.a)((function(){var e=Be(),t=e.opts,n=e.setDebugOpts;return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsxs)(S.a,{children:[Object(Fe.jsx)(M.a,{control:Object(Fe.jsx)(N.a,{checked:"on"===t.debug,onChange:function(){return n({debug:"on"===t.debug?"off":"on"})}}),label:"Debug Mode"}),Object(Fe.jsx)(M.a,{control:Object(Fe.jsx)(N.a,{checked:t.goToExplore,onChange:function(){return n({goToExplore:!t.goToExplore})}}),label:"Redirect To Explore"}),Object(Fe.jsx)(M.a,{control:Object(Fe.jsx)(N.a,{checked:t.showCategories,onChange:function(){return n({showCategories:!t.showCategories})}}),label:"Show Categories"})]}),Object(Fe.jsx)("pre",{children:JSON.stringify(t,null,4)})]})})),Re=Object(O.a)((function(e){return{fab:{position:"absolute",right:e.spacing(2),bottom:e.spacing(2),"z-index":1e5}}})),De=Object(C.a)((function(e){var t=e.children,n=Re(),r=Object(d.useState)("close"),c=Object(g.a)(r,2),a=c[0],i=c[1];return Object(Fe.jsxs)(Fe.Fragment,{children:[t,Object(Fe.jsx)(x.a,{className:n.fab,color:"primary",onClick:function(){return i("open")},children:Object(Fe.jsx)(k.a,{})}),Object(Fe.jsxs)(m.a,{open:"open"===a,onClose:function(){i("close")},children:[Object(Fe.jsx)(v.a,{children:"Debug Menu"}),Object(Fe.jsx)(y.a,{children:Object(Fe.jsx)(_e,{})})]})]})})),Ge=n(311),He=n(663),Je=n(334),Ve=n.n(Je),Ue=n(557),qe=n(117),$e=n(558),Xe=n(559),Ye=n(560),Ze=n(132),Ke=n(221),Qe=n(320),et=n.n(Qe),tt=n(318),nt=n.n(tt),rt="rgb(254, 95, 85)",ct="rgb(89, 205, 144)",at="rgb(250, 192, 94)",it="rgb(244,106,15)",ot=Object(O.a)({newColor:{stroke:"blue !important",fill:"blue !important"},removedColor:{stroke:"red !important"},newMark:{strokeWidth:"1",fill:"black",opacity:.5},removedMark:{stroke:"none",strokeWidth:"0.5",strokeLinecap:"round",opacity:.5,fill:"black"},movedLine:{opacity:"0.2 !important",stroke:"black",fill:"black",strokeWidth:"1",strokeLinecap:"round"},movedPoint:{fill:"black",opacity:.5},regularMark:{fill:"black"},regularLine:{stroke:"black",strokeOpacity:.2},nonUnionMark:{fill:"rgb(44, 127, 184)"},unionMark:{fill:it,stroke:it},unionLine:{stroke:it,strokeOpacity:.8},regularForceMark:{fill:"black !important",opacity:.2},intermittentHighlight:{fill:"red"},matches:{fill:"".concat(rt," !important"),opacity:1},isnp:{fill:"".concat(at," !important"),opacity:1},ipns:{fill:"".concat(ct," !important"),opacity:1},dullMark:{opacity:.2},forceDullMark:{opacity:"0.1 !important"}}),st=n(4);function lt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return"translate(".concat(e,", ").concat(t,")")}var dt=Object(O.a)((function(){return Object(Ge.a)({common:{fill:"rgb(168,211,238)"},foreground:{opacity:.9},background:{opacity:.3},label:{fill:"black"}})})),ut=Object(C.a)((function(e){var t=e.rank,n=e.height,r=void 0===n?45:n,c=e.label,a=void 0===c?t.toFixed(2):c,i=dt(),o=Object(d.useRef)(null),s=Object(d.useState)(0),l=Object(g.a)(s,2),u=l[0],j=l[1];Object(d.useEffect)((function(){if(o.current){var e=o.current.getBoundingClientRect();u!==e.width&&j(e.width)}}),[u]);var h=Object(d.useMemo)((function(){return Object(_.d)().domain([0,1]).range([0,u])}),[u]);return Object(Fe.jsxs)("svg",{ref:o,height:r,width:"100%",children:[Object(Fe.jsx)("rect",{className:Object(st.a)(i.common,i.background),height:r,width:u}),Object(Fe.jsx)("rect",{className:Object(st.a)(i.common,i.foreground),height:r,width:h(t)}),Object(Fe.jsx)(qe.a,{className:i.label,component:"text",dominantBaseline:"middle",textAnchor:"start",transform:lt(.05*u,r/2),variant:"button",children:a})]})})),jt=Object(O.a)((function(){return Object(Ge.a)({centerContainer:{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},listContainer:{overflow:"scroll",padding:"1em"}})})),ht=Object(C.a)((function(){var e=jt(),t=ot(),n=Be().exploreStore,r=n.predictions,c=r.isLoading,a=r.values,i=n.setHighlightMode,o=n.setHoveredPrediction,s=n.setHighlightPredicate,l=n.setColorPredicate,d=n.handleIntentSelection,u=n.setShowMatchesLegend;return c?Object(Fe.jsxs)("div",{className:e.centerContainer,children:[Object(Fe.jsx)(Ue.a,{}),Object(Fe.jsx)(qe.a,{variant:"button",children:"Computing Predictions"})]}):0===a.length?Object(Fe.jsx)("div",{className:e.centerContainer,children:Object(Fe.jsx)(qe.a,{variant:"button",children:"No valid selections"})}):Object(Fe.jsx)("div",{className:e.listContainer,children:Object(Fe.jsx)($e.a,{children:a.map((function(e){return Object(Fe.jsxs)(Xe.a,{onMouseEnter:function(){o(e),i(!0),s((function(t){var n=e.membership_stats,r=n.ipns,c=n.isnp,a=n.matches;return r.includes(t.id)||c.includes(t.id)||a.includes(t.id)})),l((function(n){var r=n.id,c=e.membership_stats,a=c.ipns,i=c.isnp,o=c.matches;return a.includes(r)?t.ipns:i.includes(r)?t.isnp:o.includes(r)?t.matches:"inherit"})),u(!0)},onMouseLeave:function(){o(null),i(!1),s(null),l(null),u(!1)},children:[Object(Fe.jsx)(ut,{label:"".concat(e.intent," ( ").concat(e.rank_jaccard.toFixed(3)," )"),rank:e.rank_jaccard}),Object(Fe.jsx)(Ye.a,{children:Object(Fe.jsx)(Ze.a,{onClick:function(){d(e),i(!1),s(null),l(null),u(!1)},children:Object(Fe.jsx)(nt.a,{})})}),Object(Fe.jsx)(Ke.a,{title:Object(Fe.jsx)("pre",{children:JSON.stringify(Z(e),null,2)}),children:Object(Fe.jsx)(Ye.a,{children:Object(Fe.jsx)(et.a,{})})})]},e.hash)}))})})})),bt=n(32),ft=n(88),pt=n(651),gt=n(652),Ot=n(127);function xt(e,t){var n=[];for(var r in t)t[r].bunchedNodes.includes(e)&&n.push(r);return n}function mt(e,t){return"translate(".concat(e,", ").concat(t,")")}function vt(e,t,n){var r=function(e,t,n){var r=[];return yt(e,t,n,r),[t].concat(Object(xe.a)(r.reverse()))}(e,n,t);return function(e,t,n,r){var c=new Set,a=[],i=0;a.push(e[t]);for(;a.length>0;){var o=a.pop();c.has(o.id)?o.width=n[o.id]:(o.width=i,n[o.id]=o.width,c.add(o.id)),o.children?a.push.apply(a,Object(xe.a)(o.children.sort((function(e,t){return(r.includes(e.id)?1:0)-(r.includes(t.id)?1:0)})))):i+=1}}(e,n,{},r),r}function yt(e,t,n,r){if(!e[t])return!1;if(t===n)return r.push(t),!0;var c,a=e[t].children||[],i=Object(bt.a)(a);try{for(i.s();!(c=i.n()).done;){var o=c.value;if(yt(e,o.id,n,r))return r.push(o.id),!0}}catch(s){i.e(s)}finally{i.f()}return!1}var wt=n(656),kt=n(156),Ct=function(e){return Object(Ot.a)({fill:e?"rgb(33, 133, 208)":"white",stroke:e?"rgb(33, 133, 208)":"#Ccc"})};var St=Object(C.a)((function(e){var t,n,r=e.prov,c=e.first,a=e.iconOnly,i=e.current,o=e.node,s=e.duration,l=e.radius,u=e.strokeWidth,j=e.addToWorkflow,h=e.textSize,b=e.nodeMap,f=e.annotationOpen,p=e.bookmark,O=e.setAnnotationOpen,x=e.exemptList,m=e.setExemptList,v=e.bundleMap,y=e.eventConfig,w=e.popupContent,k=e.editAnnotations,C=e.annotationContent,S=e.approvedFunction,M=e.rejectedFunction,N=e.currentDataset,A=e.nodeCreationMap,L=e.expandedClusterList,E={cursor:"pointer"},z=Object(d.useState)(o.artifacts&&o.artifacts.annotations&&(null===(t=r.getLatestAnnotation(o.id))||void 0===t?void 0:t.annotation)?null===(n=r.getLatestAnnotation(o.id))||void 0===n?void 0:n.annotation:""),P=Object(g.a)(z,2),W=P[0],I=P[1],B=function(){var e=r.getLatestAnnotation(o.id);(null===e||void 0===e?void 0:e.annotation)!==W.trim()&&(r.addAnnotation(W,o.id),O(-1))},T=function(){var e;I(null===(e=r.getLatestAnnotation(o.id))||void 0===e?void 0:e.annotation),O(-1)},F=function(){},_=Object(Fe.jsx)("circle",{className:Ct(i),r:l,strokeWidth:u,style:E}),R=!1;if(y){var D=o.metadata.eventType;if(D&&D in y&&"Root"!==D){var G=y[D],H=G.bundleGlyph,J=G.currentGlyph,V=G.backboneGlyph;v&&Object.keys(v).includes(o.id)&&(R=!0,_=Object(Fe.jsx)("g",{fontWeight:"none",style:E,children:H})),i?_=Object(Fe.jsx)("g",{fontWeight:"none",style:E,children:J}):R||(_=Object(Fe.jsx)("g",{fontWeight:"none",style:E,children:V}))}}var U="",q="";if(U=v&&Object.keys(v).includes(o.id)&&"Ephemeral"===o.actionType&&L&&!L.includes(o.id)?o.metadata&&o.metadata.eventType?"[".concat(v[o.id].bunchedNodes.length,"] ").concat(o.metadata.eventType):"[".concat(v[o.id].bunchedNodes.length,"]"):o.label,o.artifacts&&o.artifacts.annotations&&o.artifacts.annotations.length>0&&f!==b[o.id].depth&&(q=o.artifacts.annotations[0].annotation),!b[o.id])return null;q.length>20&&(q="".concat(q.substr(0,20),"..")),U.length>20&&(U="".concat(U.substr(0,20),".."));var $=Object(Fe.jsxs)("g",{style:{opacity:1},transform:mt(25,0),children:[A[o.id]?Object(Fe.jsxs)("g",{children:[Object(Fe.jsxs)("g",{transform:mt(-10,-10),children:[Object(Fe.jsx)("circle",{fill:"white",opacity:"1",r:"7"}),Object(Fe.jsx)("text",{alignmentBaseline:"middle",fill:A[o.id]&&A[o.id].createdIn===N?"green":"grey",fontSize:10,fontWeight:"bold",style:E,textAnchor:"middle",x:0,y:0,children:A[o.id]?A[o.id].createdIn:""})]}),Object(Fe.jsxs)("g",{transform:mt(-10,10),children:[Object(Fe.jsx)("circle",{fill:"white",opacity:"1",r:"7"}),Object(Fe.jsx)("text",{alignmentBaseline:"middle",fill:A[o.id]&&A[o.id].approvedIn.includes(N)?"green":A[o.id].rejectedIn.includes(N)?"red":"black",fontFamily:"Icons",fontSize:10,style:E,textAnchor:"middle",x:0,y:0,children:A[o.id]&&A[o.id].approvedIn.includes(N)?"\uf00c":A[o.id].rejectedIn.includes(N)?"\uf00d":"\uf128"})]})]}):null,!A[o.id]||A[o.id].rejectedIn.includes(N)||A[o.id].approvedIn.includes(N)?"Root"!==o.label&&!A[o.id].rejectedIn.includes(N)&&Object(Fe.jsx)("g",{transform:mt(-10,10),children:Object(Fe.jsx)("foreignObject",{height:"100",width:"50",x:"-45",y:"-20",children:Object(Fe.jsx)("div",{style:{maxWidth:"20"},children:Object(Fe.jsx)(wt.a,{style:{margin:"1px",padding:"1px",maxHeight:"20px",maxWidth:"20px"},onClick:function(e){e.stopPropagation(),j(o.id)},children:Object(Fe.jsx)(kt.a,{color:"green",name:"add",size:"small",style:{margin:"0px"}})})})})}):Object(Fe.jsx)("g",{transform:mt(-10,10),children:Object(Fe.jsxs)("foreignObject",{height:"100",width:"50",x:"-45",y:"-30",children:[Object(Fe.jsx)("div",{style:{maxWidth:"20"},children:Object(Fe.jsx)(wt.a,{style:{margin:"1px",padding:"1px",maxHeight:"15px",maxWidth:"15px"},onClick:function(e){e.stopPropagation(),S(o.id)},children:Object(Fe.jsx)(kt.a,{color:"green",name:"check",size:"small",style:{margin:"0px"}})})}),Object(Fe.jsx)("div",{style:{maxWidth:"20"},children:Object(Fe.jsx)(wt.a,{style:{margin:"1px",padding:"1px",maxHeight:"15px",maxWidth:"15px"},onClick:function(e){e.stopPropagation(),M(o.id)},children:Object(Fe.jsx)(kt.a,{color:"red",name:"close",size:"small",style:{margin:"0px"}})})})]})}),a?Object(Fe.jsx)("g",{children:R?Object(Fe.jsx)("text",{alignmentBaseline:"middle",fill:"rgb(248, 191, 132)",fontFamily:"Icons",fontSize:17,style:E,textAnchor:"middle",x:1,y:0,onClick:function(e){return Y(o,e)},children:L&&L.includes(o.id)?"\uf0d8":"\uf0d7"}):Object(Fe.jsx)("g",{})}):Object(Fe.jsxs)("g",{children:[R?Object(Fe.jsx)("text",{alignmentBaseline:"middle",fill:"rgb(248, 191, 132)",fontFamily:"Icons",fontSize:17,style:E,textAnchor:"middle",x:1,y:0,onClick:function(e){return Y(o,e)},children:L&&L.includes(o.id)?"\uf0d8":"\uf0d7"}):Object(Fe.jsx)("g",{}),k?Object(Fe.jsxs)("button",{children:[Object(Fe.jsx)("i",{className:"fas fa-undo marginRight"}),"Undo"]}):Object(Fe.jsx)("g",{}),Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:"black",fontSize:h,fontWeight:"bold",textAnchor:"start",x:R?10:0,y:0===q.length?0:-7,onClick:function(){return X(o)},children:U}),",",Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:"black",fontSize:h,fontWeight:"regular",textAnchor:"start",x:R?10:0,y:7,onClick:function(){return X(o)},children:q}),",",Object(Fe.jsx)("text",{alignmentBaseline:"middle",className:"fas fa",fill:r.getBookmark(o.id)?"#2185d0":"#cccccc",fontFamily:"Icons",fontSize:17,opacity:p===o.id||r.getBookmark(o.id)?1:0,style:E,textAnchor:"middle",x:175,y:0,onClick:function(e){r.setBookmark(o.id,!r.getBookmark(o.id)),e.stopPropagation()},children:"\uf02e"}),",",Object(Fe.jsx)("text",{alignmentBaseline:"middle",fill:f===b[o.id].depth?"#2185d0":"#cccccc",fontFamily:"Icons",fontSize:17,opacity:p===o.id||f===b[o.id].depth?1:0,style:E,textAnchor:"middle",x:210,y:0,onClick:function(){-1===f||b[o.id].depth!==f?O(b[o.id].depth):O(-1)},children:"\uf044"})]})]});return Object(Fe.jsx)(ft.a,{enter:{opacity:[1],timing:{duration:100,delay:c?0:s}},start:{opacity:0},children:function(){return Object(Fe.jsxs)(Fe.Fragment,{children:[void 0!==w&&b[o.id].depth>0?Object(Fe.jsx)(pt.a,{content:w(o),trigger:_}):_,void 0!==w&&b[o.id].depth>0?Object(Fe.jsx)(pt.a,{content:w(o),trigger:$}):$,-1!==f&&b[o.id].depth===f?Object(Fe.jsx)("g",{transform:"translate(15, 25)",children:Object(Fe.jsx)("foreignObject",{height:"80",width:"175",x:"0",y:"0",children:Object(Fe.jsxs)("div",{children:[Object(Fe.jsx)("textarea",{style:{maxWidth:130,resize:"none"},value:W,onChange:F}),Object(Fe.jsx)("button",{onClick:B,children:"Annotate"}),Object(Fe.jsx)("button",{onClick:T,children:"Close"})]})})}):Object(Fe.jsx)("g",{})]})}});function X(e){f===b[e.id].depth&&C?O(-1):C&&O(b[e.id].depth)}function Y(e,t){if(v&&Object.keys(v).includes(e.id)){var n=Array.from(x);n.includes(e.id)?n.splice(n.findIndex((function(t){return t===e.id})),1):n.push(e.id),m(n)}t.stopPropagation()}}));var Mt=Object(C.a)((function(e){var t=e.current,n=e.node,r=e.eventConfig,c={cursor:"pointer"},a=Object(Fe.jsx)("circle",{className:Ct(t),r:5,strokeWidth:2,style:c}),i=n.metadata.eventType;if(r){var o=r[i],s=o.currentGlyph,l=o.backboneGlyph;a=t?Object(Fe.jsx)("g",{fontWeight:"none",style:c,children:s}):Object(Fe.jsx)("g",{fontWeight:"none",style:c,children:l})}var d="",u="";return n.artifacts&&n.artifacts.annotations.length>0&&n.artifacts.annotations[0].annotation.length>0&&(u=n.artifacts.annotations[0].annotation),d=n.label,u.length>20&&(u="".concat(u.substr(0,20),"..")),d.length>20&&(d="".concat(d.substr(0,20),"..")),Object(Fe.jsx)(ft.a,{enter:{opacity:[1]},start:{opacity:0},children:function(){return Object(Fe.jsx)(Fe.Fragment,{children:Object(Fe.jsxs)("g",{style:{opacity:1},children:[a,Object(Fe.jsx)("text",{dominantBaseline:"middle",fontSize:15,fontWeight:"bold",textAnchor:"start",x:20,y:0,children:d}),Object(Fe.jsx)("text",{dominantBaseline:"middle",fontSize:15,fontWeight:"regular",textAnchor:"start",x:0,y:20,children:u})]})})}})}));var Nt=Object(C.a)((function(e){var t=e.graph,n=e.eventConfig,r=e.currentNode;if(void 0===t)return null;var c=[];for(var a in t.nodes)t.nodes[a].bookmarked&&c.push(t.nodes[a]);return Object(Fe.jsx)(ft.b,Object(A.a)(Object(A.a)({data:c,keyAccessor:function(e){return e.label}},function(e,t,n){e=-e;var r=function(e){return{x:0,y:40*n.findIndex((function(t){return t.id===e.id}))-t,opacity:0}};return{enter:function(e){return{x:[0],y:[40*n.findIndex((function(t){return t.id===e.id}))],opactiy:1}},leave:r,update:function(e){return{x:[0],y:[40*n.findIndex((function(t){return t.id===e.id}))],opactiy:1}},start:r}}(15,50,c)),{},{children:function(e){return Object(Fe.jsx)(Fe.Fragment,{children:e.map((function(t){var c=t.data,a=t.key,i=t.state;return Object(Fe.jsx)("g",{transform:mt(i.x,i.y),children:Object(Fe.jsx)(Mt,{current:r===c.id,editAnnotations:!1,eventConfig:n,node:c,nodeMap:e})},a)}))})}}))}));function At(e,t,n,r){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:500,a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;e=-e,r=-r;var o=function(){return{x1:0,x2:0,y1:0,y2:0,opacity:0}},s=function(o){var s=0;s=0===s?s:s-1;var l=o.source,d=o.target,u=Lt(l.width,e,r),j=Lt(d.width,e,r),h=t*l.depth-(t-n)*s,b=t*d.depth-(t-n)*s;return-1!==a&&l.depth>a&&0===l.width&&(h+=i),-1!==a&&d.depth>a&&0===d.width&&(b+=i),{x1:u,x2:j,y1:h,y2:b,opacity:1,timing:{duration:c}}},l=function(o){var s=0;s=0===s?s:s-1;var l=o.source,d=o.target,u=Lt(l.width,e,r),j=Lt(d.width,e,r),h=t*l.depth-(t-n)*s,b=t*d.depth-(t-n)*s;return-1!==a&&l.depth>a&&0===l.width&&(h+=i),-1!==a&&d.depth>a&&0===d.width&&(b+=i),{x1:[u],y1:[h],x2:[j],y2:[b],opacity:1,timing:{duration:c}}};return{enter:s,leave:o,update:l,start:o}}function Lt(e,t,n){return e>1?(t+n)*e-n:(t+n)*e}function Et(e,t,n,r){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:500,a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,o=arguments.length>8?arguments[8]:void 0,s=arguments.length>9?arguments[9]:void 0,l=arguments.length>10?arguments[10]:void 0;e=-e,r=-r;var d=function(){return{x:0,y:0,opacity:0}},u=function(d){var u=Lt(i[d].width,e,r),j=i[d].depth,h=i[d].depth;if(l&&a.includes(d))for(var b=0;b<l[d].bunchedNodes.length;b++)i[l[d].bunchedNodes[b]]&&i[l[d].bunchedNodes[b]].depth<j&&(j=i[l[d].bunchedNodes[b]].depth),i[l[d].bunchedNodes[b]]&&i[l[d].bunchedNodes[b]].depth>h&&(h=i[l[d].bunchedNodes[b]].depth);var f=t*j;-1!==o&&j>o&&(f+=s);var p=0;for(var g in l[d].bunchedNodes)i[l[d].bunchedNodes[g]]&&p++;return p*=n,a.includes(d)||(p=10),-1!==o&&o>=j&&o<=h&&(p+=s),{x:[u],y:[f],opacity:[a.includes(d)?1:0],timing:{duration:c},validity:!0,height:p}},j=function(d){var u=Lt(i[d].width,e,r),j=i[d].depth,h=i[d].depth;if(l&&a.includes(d))for(var b=0;b<l[d].bunchedNodes.length;b++)i[l[d].bunchedNodes[b]]&&i[l[d].bunchedNodes[b]].depth<j&&(j=i[l[d].bunchedNodes[b]].depth),i[l[d].bunchedNodes[b]]&&i[l[d].bunchedNodes[b]].depth>h&&(h=i[l[d].bunchedNodes[b]].depth);var f=t*j;-1!==o&&j>o&&(f+=s);var p=0;for(var g in l[d].bunchedNodes)i[l[d].bunchedNodes[g]]&&p++;return p*=n,a.includes(d)||(p=10),-1!==o&&o>=j&&o<=h&&(p+=s),{x:[u],y:[f],opacity:[a.includes(d)?1:0],timing:{duration:c},validity:!0,height:[p]}};return{enter:u,leave:d,update:j,start:d}}var zt=function(e){return Object(Fe.jsx)("line",Object(A.a)({},e))};function Pt(e,t,n,r){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:500,a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;e=-e,r=-r;var o=function(c){var o=0,s=Lt(c.width,e,r);o=0===o?o:o-1;var l=t*c.depth-(t-n)*o;return-1!==a&&c.depth>a&&0===c.width&&(l+=i),{x:s,y:l-t,opacity:0}},s=function(o){var s=0,l=Lt(o.width,e,r);s=0===s?s:s-1;var d=t*o.depth-(t-n)*s;return-1!==a&&o.depth>a&&0===o.width&&(d+=i),{x:[l],y:[d],opactiy:1,timing:{duration:c}}},l=function(o){var s=0,l=Lt(o.width,e,r);s=0===s?s:s-1;var d=t*o.depth-(t-n)*s;return-1!==a&&o.depth>a&&0===o.width&&(d+=i),{x:[l],y:[d],opactiy:1,timing:{duration:c}}};return{enter:s,leave:o,update:l,start:o}}var Wt=Object(Ot.a)({marginTop:"2px",borderRadius:"2px",display:"inline-block",cursor:"pointer",fontFamily:"Lato,Helvetica Neue,Arial,Helvetica,sans-serif",fontSize:"14px",marginRight:"1px",$nest:{"&:hover":{backgroundColor:"#6c7c7c"},"&:active":{backgroundColor:"#6c7c7c"}}}),It=Object(Ot.a)({marginTop:"2px",borderRadius:"2px",display:"inline-block",cursor:"pointer",fontFamily:"Lato,Helvetica Neue,Arial,Helvetica,sans-serif",fontSize:"14px",$nest:{"&:hover":{backgroundColor:"#6c7c7c"},"&:active":{backgroundColor:"#6c7c7c"}}});var Bt=function(e){var t=e.graph,n=e.undoCallback,r=e.redoCallback;if(void 0===t)return null;var c=t.root===t.current,a=0===t.nodes[t.current].children.length,i={marginRight:"3px"};return Object(Fe.jsxs)("div",{children:[Object(Fe.jsxs)(wt.a,{className:Wt,disabled:c,variant:"outlined",onClick:n,children:[Object(Fe.jsx)("i",{className:"fas fa-undo marginRight",style:i}),"Undo"]}),Object(Fe.jsxs)(wt.a,{className:It,disabled:a,variant:"outlined",onClick:r,children:[Object(Fe.jsx)("i",{className:"fas fa-redo marginRight",style:i}),"Redo"]})]})},Tt=Object(Ot.a)({alignItems:"center",justifyContent:"center",overflow:"auto"});var Ft=Object(C.a)((function(e){var t=e.nodeMap,n=e.root,r=e.current,c=e.changeCurrent,a=e.width,i=void 0===a?400:a,o=e.height,s=void 0===o?800:o,l=e.iconOnly,u=void 0!==l&&l,j=e.gutter,h=void 0===j?15:j,b=e.backboneGutter,f=void 0===b?20:b,p=e.verticalSpace,O=void 0===p?50:p,x=e.annotationHeight,m=void 0===x?100:x,v=e.clusterVerticalSpace,y=void 0===v?50:v,w=e.regularCircleRadius,k=void 0===w?4:w,C=e.backboneCircleRadius,S=void 0===C?5:C,M=e.regularCircleStroke,N=void 0===M?3:M,L=e.backboneCircleStroke,E=void 0===L?3:L,z=e.sideOffset,P=void 0===z?200:z,W=e.topOffset,I=void 0===W?30:W,B=e.textSize,T=void 0===B?15:B,R=e.linkWidth,D=void 0===R?4:R,G=e.duration,H=void 0===G?600:G,J=e.clusterLabels,V=void 0===J||J,U=e.bundleMap,q=void 0===U?{}:U,$=e.eventConfig,X=e.popupContent,Y=e.annotationContent,Z=e.approvedFunction,K=e.rejectedFunction,Q=e.addToWorkflow,ee=e.currentDataset,te=e.nodeCreationMap,ne=e.editAnnotations,re=void 0!==ne&&ne,ce=e.prov,ae=e.ephemeralUndo,ie=void 0!==ae&&ae,oe=Object(d.useState)(!0),se=Object(g.a)(oe,2),le=se[0],de=se[1],ue=Object(d.useState)(null),je=Object(g.a)(ue,2),he=je[0],be=je[1],fe=Object(d.useState)(-1),pe=Object(g.a)(fe,2),ge=pe[0],Oe=pe[1],xe=[],me=new Set;for(var ve in t){var ye=t[ve];if(Object(F.isChildNode)(ye)&&(ye.metadata.eventType&&me.add(ye.metadata.eventType),"Ephemeral"===ye.actionType&&1===ye.children.length&&("Ephemeral"!==t[ye.parent].actionType||t[ye.parent].children.length>1))){for(var we=[],ke=ye;"Ephemeral"===ke.actionType&&(we.push(ke.id),1===ke.children.length&&"Ephemeral"===t[ke.children[0]].actionType);)ke=t[ke.children[0]];q[ye.id]={metadata:"",bundleLabel:"",bunchedNodes:we}}}q&&(xe=xe.concat(Object.keys(q)));var Ce=Object(d.useState)(Object.keys(q)),Se=Object(g.a)(Ce,2),Me=Se[0],Ne=Se[1];!$&&me.size>0&&me.size<8&&($=function(e){var t,n=[_.i().type(_.n).size(50),_.i().type(_.l),_.i().type(_.o),_.i().type(_.j),_.i().type(_.k),_.i().type(_.m),_.i().type(_.p)],r={},c=0,a=Object(bt.a)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;r[i]={},r[i].backboneGlyph=Object(Fe.jsx)("path",{className:Ct(!1),d:n[c](),strokeWidth:2}),r[i].bundleGlyph=Object(Fe.jsx)("path",{className:Ct(!1),d:n[c](),strokeWidth:2}),r[i].currentGlyph=Object(Fe.jsx)("path",{className:Ct(!0),d:n[c](),strokeWidth:2}),r[i].regularGlyph=Object(Fe.jsx)("path",{className:Ct(!1),d:n[c](),strokeWidth:2}),c+=1}}catch(o){a.e(o)}finally{a.f()}return r}(me)),Object(d.useEffect)((function(){de(!1)}),[]);var Ae=Object.values(t).filter((function(){return!0})),Le=Array.from(Ae),Ee=q?Object.keys(q):[],ze=[];if(q){var Pe,We=Object(bt.a)(Ee);try{for(We.s();!(Pe=We.n()).done;){var Ie=Pe.value;(ze=ze.concat(q[Ie].bunchedNodes)).push(Ie)}}catch(ct){We.e(ct)}finally{We.f()}}for(var Be=_.h().id((function(e){return e.id})).parentId((function(e){if(e.id===n)return null;if(Object(F.isChildNode)(e)){if(q&&Object.keys(q).includes(e.id)&&!Me.includes(e.id))for(var t=e,r=function(){var e=t;if(!ze.includes(e.parent)||Object.keys(q).includes(e.parent))return{v:e.parent};var n=Le.filter((function(t){return t.id===e.parent}))[0];Object(F.isChildNode)(n)&&(t=n)};;){var c=r();if("object"===typeof c)return c.v}var a,i=xt(e.parent,q),o=!0;for(var s in i)if(!Me.includes(i[s])){o=!1,a=i[s];break}return ze.includes(e.parent)&&q&&!Object.keys(q).includes(e.parent)&&!o?a:e.parent}return null})),Te=0;Te<Ae.length;Te++){var _e=xt(Ae[Te].id,q),Re=!0;for(var De in _e)if(!Me.includes(_e[De])){Re=!1;break}ze.includes(Ae[Te].id)&&!Re&&q&&!Object.keys(q).includes(Ae[Te].id)&&(Ae.splice(Te,1),Te--)}var Ge=Be(Ae),He=Ge.descendants(),Je={};He.forEach((function(e){Je[e.id]=e})),vt(Je,r,n);var Ve=0,Ue=0;for(var qe in He)He[qe].depth>Ve&&(Ve=He[qe].depth),He[qe].width>Ue&&(Ue=He[qe].width);var $e=Ge.links(),Xe=h,Ye=O;function Ze(e){if($){var t=e.metadata.eventType;if(t&&t in $&&"Root"!==t&&$[t].regularGlyph)return $[t].regularGlyph}return Object(Fe.jsx)("circle",{className:Ct(!1),r:k,strokeWidth:N})}function Ke(e){if($){var t=e.metadata.eventType;if(t&&t in $&&"Root"!==t)return $[t].bundleGlyph}return Object(Fe.jsx)("circle",{className:Ct(!1),r:k,strokeWidth:N})}var Qe=0;0===Ue?Qe=30:1===Ue?Qe=52:Ue>1&&(Qe=74);var et=i,tt=Object(Fe.jsx)("svg",{height:Ve<s?s:Ve,id:"bookmarkView",style:{overflow:"visible"},width:et,children:Object(Fe.jsx)("g",{id:"globalG",transform:mt(Qe,I),children:Object(Fe.jsx)(Nt,{currentNode:r,eventConfig:$,graph:ce?ce.graph:void 0})})}),nt=Object(Fe.jsxs)("div",{children:[Object(Fe.jsx)("div",{id:"undoRedoDiv",children:Object(Fe.jsx)(Bt,{graph:ce?ce.graph:void 0,redoCallback:function(){ce&&(ie?ce.goForwardToNonEphemeral():ce.goForwardOneStep())},undoCallback:function(){ce&&(ie?ce.goBackToNonEphemeral():ce.goBackOneStep())}})}),Object(Fe.jsxs)("svg",{height:Ve<s?s:Ve,id:"topSvg",style:{overflow:"visible"},width:et,children:[Object(Fe.jsx)("rect",{fill:"none",height:s,stroke:"none",width:i}),Object(Fe.jsxs)("g",{id:"globalG",transform:mt(Qe,I),children:[Object(Fe.jsx)(ft.b,Object(A.a)(Object(A.a)({data:$e,keyAccessor:function(e){return"".concat(e.source.id).concat(e.target.id)}},At(Xe,Ye,y,f-h,H,ge,m)),{},{children:function(e){return Object(Fe.jsx)(Fe.Fragment,{children:e.map((function(e){var t=e.key,n=e.state;return Object(Fe.jsx)("g",{children:Object(Fe.jsx)(zt,Object(A.a)(Object(A.a)({},n),{},{fill:"#ccc",stroke:"#ccc",strokeWidth:D}))},t)}))})}})),Object(Fe.jsx)(ft.b,Object(A.a)(Object(A.a)({data:He,keyAccessor:function(e){return e.id}},Pt(Xe,Ye,y,f-h,H,ge,m)),{},{children:function(e){return Object(Fe.jsx)(Fe.Fragment,{children:e.map((function(e){var t=e.data,n=e.key,a=e.state;return Object(Fe.jsx)("g",{transform:(t.width,mt(a.x,a.y)),onClick:function(){c&&c(t.id)},onMouseOut:function(){be(null)},onMouseOver:function(){be(t.id)},children:0===t.width&&ce?Object(Fe.jsxs)("g",{children:[Object(Fe.jsx)("rect",{height:"25",opacity:"0",transform:"translate(0, -12.5)",width:"200"}),",",Object(Fe.jsx)(St,{addToWorkflow:Q,annotationContent:Y,annotationOpen:ge,approvedFunction:Z,bookmark:he,bundleMap:q,clusterLabels:V,current:r===t.id,currentDataset:ee,duration:H,editAnnotations:re,eventConfig:$,exemptList:Me,expandedClusterList:Me,first:le,iconOnly:u,node:t.data,nodeCreationMap:te,nodeMap:Je,popupContent:X,prov:ce,radius:S,rejectedFunction:K,setAnnotationOpen:Oe,setBookmark:be,setExemptList:Ne,strokeWidth:E,textSize:T})]}):void 0!==X?Object(Fe.jsx)(pt.a,{content:X(t.data),trigger:Object(Fe.jsx)("g",{onClick:function(){Oe(-1)},children:Ee.includes(t.id)?Ke(t.data):Ze(t.data)})}):Object(Fe.jsx)("g",{onClick:function(){Oe(-1)},children:Ze(t.data)})},n)}))})}})),Object(Fe.jsx)(ft.b,Object(A.a)(Object(A.a)({data:Ee,keyAccessor:function(e){return"".concat(e)}},Et(Xe,O,y,f-h,H,Me,Je,He,ge,m,q)),{},{children:function(e){return Object(Fe.jsx)(Fe.Fragment,{children:e.map((function(e){var t=e.key,n=e.state;return void 0===q||0!==Je[e.key].width||!1===n.validity?null:Object(Fe.jsx)("g",{transform:mt(n.x-h+5,n.y-y/2),children:Object(Fe.jsx)("rect",{fill:"none",height:n.height,rx:"10",ry:"10",stroke:"rgb(248, 191, 132)",strokeWidth:"2px",style:{opacity:n.opacity},width:u?42:P-15})},t)}))})}}))]})]})]}),rt=[{menuItem:{key:"Graph",icon:"share alternate",content:"Graph"},render:function(){return Object(Fe.jsx)(gt.a.Pane,{attached:!1,children:nt})}},{menuItem:{key:"Bookmarks/Annotations",icon:"bookmark",content:"Bookmarks/Annotations"},render:function(){return Object(Fe.jsx)(gt.a.Pane,{attached:!1,children:tt})}}];return Object(Fe.jsx)("div",{className:Tt,id:"prov-vis",style:{overflowX:"auto",overflowY:"auto"},children:Object(Fe.jsx)(gt.a,{menu:{secondary:!0,pointing:!0},panes:rt})})}));function _t(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Fe.jsxs)("g",{children:[Object(Fe.jsx)("circle",{fill:"white",r:n-n/4}),Object(Fe.jsx)("g",{children:Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf0b0"})})]})}function Rt(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Fe.jsxs)("g",{children:[Object(Fe.jsx)("circle",{fill:"white",r:n-n/4}),Object(Fe.jsx)("g",{children:Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf057"})})]})}function Dt(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Fe.jsxs)("g",{children:[Object(Fe.jsx)("circle",{fill:"white",r:n-n/4}),Object(Fe.jsx)("g",{children:Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf044"})})]})}function Gt(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Fe.jsxs)("g",{children:[Object(Fe.jsx)("circle",{fill:"white",r:n-n/4}),Object(Fe.jsx)("g",{children:Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf042"})})]})}function Ht(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Fe.jsxs)("g",{children:[Object(Fe.jsx)("circle",{fill:"white",r:n-n/4}),Object(Fe.jsx)("g",{transform:lt(-n/2,-n/2),children:Object(Fe.jsx)("svg",{height:n,viewBox:"0 0 141.75 141.75",width:n,children:Object(Fe.jsxs)("g",{id:"Layer 1",children:[Object(Fe.jsx)("path",{d:"M11.34-11.34L11.6801+130.41L153.09+130.41",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"miter",strokeWidth:"25"}),Object(Fe.jsx)("path",{d:"M41.0944+103.248C41.0944+96.3307+46.8061+90.7234+53.8519+90.7234C60.8977+90.7234+66.6094+96.4351+66.6094+103.481C66.6094+110.527+60.8977+116.238+53.8519+116.238C46.8061+116.238+41.0944+110.165+41.0944+103.248Z",fill:c,opacity:"1"}),Object(Fe.jsx)("path",{d:"M28.3369+70.6417C28.3369+63.7248+34.0486+58.1175+41.0944+58.1175C48.1402+58.1175+53.8519+63.8292+53.8519+70.875C53.8519+77.9208+48.1402+83.6325+41.0944+83.6325C34.0486+83.6325+28.3369+77.5587+28.3369+70.6417Z",fill:c,opacity:"1"}),Object(Fe.jsx)("path",{d:"M66.6094+83.3992C66.6094+76.4823+72.3211+70.875+79.3669+70.875C86.4127+70.875+92.1244+76.5867+92.1244+83.6325C92.1244+90.6783+86.4127+96.39+79.3669+96.39C72.3211+96.39+66.6094+90.3162+66.6094+83.3992Z",fill:c,opacity:"1"}),Object(Fe.jsx)("path",{d:"M53.8519+57.8842C53.8519+50.9673+59.5636+45.36+66.6094+45.36C73.6552+45.36+79.3669+51.0717+79.3669+58.1175C79.3669+65.1633+73.6552+70.875+66.6094+70.875C59.5636+70.875+53.8519+64.8012+53.8519+57.8842Z",fill:c,opacity:"1"}),Object(Fe.jsx)("path",{d:"M101.341+31.4476C101.341+24.5307+107.053+18.9234+114.098+18.9234C121.144+18.9234+126.856+24.6352+126.856+31.6809C126.856+38.7267+121.144+44.4384+114.098+44.4384C107.053+44.4384+101.341+38.3646+101.341+31.4476Z",fill:c,opacity:"1"}),Object(Fe.jsx)("path",{d:"M90.001+31.2403C90.001+18.175+100.79+7.58342+114.098+7.58342C127.407+7.58342+138.196+18.3722+138.196+31.6809C138.196+44.9896+127.407+55.7784+114.098+55.7784C100.79+55.7784+90.001+44.3056+90.001+31.2403Z",fill:"none",opacity:"1",stroke:c,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"})]})})})]})}function Jt(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Fe.jsxs)("g",{children:[Object(Fe.jsx)("circle",{fill:"white",r:n-n/4}),Object(Fe.jsx)("g",{children:Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf5cb"})})]})}function Vt(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Fe.jsxs)("g",{children:[Object(Fe.jsx)("circle",{fill:"white",r:n-n/4}),Object(Fe.jsx)("g",{children:Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf12d"})})]})}function Ut(e){var t=e.size,n=void 0===t?15:t,r=e.fill,c=void 0===r?"#ccc":r;return Object(Fe.jsxs)("g",{children:[Object(Fe.jsx)("circle",{fill:"white",r:n-n/4}),Object(Fe.jsx)("g",{children:Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:c,fontFamily:"FontAwesome",fontSize:n,textAnchor:"middle",children:"\uf1fc"})})]})}Object(E.configure)({isolateGlobalState:!0});var qt={"Point Selection":{backboneGlyph:Object(Fe.jsx)(Ut,{size:22}),currentGlyph:Object(Fe.jsx)(Ut,{fill:"#2185d0",size:22}),regularGlyph:Object(Fe.jsx)(Ut,{size:16}),bundleGlyph:Object(Fe.jsx)(Ut,{fill:"#2185d0",size:22})},"Point Deselection":{backboneGlyph:Object(Fe.jsx)(Vt,{size:22}),currentGlyph:Object(Fe.jsx)(Vt,{fill:"#2185d0",size:22}),regularGlyph:Object(Fe.jsx)(Vt,{size:16}),bundleGlyph:Object(Fe.jsx)(Vt,{fill:"#2185d0",size:22})},"Add Brush":{backboneGlyph:Object(Fe.jsx)(Jt,{size:22}),currentGlyph:Object(Fe.jsx)(Jt,{fill:"#2185d0",size:22}),regularGlyph:Object(Fe.jsx)(Jt,{size:16}),bundleGlyph:Object(Fe.jsx)(Jt,{fill:"#2185d0",size:22})},"Algorithmic Selection":{backboneGlyph:Object(Fe.jsx)(Ht,{size:22}),currentGlyph:Object(Fe.jsx)(Ht,{fill:"#2185d0",size:22}),regularGlyph:Object(Fe.jsx)(Ht,{size:16}),bundleGlyph:Object(Fe.jsx)(Ht,{fill:"#2185d0",size:22})},Invert:{backboneGlyph:Object(Fe.jsx)(Gt,{size:22}),currentGlyph:Object(Fe.jsx)(Gt,{fill:"#2185d0",size:22}),regularGlyph:Object(Fe.jsx)(Gt,{size:16}),bundleGlyph:Object(Fe.jsx)(Gt,{fill:"#2185d0",size:22})},"Update Brush":{backboneGlyph:Object(Fe.jsx)(Dt,{size:22}),currentGlyph:Object(Fe.jsx)(Dt,{fill:"#2185d0",size:22}),regularGlyph:Object(Fe.jsx)(Dt,{size:16}),bundleGlyph:Object(Fe.jsx)(Dt,{fill:"#2185d0",size:22})},"Remove Brush":{backboneGlyph:Object(Fe.jsx)(Rt,{size:22}),currentGlyph:Object(Fe.jsx)(Rt,{fill:"#2185d0",size:22}),regularGlyph:Object(Fe.jsx)(Rt,{size:16}),bundleGlyph:Object(Fe.jsx)(Rt,{fill:"#2185d0",size:22})},Filter:{backboneGlyph:Object(Fe.jsx)(_t,{size:22}),currentGlyph:Object(Fe.jsx)(_t,{fill:"#2185d0",size:22}),regularGlyph:Object(Fe.jsx)(_t,{size:16}),bundleGlyph:Object(Fe.jsx)(_t,{fill:"#ccc",size:22})}},$t=Object(C.a)((function(){var e=Be(),t=e.projectStore,n=t.datasetVersionFromKey,r=t.dataset_id,c=e.exploreStore,a=c.nodeCreationMap,i=c.provenance,o=c.approveNode,s=c.rejectNode,l=c.workflow,u=i.graph,j=Object(d.useCallback)((function(e){i.goToNode(e)}),[i]),h=Object(d.useCallback)((function(e){l&&!l.doesCurrentHaveWorkflow&&l.addToWorkflow(e)}),[l]);return Object(Fe.jsx)(Ft,{addToWorkflow:h,approvedFunction:o,backboneGutter:40,changeCurrent:j,current:u.current,currentDataset:n(r),ephemeralUndo:!1,eventConfig:qt,nodeCreationMap:a,nodeMap:u.nodes,prov:i,rejectedFunction:s,root:u.root,width:250,undoRedoButtons:!0},u.root)})),Xt=n(627),Yt=n(628),Zt=n(629),Kt=n(327),Qt=n.n(Kt),en=n(219),tn=n.n(en),nn=n(667),rn=n(630),cn=Object(O.a)((function(){return Object(Ge.a)({root:{minWidth:250},content:{display:"flex",justifyContent:"center"}})})),an=Object(C.a)((function(){var e=cn(),t=Be().exploreStore,n=t.brushType,r=t.switchBrush;return Object(Fe.jsxs)(Xt.a,{className:e.root,children:[Object(Fe.jsx)(Yt.a,{title:"Brush Type"}),Object(Fe.jsx)(Zt.a,{className:e.content,children:Object(Fe.jsxs)(nn.a,{size:"small",value:n,exclusive:!0,onChange:function(e,t){return r(t)},children:[Object(Fe.jsx)(rn.a,{value:"Rectangular",children:Object(Fe.jsx)(Qt.a,{})}),Object(Fe.jsx)(rn.a,{value:"Freeform Small",children:Object(Fe.jsx)(tn.a,{fontSize:"small"})}),Object(Fe.jsx)(rn.a,{value:"Freeform Medium",children:Object(Fe.jsx)(tn.a,{})}),Object(Fe.jsx)(rn.a,{value:"Freeform Large",children:Object(Fe.jsx)(tn.a,{fontSize:"large"})})]})})]})})),on=n(351),sn=n(632),ln=n(158),dn=n(633),un=n(118),jn=n(631),hn=n(660),bn=Object(d.createContext)(null),fn=Object(O.a)({root:{display:"flex"}}),pn=Object(C.a)((function(e){var t=e.disabled,n=void 0!==t&&t,r=e.path,c=e.shape,a=e.label,i=e.onClick,o=e.onMouseEnter,s=e.onMouseLeave,l=e.width,d=void 0===l?25:l,u=e.transform,j=void 0===u?"rotate(0)":u,h=fn(),b=Be().exploreStore,f=b.setHighlightMode,p=b.setHighlightPredicate;return Object(Fe.jsx)("div",{className:h.root,children:Object(Fe.jsx)(un.a,{disabled:n,startIcon:Object(Fe.jsxs)("svg",{height:"25",viewBox:"0 0 25 25",width:d,children:[r&&Object(Fe.jsx)("path",{d:r,opacity:"0.5",transform:"".concat(lt(12.5)).concat(j)}),c&&c]}),onClick:function(){i&&i()},onMouseEnter:function(){o?o():(f(!0),p((function(e){return e.category===a})))},onMouseLeave:function(){s?s():(f(!1),p(null))},children:a})})})),gn=Object(jn.a)(),On=Object(O.a)((function(e){return Object(Ge.a)({root:{minWidth:250},fc:{margin:e.spacing(1),minWidth:200},form:{"& .MuiTextField-root":{margin:e.spacing(1),width:"25ch"}}})})),xn=Object(C.a)((function(){var e=On(),t=Be(),n=t.exploreStore,r=n.toggleShowCategories,c=n.doesHaveCategories,a=n.data,i=n.changeCategoryColumn,o=n.handleCategorization,s=n.selections,l=t.projectStore.addCategoryColumn,u=Object(d.useContext)(bn)||{},j=u.showCategory,h=void 0!==j&&j,b=u.selectedCategoryColumn,f=void 0===b?null:b,p=u.categoryMap,O=void 0===p?{}:p,x=Object(d.useMemo)((function(){return a?a.categoricalColumns.map((function(e){return{title:e}})):[]}),[a]),w=Object(d.useState)(!1),k=Object(g.a)(w,2),C=k[0],S=k[1],M=Object(d.useState)({name:"",options:""}),L=Object(g.a)(M,2),E=L[0],z=L[1],P=function(){z({name:"",options:""}),S(!1)};return a?Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsxs)(Xt.a,{className:e.root,children:[Object(Fe.jsx)(Yt.a,{action:Object(Fe.jsx)(N.a,{checked:h,disabled:!c,size:"small",onChange:r}),subheader:"Enable category encoding",title:"Categories"}),c?Object(Fe.jsxs)(Zt.a,{children:[Object(Fe.jsx)(hn.a,{disabled:!h,filterOptions:function(e,t){var n=gn(e,t);return""!==t.inputValue&&n.push({inputValue:t.inputValue,title:'Add "'.concat(t.inputValue,'"')}),n},getOptionLabel:function(e){return"string"===typeof e?e:e.inputValue?e.inputValue:e.title},getOptionSelected:function(e,t){return e.title===t.title},options:x,renderInput:function(e){return Object(Fe.jsx)(on.a,Object(A.a)(Object(A.a)({},e),{},{label:"Showing categories",variant:"outlined"}))},renderOption:function(e){return Object(Fe.jsx)(qe.a,{variant:"button",children:e.title.toUpperCase()})},value:f?{title:f}:null,clearOnBlur:!0,handleHomeEndKeys:!0,selectOnFocus:!0,onChange:function(e,t){"string"===typeof t?setTimeout((function(){S(!0),z({name:t,options:""})})):t&&t.inputValue?(S(!0),z({name:t.inputValue,options:""})):i((null===t||void 0===t?void 0:t.title)||null)}}),null===f?Object(Fe.jsx)(Zt.a,{children:"Loading..."}):Object.entries(O).map((function(e){var t=Object(g.a)(e,2),n=t[0],r=t[1];return Object(Fe.jsx)(pn,{disabled:!h,label:n,path:Object(_.i)(r).size(100)(),onClick:function(){s.length>0&&o(f,n)}},n)}))]}):Object(Fe.jsx)(Zt.a,{children:"No category column in the dataset!"})]}),Object(Fe.jsx)(m.a,{open:C,onClose:P,children:Object(Fe.jsxs)("form",{className:e.form,onSubmit:function(e){e.preventDefault(),l(E.name,E.options),S(!1)},children:[Object(Fe.jsx)(v.a,{children:"Add a new categorical dimension."}),Object(Fe.jsxs)(y.a,{children:[Object(Fe.jsx)(sn.a,{children:"Specify the options you want, seperated by commas (,)"}),Object(Fe.jsx)(on.a,{id:"category-name",label:"Category Name",type:"text",value:E.name,autoFocus:!0,onChange:function(e){return z(Object(A.a)(Object(A.a)({},E),{},{name:e.target.value}))}}),Object(Fe.jsx)(ln.a,{fullWidth:!0,children:Object(Fe.jsx)(on.a,{helperText:"Max ".concat(_.q.length-1," options supported."),id:"category-options",label:"Options",type:"text",value:E.options,autoFocus:!0,fullWidth:!0,multiline:!0,onChange:function(e){return z(Object(A.a)(Object(A.a)({},E),{},{options:e.target.value}))}})})]}),Object(Fe.jsxs)(dn.a,{children:[Object(Fe.jsx)(un.a,{onClick:P,children:"Cancel"}),Object(Fe.jsx)(un.a,{disabled:0===E.options.length||E.options.split(",").length>=_.q.length,type:"submit",children:"Add"})]})]})})]}):Object(Fe.jsx)("div",{children:"Loading"})})),mn=n(655),vn=n(344),yn=n(119),wn=n(208),kn=n.n(wn),Cn=n(634),Sn=n(147),Mn=n.n(Sn),Nn=n(329),An=n.n(Nn),Ln=n(328),En=n.n(Ln),zn=n(223),Pn=n(222),Wn=n(563),In=Object(O.a)((function(e){return Object(Ge.a)({formControl:{margin:e.spacing(1),minWidth:200},selectEmpty:{marginTop:e.spacing(2)}})})),Bn=Object(C.a)((function(e){var t=e.open,n=e.onSet,r=e.onClose,c=In(),a=Be().exploreStore.data,i=(Object(d.useContext)(bn)||{}).setAggregateOptions,o=void 0===i?function(){throw new Error("SOmething went wrong")}:i,s=Object(d.useState)({}),l=Object(g.a)(s,2),u=l[0],j=l[1];Object(d.useEffect)((function(){if(a&&0===Object.keys(u).length){var e=a.numericColumns,t={};e.forEach((function(e){t[e]="Mean"})),j(t)}}),[u,a]);var h=["Mean","Median","Sum","Min","Max"];if(!a)return Object(Fe.jsx)("div",{children:"Loading..."});var b=a.numericColumns,f=void 0===b?[]:b,p=a.columnInfo,O=Object.keys(u).length===f.length;return Object(Fe.jsxs)(m.a,{open:t,onClose:r,children:[Object(Fe.jsx)(v.a,{children:"Aggregate"}),Object(Fe.jsxs)(y.a,{children:[Object(Fe.jsx)(sn.a,{children:"Select how each numeric column should be aggregated."}),f.map((function(e){return Object(Fe.jsx)("div",{children:Object(Fe.jsxs)(ln.a,{className:c.formControl,children:[Object(Fe.jsx)(zn.a,{id:"".concat(e,"_label"),children:p[e].fullname}),Object(Fe.jsx)(Pn.a,{id:e,labelId:"".concat(e,"_label"),value:u[e],onChange:function(t){j((function(n){return Object(A.a)(Object(A.a)({},n),{},Object(B.a)({},e,t.target.value))}))},children:h.map((function(e){return Object(Fe.jsx)(yn.a,{value:e,children:e},e)}))}),Object(Fe.jsx)(Wn.a,{children:p[e].unit})]})},e)}))]}),Object(Fe.jsxs)(dn.a,{children:[Object(Fe.jsx)(un.a,{onClick:r,children:"Cancel"}),Object(Fe.jsx)(un.a,{disabled:!O,onClick:function(){localStorage.setItem("aggOpt",JSON.stringify(u)),o(u),r(),n()},children:"Set"})]})]})})),Tn=Object(C.a)((function(){var e=Be().exploreStore,t=e.state,n=e.handleAggregate,r=e.hideAggregateMembers,c=e.toggleHideAggregateMembers,a=Object(d.useState)(!1),i=Object(g.a)(a,2),o=i[0],s=i[1],l=(Object(d.useContext)(bn)||{}).aggregateOptions,u=0===ve(t).length,j=Object(d.useState)(""),h=Object(g.a)(j,2),b=h[0],f=h[1],p=Object(d.useState)(!1),O=Object(g.a)(p,2),x=O[0],m=O[1];return Object(Fe.jsxs)(mn.a,{m:1,children:[Object(Fe.jsx)(un.a,{color:"primary",variant:"outlined",onClick:function(){null===l?s(!0):m(!x)},children:"Aggregate"}),Object(Fe.jsx)(Ze.a,{size:"medium",onClick:function(){return c()},children:r?Object(Fe.jsx)(En.a,{}):Object(Fe.jsx)(An.a,{})}),Object(Fe.jsx)(Bn,{open:o,onClose:function(){return s(!1)},onSet:function(){m(!0)}}),x&&Object(Fe.jsx)(on.a,{InputProps:{endAdornment:Object(Fe.jsx)(Cn.a,{position:"end",children:Object(Fe.jsx)(Ze.a,{color:"primary",disabled:0===b.length||u,size:"small",onClick:function(){l&&(n(b,l),f(""),m(!1))},children:Object(Fe.jsx)(Mn.a,{})})})},value:b,onChange:function(e){return f(e.target.value)}})]})})),Fn=Object(C.a)((function(){var e=Be().exploreStore,t=e.showLabelLayer,n=e.toggleLabelLayer,r=e.handleLabelling,c=e.state,a=e.setHighlightMode,i=e.setHighlightPredicate,o=(Object(d.useContext)(bn)||{}).labelMap,s=void 0===o?{}:o,l=Object(d.useState)(""),u=Object(g.a)(l,2),j=u[0],h=u[1],b=Object(d.useState)(!1),f=Object(g.a)(b,2),p=f[0],O=f[1],x=0===ve(c).length;return Object(Fe.jsxs)(mn.a,{m:1,children:[Object(Fe.jsx)(un.a,{color:"primary",variant:"outlined",onClick:function(){p||n(!0),O(!p),h("")},children:"Label"}),Object(Fe.jsx)(N.a,{checked:t,color:"primary",size:"small",onChange:function(){return n()}}),p&&Object(Fe.jsx)(on.a,{InputProps:{endAdornment:Object(Fe.jsx)(Cn.a,{position:"end",children:Object(Fe.jsx)(Ze.a,{color:"primary",disabled:0===j.length||x,size:"small",onClick:function(){r(j),h(""),O(!1)},children:Object(Fe.jsx)(Mn.a,{})})})},value:j,onChange:function(e){return h(e.target.value)}}),Object(Fe.jsx)("div",{children:t&&Object.entries(s).map((function(e){var t=Object(g.a)(e,2),n=t[0],r=t[1];return Object(Fe.jsx)("div",{children:Object(Fe.jsx)(un.a,{startIcon:Object(Fe.jsx)("svg",{height:"25",viewBox:"0 0 25 25",width:"25",children:Object(Fe.jsx)("circle",{className:r,r:"5",transform:lt(12.5)})},n),disableFocusRipple:!0,disableRipple:!0,onMouseEnter:function(){a(!0),i((function(e){return(e.customlabel||[]).includes(n)}))},onMouseLeave:function(){a(!1),i(null)},children:n})},n)}))})]})})),_n=Object(O.a)((function(){return Object(Ge.a)({root:{minWidth:250},content:{display:"flex",justifyContent:"center"}})})),Rn=Object(C.a)((function(){var e=_n(),t=Be().exploreStore.handleFilter,n=Object(d.useState)(null),r=Object(g.a)(n,2),c=r[0],a=r[1],i=function(e){return e(null)};return Object(Fe.jsxs)(Xt.a,{className:e.root,children:[Object(Fe.jsx)(Yt.a,{title:"Transforms"}),Object(Fe.jsxs)(Zt.a,{children:[Object(Fe.jsxs)(mn.a,{m:1,children:[Object(Fe.jsx)(un.a,{color:"primary",endIcon:Object(Fe.jsx)(kn.a,{}),variant:"outlined",onClick:function(e){return t=a,n=e.currentTarget,void t(n);var t,n},children:"Filter"}),Object(Fe.jsxs)(vn.a,{anchorEl:c,anchorOrigin:{vertical:"top",horizontal:"right"},open:Boolean(c),keepMounted:!0,onClose:function(){return i(a)},children:[Object(Fe.jsx)(yn.a,{onClick:function(){t("In"),i(a)},children:"In"}),Object(Fe.jsx)(yn.a,{onClick:function(){t("Out"),i(a)},children:"Out"})]})]}),Object(Fe.jsx)(Fn,{}),Object(Fe.jsx)(Tn,{})]})]})})),Dn=Object(O.a)((function(e){return Object(Ge.a)({root:{display:"flex",flexFlow:"column",gap:e.spacing(1),padding:e.spacing(2)}})})),Gn=Object(C.a)((function(e){var t=e.classes,n=void 0===t?[]:t,r=Dn();return Object(Fe.jsxs)("div",{className:Object(st.a)(n,r.root),children:[Object(Fe.jsx)(an,{}),Object(Fe.jsx)(Rn,{}),Object(Fe.jsx)(xn,{})]})})),Hn=n(40),Jn=n(220),Vn=n(662),Un=n(330),qn=n.n(Un),$n=n(331),Xn=n.n($n),Yn=n(209),Zn=n.n(Yn),Kn=n(668),Qn=n(669),er=n(635),tr=Object(O.a)((function(e){return Object(Ge.a)({formControl:{margin:e.spacing(1),minWidth:200},selectEmpty:{marginTop:e.spacing(2)}})})),nr=Object(C.a)((function(e){var t=e.show,n=e.onClose,r=tr(),c=Be().exploreStore,a=c.data,i=c.addScatterplot,o=Object(d.useState)(""),s=Object(g.a)(o,2),l=s[0],u=s[1],j=Object(d.useState)(""),h=Object(g.a)(j,2),b=h[0],f=h[1],p=Object(d.useCallback)((function(){u(""),f(""),n()}),[n]);return a?Object(Fe.jsxs)(m.a,{open:t,onClose:p,children:[Object(Fe.jsxs)(y.a,{children:[Object(Fe.jsx)(sn.a,{children:"Select dimensions"}),Object(Fe.jsxs)(ln.a,{className:r.formControl,children:[Object(Fe.jsx)(zn.a,{id:"x-col-label",children:"X"}),Object(Fe.jsx)(Pn.a,{id:"x-col",labelId:"x-col-label",value:l,onChange:function(e){u(e.target.value)},children:a.numericColumns.map((function(e){return Object(Fe.jsx)(yn.a,{value:e,children:e},e)}))})]}),Object(Fe.jsxs)(ln.a,{className:r.formControl,children:[Object(Fe.jsx)(zn.a,{id:"y-col-label",children:"Y"}),Object(Fe.jsx)(Pn.a,{id:"y-col",labelId:"y-col-label",value:b,onChange:function(e){f(e.target.value)},children:a.numericColumns.map((function(e){return Object(Fe.jsx)(yn.a,{value:e,children:e},e)}))})]})]}),Object(Fe.jsxs)(dn.a,{children:[Object(Fe.jsx)(wt.a,{onClick:p,children:"Cancel"}),Object(Fe.jsx)(wt.a,{disabled:!l||!b,onClick:function(){i(l,b),p()},children:"Add"})]})]}):Object(Fe.jsx)("div",{children:"Test"})})),rr=Object(O.a)((function(){return{brushStyle:{cursor:"grabbing",stroke:"gray",opacity:1,transition:"opacity 0.5s"},brushDownSelection:{stroke:"#028A0F"},brushDownDeselection:{stroke:"rgb(244, 106, 15)"},brushHide:{opacity:0,transition:"opacity 0.5s"}}}));function cr(e,t,n){var r=Math.pow(n.x-e.x,2),c=Math.pow(n.y-e.y,2);return Math.sqrt(r+c)<=t}var ar=Object(C.a)((function(e){var t,n=e.left,r=void 0===n?0:n,c=e.right,a=void 0===c?0:c,i=e.top,o=void 0===i?0:i,s=e.bottom,l=void 0===s?0:s,u=e.extentPadding,j=void 0===u?0:u,h=e.onBrush,b=e.xScale,f=e.yScale,p=e.brushSize,O=void 0===p?35:p,x=e.data,m=void 0===x?[]:x,v=rr(),y=v.brushStyle,w=v.brushDownSelection,k=v.brushDownDeselection,C=v.brushHide,S=Object(d.useRef)(null),M=Object(d.useRef)(null),N=Object(d.useRef)([]),A=O||20,L=Object(d.useState)(!1),E=Object(g.a)(L,2),z=E[0],P=E[1],W=Object(d.useState)(!1),I=Object(g.a)(W,2),T=I[0],F=I[1],R=Object(d.useState)(-1),D=Object(g.a)(R,2),G=D[0],H=D[1],J={0:"Selection",2:"Deselection"},V=[Math.abs(l+j-(o-j)),Math.abs(r-j-(a+j))],U=V[0],q=V[1],$=function(e,t,n,r){var c=e.left,a=e.top,i=e.width,o=e.height,s=Object(d.useMemo)((function(){return Object(_.c)().extent([[c-1,a-1],[i+1,o+1]]).x((function(e){return n(e.x)})).y((function(e){return r(e.y)})).addAll(t)}),[c,a,i,o,t,n,r]);return{search:function(e,t,c){var a=e-c,i=e+c,o=t-c,l=t+c,d=[];return s.visit((function(s,u,j,h,b){if(!s.length){var f=s;do{var p=f,g=p.data,O=p.data,x=O.x,m=O.y;cr({x:e,y:t},c,{x:n(x),y:r(m)})&&d.push(g.id)}while(f=f.next)}return u>=i||j>=l||h<a||b<o})),d}}}({left:r,top:o,width:q,height:U},m,b,f).search;function X(){M.current&&(h(Array.from(new Set(N.current)),"End",J[G]),N.current=[]),F(!1),H(-1)}function Y(e){if(z){var t=S.current,n=M.current;if(t&&n){var r=n.getBoundingClientRect(),c=e.clientX-r.left,a=e.clientY-r.top,i=Object(_.g)(t),o=a+A>=U+10||a-A<=-10;if(c+A>=q+10||c-A<=-10||i.attr("cx",c),o||i.attr("cy",a),T){var s,l=$(c,a,A);(s=N.current).push.apply(s,Object(xe.a)(l)),h(l,"Brushing",J[G])}}}}function Z(){window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",X)}return Object(d.useEffect)((function(){return window.addEventListener("mousemove",Y),window.addEventListener("mouseup",X),Z})),Object(Fe.jsxs)("g",{transform:lt(-j,-j),onContextMenu:function(e){return e.preventDefault()},onMouseDown:function(e){var t=M.current;if(H(e.button),F(!0),t){var n=t.getBoundingClientRect(),r=e.clientX-n.left,c=e.clientY-n.top,a=$(r,c,A);N.current=a,h(a,"Start",J[G])}},onMouseEnter:function(){return P(!0)},onMouseLeave:function(){T||P(!1)},children:[Object(Fe.jsx)("rect",{ref:M,fill:"none",height:U,pointerEvents:"all",width:q}),Object(Fe.jsx)("circle",{ref:S,className:Object(st.a)(y,(t={},Object(B.a)(t,w,T&&0===G),Object(B.a)(t,k,T&&2===G),Object(B.a)(t,C,!z),t)),fill:"none",pointerEvents:T?"all":"initial",r:A,strokeWidth:"2"})]})})),ir=Object(O.a)((function(){return Object(Ge.a)({shadow:{textShadow:"0 0 5px white"}})})),or=function(e){return e>=1e6?"".concat(e.toString()[0],"e").concat(e.toString().length-1):e>=5e5?"".concat(e/1e5,"M"):e>=1e3?"".concat(e/1e3,"K"):e},sr=Object(C.a)((function(e){var t=e.transform,n=void 0===t?"":t,r=e.label,c=e.type,a=e.scale,i=e.margin,o=e.showLabel,s=void 0===o||o,l=e.tickFormatter,u=void 0===l?or:l,j=ir(),h=Object(d.useMemo)((function(){var e=a.range(),t=Math.abs(e[1]-e[0]),n=Math.max(1,Math.floor(t/50));return{ticks:a.ticks(n).map((function(e){return{value:e,formattedValue:u(e),offset:a(e)}})),extent:t}}),[a,u,50]),b=h.ticks,f=h.extent,p=function(e,t){switch(e){case"bottom":return lt(t,0);case"left":return lt(0,t);case"top":return lt(t,0);case"right":return lt(0,t)}},g=function(e){var t=e.type,n=e.value;switch(t){case"bottom":return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:"none",fontSize:"".concat(1,"rem"),stroke:"white",strokeLinejoin:"round",strokeWidth:"4",textAnchor:"end",transform:lt(0,17.200000000000003),children:n}),Object(Fe.jsx)("line",{stroke:"currentColor",y2:6}),Object(Fe.jsx)("text",{className:j.shadow,dominantBaseline:"middle",fontSize:"".concat(1,"rem"),textAnchor:"middle",transform:lt(0,17.200000000000003),children:n})]});case"left":return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:"none",fontSize:"".concat(1,"rem"),stroke:"white",strokeLinejoin:"round",strokeWidth:"4",textAnchor:"end",transform:lt(-10,0),children:n}),Object(Fe.jsx)("line",{stroke:"currentColor",transform:lt(-6,0),x1:6}),Object(Fe.jsx)("text",{className:j.shadow,dominantBaseline:"middle",fontSize:"".concat(1,"rem"),textAnchor:"end",transform:lt(-10,0),children:n})]});case"top":return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:"none",fontSize:"".concat(1,"rem"),stroke:"white",strokeLinejoin:"round",strokeWidth:"4",textAnchor:"end",transform:lt(0,-17.200000000000003),children:n}),Object(Fe.jsx)("line",{stroke:"currentColor",transform:lt(0,-6),y2:6}),Object(Fe.jsx)("text",{className:j.shadow,dominantBaseline:"middle",fontSize:"".concat(1,"rem"),textAnchor:"middle",transform:lt(0,-17.200000000000003),children:n})]});case"right":return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)("text",{dominantBaseline:"middle",fill:"none",fontSize:"".concat(1,"rem"),stroke:"white",strokeLinejoin:"round",strokeWidth:"4",textAnchor:"end",transform:lt(10,0),children:n}),Object(Fe.jsx)("line",{stroke:"currentColor",x1:6}),Object(Fe.jsx)("text",{className:j.shadow,dominantBaseline:"middle",fontSize:"".concat(1,"rem"),textAnchor:"start",transform:lt(10,0),children:n})]})}};return Object(Fe.jsxs)("g",{transform:n,children:[Object(Fe.jsx)("path",{d:function(e){switch(e){case"bottom":return"M 0 ".concat(6," v -").concat(6," H ").concat(f," v ").concat(6);case"left":return"M -".concat(6," 0 h ").concat(6," V ").concat(f," h -").concat(6);case"top":return"M 0 -".concat(6," v ").concat(6," H ").concat(f," v -").concat(6);case"right":return"M ".concat(6," 0 h -").concat(6," V ").concat(f," h ").concat(6)}}(c),fill:"none",stroke:"currentColor"}),b.map((function(e){var t=e.formattedValue,n=e.value,r=e.offset;return Object(Fe.jsx)("g",{transform:p(c,r),children:Object(Fe.jsx)(g,{type:c,value:t})},n)})),s&&Object(Fe.jsx)("text",{dominantBaseline:function(e){switch(e){case"bottom":return"auto";case"left":case"top":case"right":return"hanging"}}(c),fontSize:15,textAnchor:"middle",transform:function(e){switch(e){case"bottom":return lt(Math.max.apply(Math,Object(xe.a)(a.range()))/2,i-3);case"top":return lt(Math.max.apply(Math,Object(xe.a)(a.range()))/2,-(i-3));case"left":return"".concat(lt(-(i-3),Math.max.apply(Math,Object(xe.a)(a.range()))/2),"rotate(270)");case"right":return"".concat(lt(i-3,Math.max.apply(Math,Object(xe.a)(a.range()))/2),"rotate(90)")}}(c),children:r})]})}));var lr=Object(O.a)((function(){return Object(Ge.a)({root:function(e){return{width:e.width,height:e.height}}})})),dr=Object(C.a)((function(e){var t=e.size,n=e.margin,r=void 0===n?30:n,c=e.view,a=t-2*Object(Hn.a)().spacing(1)-2,i=lr({height:a,width:900}),o=900-2*r,s=a-2*r,l=c.dimensions,u=Be().exploreStore,j=u.dataPoints,h=u.rangeMap,b=u.brushType,f=u.data,p=u.selectPointsFreeform,g=u.state.selections,O=ot(),x=function(e,t,n,r,c,a){var i=Object(d.useMemo)((function(){return Object(_.e)(t,[0+c/2,r-c/2])}),[t,r,c]),o=Object(d.useMemo)((function(){var e={};return t.forEach((function(t){if(a[t]){var r=a[t],c=r.min,i=r.max,o=Object(_.d)().domain([c,i]).range([0,n]).clamp(!0).nice();e[t]=o}else e[t]=Object(_.d)()})),e}),[t,a,n]);return{data:e,dimensions:t,attributeSpreadScale:i,attributeScales:o}}(j,l,s,o,40,h),m=x.attributeSpreadScale,v=x.attributeScales,y=Object(d.useCallback)((function(e,t,n){if(0!==e.length){var r=e.map((function(e){return"#mark".concat(e)})).join(","),a="Selection"===n;switch(t){case"Start":case"Brushing":Object(_.g)("#".concat(c.id)).selectAll(r).filter((function(){return Object(_.g)(this).classed(a?O.regularMark:O.unionMark)})).classed(O.intermittentHighlight,!0);break;case"End":Object(_.g)("#".concat(c.id)).selectAll(".marks").classed(O.intermittentHighlight,!1),p(e,c)}}}),[O,c,p]);if(!f)return Object(Fe.jsx)("div",{children:"Loading"});var w=f.columnInfo;return Object(Fe.jsx)("svg",{className:i.root,id:c.id,children:Object(Fe.jsxs)("g",{transform:lt(r),children:[j.map((function(e){var t,n=Object(_.b)(),r=l.map((function(t){return[m(t)||0,v[t](e[t])]}));return Object(Fe.jsx)("path",{className:Object(st.a)("marks",(t={},Object(B.a)(t,O.regularLine,!g.includes(e.id)),Object(B.a)(t,O.unionLine,g.includes(e.id)),t)),d:n(r)||"",fill:"none",id:"mark".concat(e.id),strokeWidth:"1"},e.id)})),l.map((function(e){var t=w[e],n=j.map((function(t){return{id:t.id,x:0,y:t[e]}}));return Object(Fe.jsxs)("g",{transform:lt(m(e)||0,0),children:["Rectangular"!==b&&"None"!==b&&Object(Fe.jsx)(ar,{bottom:s,brushSize:Se[b],data:n,left:0,right:40,top:0,xScale:function(e){return e},yScale:v[e],onBrush:y}),Object(Fe.jsx)(sr,{label:e,margin:0,scale:v[e],showLabel:!1,type:"left"}),Object(Fe.jsxs)("text",{textAnchor:"middle",transform:lt(0,s+20),children:[Object(Fe.jsx)("tspan",{children:t.fullname})," ",t.unit&&Object(Fe.jsxs)("tspan",{fontStyle:"italic",children:["(",t.unit,")"]})]}),j.sort((function(e,t){return(g.includes(e.id)?1:0)-(g.includes(t.id)?1:0)})).map((function(t){var n;return Object(Fe.jsx)("circle",{className:Object(st.a)("marks",(n={},Object(B.a)(n,O.regularMark,!g.includes(t.id)),Object(B.a)(n,O.unionMark,g.includes(t.id)),n)),cy:v[e](t[e]),id:"mark".concat(t.id),opacity:"0.5",r:"5"},t.id)}))]},e)}))]})})})),ur=Object(C.a)((function(e){var t=e.dataPoints,n=e.xScale,r=e.yScale,c=e.type,a=e.highlightMode,i=e.highlightPredicate,o=ot(),s=Be().exploreStore.changes,l=s.added,u=s.removed,j=s.updated,h=s.updateMap,b=s.results,f=Object(d.useMemo)((function(){var e={};return t.forEach((function(t){e[t.iid]=t})),e}),[t]),p=Object(d.useMemo)((function(){var e={};return h.forEach((function(t){var n=t.id,r=t.source,c=t.target;e[n]={source:f[r],target:f[c]}})),Object.values(e)}),[f,h]).map((function(e){var t=e.source,c=e.target,s=[o.movedLine];return b.includes(t.id)&&s.push(o.unionMark),a&&i&&(i(t)||s.push(o.forceDullMark)),Object(Fe.jsx)("path",{className:Object(st.a)(s),d:jr(n(t.x),n(c.x),r(t.y),r(c.y))},t.id)})),g=Object(d.useCallback)((function(e){var t=_.j,s=[],d=lt(n(e.x),r(e.y));return b.includes(e.id)&&s.push(o.unionMark),l.includes(e.id)?(s.push(o.newMark),t=_.o):u.includes(e.id)?(s.push(o.removedMark),t=_.k,d="".concat(d,"rotate(45)")):j.includes(e.id)?s.push(o.movedPoint):s.push(o.dullMark),a&&i&&(i(e)||s.push(o.forceDullMark)),Object(Fe.jsx)("path",{className:Object(st.a)(s),d:Object(_.i)().type(t).size("Regular"===c?80:100)()||"",id:"mark".concat(e.id),transform:d})}),[l,u,o,b,c,n,r,j,a,i]);return Object(Fe.jsxs)(Fe.Fragment,{children:[p,t.map((function(e){return Object(Fe.jsx)(Ke.a,{title:"Regular"===c?Object(Fe.jsx)(mn.a,{children:Object(Fe.jsx)("pre",{children:JSON.stringify(e,null,2)})}):"",children:g(e)},e.iid)}))]})}));function jr(e,t,n,r){var c=Math.atan((e-t)/(n-r)),a=4.5*Math.cos(c),i=4.5*Math.sin(c);return"M ".concat(t+a," ").concat(r-i," \n  L ").concat(e," ").concat(n," \n  L ").concat(t-a," ").concat(r+i,"\n  z")}function hr(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object(d.useMemo)((function(){var r=Object(_.d)().domain(e).range(t).clamp(!0);return n&&r.nice(),r}),[e,t,n]);return r}var br=Object(O.a)((function(){return Object(Ge.a)({base:{fill:"green",opacity:.1,stroke:"black",strokeWidth:2,cursor:"move","&:hover":{strokeWidth:5}},closeIconText:{fontWeight:"bolder",fontFamily:"FontAwesome",fontSize:"1.5rem",fill:"red"},closeIconBackground:{cursor:"pointer",fill:"#777",opacity:"0.1"},resizeBase:{pointerEvents:"all",fill:"none",stroke:"none"},ns:{cursor:"ns-resize"},ew:{cursor:"ew-resize"},nwse:{cursor:"nwse-resize"},nesw:{cursor:"nesw-resize"}})})),fr=function(e){var t=e.id,n=e.x,r=e.y,c=e.height,a=e.width,i=e.onMouseDown,o=e.onResizeStart,s=e.closeHandler,l=e.resizeHandlerSize,u=void 0===l?10:l,j=Object(d.useState)(!1),h=Object(g.a)(j,2),b=h[0],f=h[1],p=Object(d.useState)(-1),O=Object(g.a)(p,2),x=O[0],m=O[1],v=br(),y=v.base,w=v.resizeBase,k=v.ns,C=v.ew,S=v.nwse,M=v.nesw,N=v.closeIconText,A=v.closeIconBackground;Object(d.useEffect)((function(){return function(){return clearInterval(x)}}));var L=Object(Fe.jsx)("rect",{className:y,height:c,width:a,onMouseDown:function(e){i(e,t)},onMouseEnter:function(){clearInterval(x),f(!0)},onMouseLeave:function(){var e=setTimeout((function(){f(!1)}),900);m(e)}}),E=Object(Fe.jsx)("rect",{className:Object(st.a)(w,k),height:u,width:a-u,x:u/2,y:-u/2,onMouseDown:function(){return o(t,"N")}}),z=Object(Fe.jsx)("rect",{className:Object(st.a)(w,k),height:u,width:a-u,x:u/2,y:c-u/2,onMouseDown:function(){return o(t,"S")}}),P=Object(Fe.jsx)("rect",{className:Object(st.a)(w,C),height:c-u,width:u,x:-u/2,y:u/2,onMouseDown:function(){return o(t,"W")}}),W=Object(Fe.jsx)("rect",{className:Object(st.a)(w,C),height:c-u,width:u,x:a-u/2,y:u/2,onMouseDown:function(){return o(t,"E")}}),I=Object(Fe.jsx)("rect",{className:Object(st.a)(w,S),height:u,width:u,x:-u/2,y:-u/2,onMouseDown:function(){return o(t,"NW")}}),B=Object(Fe.jsx)("rect",{className:Object(st.a)(w,M),height:u,width:u,x:a-u/2,y:-u/2,onMouseDown:function(){return o(t,"NE")}}),T=Object(Fe.jsx)("rect",{className:Object(st.a)(w,M),height:u,width:u,x:-u/2,y:c-u/2,onMouseDown:function(){return o(t,"SW")}}),F=Object(Fe.jsx)("rect",{className:Object(st.a)(w,S),height:u,width:u,x:a-u/2,y:c-u/2,onMouseDown:function(){return o(t,"SE")}});return Object(Fe.jsxs)("g",{transform:lt(n,r),children:[L,E,z,P,W,I,B,T,F,Object(Fe.jsxs)("g",{display:b?"visible":"none",transform:lt(a,-10),children:[Object(Fe.jsx)("text",{className:N,dominantBaseline:"middle",dy:"1",textAnchor:"middle",children:"\uf05e"}),Object(Fe.jsx)("circle",{className:A,fill:"none",r:"10",stroke:"black",onClick:function(){return s(t)}})]})]})};var pr=function(e){var t=e.left,n=e.right,r=e.top,c=e.bottom,a=e.brushes,i=e.xScale,o=e.yScale,s=e.data,l=e.onBrushHandler,u=e.disableBrush,j=void 0!==u&&u,h=Object(d.useRef)(null),b=Object(d.useState)(!1),f=Object(g.a)(b,2),p=f[0],O=f[1],x=Object(d.useState)(!1),m=Object(g.a)(x,2),v=m[0],y=m[1],w=Object(d.useState)(!1),k=Object(g.a)(w,2),C=k[0],S=k[1],M=Object(d.useState)(null),N=Object(g.a)(M,2),L=N[0],E=N[1],z=Object(d.useState)(null),P=Object(g.a)(z,2),W=P[0],I=P[1],B=Object(d.useState)(null),T=Object(g.a)(B,2),F=T[0],R=T[1],D=[Math.abs(r-c),Math.abs(t-n)],G=D[0],H=D[1],J=Object(d.useMemo)((function(){var e=o.copy().domain(o.domain()).range(o.range()),t=function(e){return i(e)},n=function(t){return e(t)},r=function(e){return i.invert(e)},c=function(t){return e.invert(t)};return{dataX:r,dataY:c,pixelX:t,pixelY:n,extentToPixel:function(e){var r=e.x1,c=e.x2,a=e.y1,i=e.y2;return{x1:t(r),x2:t(c),y1:n(a),y2:n(i)}},extentToData:function(e){var t=e.x1,n=e.y1,a=e.x2,i=e.y2;return{x1:r(t),x2:r(a),y1:c(n),y2:c(i)}}}}),[i,o]),V=J.pixelX,U=J.pixelY,q=J.extentToData,$=J.extentToPixel,X=function(e,t,n,r){var c=e.left,a=e.top,i=e.right,o=e.bottom,s=Object(d.useMemo)((function(){return Object(_.c)().extent([[c-1,a-1],[i+1,o+1]]).x((function(e){return n(e.x)})).y((function(e){return r(e.y)})).addAll(t)}),[c,a,i,o,t,n,r]);return{search:function(e,t,c,a){var i=[];return s.visit((function(o,s,l,d,u){var j,h,b,f;if(h=[[s,l],[d,u]],!((j=[[e,t],[c,a]])[0][0]<=h[1][0]&&h[0][0]<=j[1][0]&&j[0][1]<=h[1][1]&&h[0][1]<=j[1][1]))return!0;if(!o.length){var p=o;do{var g=p.data;f=[n(g.x),r(g.y)],(b=[[e,t],[c,a]])[0][0]<=f[0]&&f[0]<=b[1][0]&&b[0][1]<=f[1]&&f[1]<=b[1][1]&&i.push(g.id)}while(p=p.next)}return!1})),i}}}({left:t,top:r,right:n,bottom:c},s,i,o).search,Y=Object(d.useCallback)((function(e,t,n){if(!j){var r={};Object.values(e).forEach((function(e){var t=e.extents,n=t.x1,c=t.x2,a=t.y1,i=t.y2,o=X(V(n),U(i),V(c),U(a));r[e.id]=o})),l(r,e,t,n)}}),[l,X,j,V,U]),Z=Object(d.useCallback)((function(e){if(!a[e])throw new Error("Brush does not exist");delete a[e],Y(Object(A.a)({},a),"Remove",e)}),[a,Y]),K=Object(d.useCallback)((function(e){var t=e.currentTarget.getBoundingClientRect(),n=q({x1:e.clientX-t.left,x2:e.clientX-t.left,y1:e.clientY-t.top,y2:e.clientY-t.top}),r={id:"brush".concat((new Date).getTime().toString()),extents:n};O(!0),I(r)}),[q]),Q=Object(d.useCallback)((function(e){var t=h.current;if(t&&W){var n=t.getBoundingClientRect(),r=n.left,c=n.top,a=$(W.extents),i=a.x1,o=a.y2,s=e.clientX-r,l=e.clientY-c;W.extents=q({x1:i,x2:s,y1:l,y2:o}),I(Object(A.a)({},W))}}),[W,q,$]),ee=Object(d.useCallback)((function(){if(W){var e=W.extents,t=e.x1,n=e.x2,r=e.y1,c=e.y2;if(!(Math.abs(t-n)<1e-5||Math.abs(r-c)<1e-5)){if(t>n){var i=[n,t];t=i[0],n=i[1]}if(r>c){var o=[c,r];r=o[0],c=o[1]}W.extents=gr({x1:t,x2:n,y1:r,y2:c}),a[W.id]=W,Y(Object(A.a)({},a),"Add",W.id)}I(null),O(!1)}}),[W,a,Y]),te=Object(d.useCallback)((function(e,t){var n=h.current;if(n&&!p){var r=a[t];if(!r)throw new Error("Something went wrong! Brush does not exist.");var c=n.getBoundingClientRect(),i=c.left,o=c.top,s=$(r.extents),l=s.x1,d=s.y2,u=e.clientX-i,j=e.clientY-o,b=[Math.abs(u-l),Math.abs(j-d)];R({x:b[0],y:b[1]}),I(r),y(!0)}}),[a,p,$]),ne=Object(d.useCallback)((function(e){var t=h.current;if(t&&W&&F){var n=$(W.extents),r=n.x1,c=n.x2,a=n.y1,i=n.y2,o=[Math.abs(i-a),Math.abs(c-r)],s=o[0],l=o[1],d=F.x,u=F.y,j=t.getBoundingClientRect(),b=j.left,f=j.top,p=e.clientX-b-d,g=e.clientY-f-u;p<0&&(p=0),p+l>H&&(p=H-l),g<0&&(g=0),g+s>G&&(g=G-s),r=p,c=p+l,i=g,a=g+s,I(Object(A.a)(Object(A.a)({},W),{},{extents:q({x1:r,x2:c,y1:a,y2:i})}))}}),[W,F,$,q,G,H]),re=Object(d.useCallback)((function(){W&&(a[W.id]=W,Y(Object(A.a)({},a),"Update",W.id),I(null),y(!1))}),[W,a,Y]),ce=Object(d.useCallback)((function(e,t){var n=a[e];if(!n)throw new Error("Something went wrong! Brush does not exist.");I(n),S(!0),E(t)}),[a]),ae=Object(d.useCallback)((function(e){var t=h.current;if(t&&W&&L){var n=t.getBoundingClientRect(),r=n.left,c=n.top,a=$(W.extents),i=a.x1,o=a.x2,s=a.y1,l=a.y2;switch(L){case"N":l=e.clientY-c;break;case"S":s=e.clientY-c;break;case"W":i=e.clientX-r;break;case"E":o=e.clientX-r;break;case"NW":i=e.clientX-r,l=e.clientY-c;break;case"NE":l=e.clientY-c,o=e.clientX-r;break;case"SW":i=e.clientX-r,s=e.clientY-c;break;case"SE":s=e.clientY-c,o=e.clientX-r;break;default:throw new Error("Wrong Resize Direction")}W.extents=q({x1:i,x2:o,y1:s,y2:l}),I(Object(A.a)({},W))}}),[W,L,$,q]),ie=Object(d.useCallback)((function(){W&&(W.extents=gr(W.extents),a[W.id]=W,Y(Object(A.a)({},a),"Update",W.id),I(null),E(null),S(!1))}),[W,a,Y]);Object(d.useEffect)((function(){if(p||v||C)return p&&(window.addEventListener("mousemove",Q),window.addEventListener("mouseup",ee)),v&&(window.addEventListener("mousemove",ne),window.addEventListener("mouseup",re)),C&&(window.addEventListener("mousemove",ae),window.addEventListener("mouseup",ie)),function(){p&&(window.removeEventListener("mousemove",Q),window.removeEventListener("mouseup",ee)),v&&(window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",re)),C&&(window.removeEventListener("mousemove",ae),window.removeEventListener("mouseup",ie))}}),[p,Q,ee,v,ne,re,C,ie,ae]);var oe=Object(d.useCallback)((function(){if(!W)return Object(Fe.jsx)("g",{});var e=gr($(W.extents)),t=e.x1,n=e.x2,r=e.y1,c=e.y2;return Object(Fe.jsx)(fr,{closeHandler:Z,height:c-r,id:W.id,width:n-t,x:t,y:r,onMouseDown:te,onResizeStart:ce})}),[W,te,ce,Z,$]),se=Object(Fe.jsx)("rect",{ref:h,cursor:j?"default":"crosshair",fill:"none",height:G,pointerEvents:j?"none":"all",width:H,onMouseDown:K}),le=Object.values(a);W&&(le=le.filter((function(e){return e.id!==W.id})));var de=Object(Fe.jsxs)("g",{children:[oe(),Object.values(le).map((function(e){var t=$(e.extents),n=t.x1,r=t.x2,c=t.y1,a=t.y2;return Object(Fe.jsx)(fr,{closeHandler:Z,height:c-a,id:e.id,width:r-n,x:n,y:a,onMouseDown:te,onResizeStart:ce},e.id)}))]}),ue=p?[de,se]:[se,de],je=Object(g.a)(ue,2),he=je[0],be=je[1];return Object(Fe.jsxs)("g",{id:"brush-component",children:[he,be]})};function gr(e){var t=e.x1,n=e.x2,r=e.y1,c=e.y2;if(n<t){var a=[n,t];t=a[0],n=a[1]}if(c<r){var i=[c,r];r=i[0],c=i[1]}return{x1:t,x2:n,y1:r,y2:c}}var Or=Object(C.a)((function(e){var t=e.offset,n=void 0===t?0:t;return Object(Fe.jsxs)("g",{transform:lt(n,-10),children:[Object(Fe.jsxs)("g",{transform:lt(0,20),children:[Object(Fe.jsx)("circle",{fill:rt,r:"5"}),Object(Fe.jsx)("text",{dominantBaseline:"middle",dx:"10",children:"Matches"})]}),Object(Fe.jsxs)("g",{transform:lt(0,40),children:[Object(Fe.jsx)("circle",{fill:ct,r:"5"}),Object(Fe.jsx)("text",{dominantBaseline:"middle",dx:"10",children:"Not Selected"})]}),Object(Fe.jsxs)("g",{transform:lt(0,60),children:[Object(Fe.jsx)("circle",{fill:at,r:"5"}),Object(Fe.jsx)("text",{dominantBaseline:"middle",dx:"10",children:"Not Predicted"})]})]})})),xr=Object(C.a)((function(e){var t=e.datapoints,n=e.freeformSelections,r=e.brushSelections,c=e.xScale,a=e.yScale,i=e.symbolMap,o=e.type,s=void 0===o?"Regular":o,l=e.highlightMode,u=void 0!==l&&l,j=e.highlightPredicate,h=void 0===j?null:j,b=e.colorPredicate,f=void 0===b?null:b,p=ot(),g=Be().exploreStore,O=g.showLabelLayer,x=g.setHighlightMode,m=g.setHighlightPredicate,v=g.state,y=(Object(d.useContext)(bn)||{}).labelMap,w=void 0===y?{}:y,k=Object(d.useMemo)((function(){var e=Object(xe.a)(n);return Object.values(r).forEach((function(t){return e.push.apply(e,Object(xe.a)(t))})),Object(xe.a)(new Set(e))}),[n,r]),C=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NA",r=null!==f?f(e):"";return Object(st.a)("marks",(t={},Object(B.a)(t,p.unionMark,k.includes(e.id)),Object(B.a)(t,p.regularMark,!k.includes(e.id)),Object(B.a)(t,p.dullMark,u&&null!==h&&!h(e)),Object(B.a)(t,n,"NA"!==n),Object(B.a)(t,r,null!==f),t))},S=function(e,t){var n={};return"Aggregate"===s&&(n.onMouseEnter=function(){x(!0),m((function(t){return v.aggregates[e.id].values.includes(t.id)}))},n.onMouseLeave=function(){x(!1),m(null)}),i?Object(Fe.jsx)("path",Object(A.a)({className:C(e,t),d:Object(_.i)(i[e.category||"-"]).size("Aggregate"===s?100:80)()||"",id:"mark".concat(e.id),opacity:"0.5",transform:lt(c(e.x),a(e.y))},n)):Object(Fe.jsx)("circle",Object(A.a)({className:C(e,t),cx:c(e.x),cy:a(e.y),id:"mark".concat(e.id),opacity:"0.5",r:"Aggregate"===s?10:5},n))};return Object(Fe.jsx)(Fe.Fragment,{children:t.map((function(e){var t=(e.customlabel||[])[0],n="NA";return O&&(n=w[t]),Object(Fe.jsx)(Ke.a,{title:"Regular"===s?Object(Fe.jsx)(mn.a,{children:Object(Fe.jsx)("pre",{children:JSON.stringify(e,null,2)})}):"",children:S(e,n)},e.id)}))})})),mr=function(){return Object(Fe.jsx)("defs",{children:Object(Fe.jsx)("pattern",{height:"4",id:"pattern",patternTransform:"rotate(45)",patternUnits:"userSpaceOnUse",width:"4",children:Object(Fe.jsx)("rect",{fill:"black",height:"4",opacity:"0.5",transform:"translate(0,0)",width:"2"})})})},vr=Object(O.a)((function(){return{lineBase:{strokeWidth:2,strokeOpacity:.3},line:{stroke:"black"},hatch:{strokeWidth:5,stroke:"url(#pattern)"}}})),yr=Object(C.a)((function(e){var t=e.info,n=e.xScale,r=e.yScale,c=vr(),a=t.frontier,i=Object(g.a)(t.sense,2),o=i[0],s=i[1],l=Object(d.useMemo)((function(){return{scaled_frontier:a.map((function(e){return{x:n(e[0]),y:r(e[1])}}))}}),[n,r,a]).scaled_frontier,u=Object(d.useMemo)((function(){return{x_lines:Object(Fe.jsx)("g",{className:"frontier-x",children:Object(xe.a)(l).sort((function(e,t){return"max"===o?e.x-t.x:t.x-e.x})).map((function(e,t,r){var a="".concat(e.x,"-").concat(e.y),i=0,s=0,l=0,u=0;0===t?(i="max"===o?n.range()[0]:e.x,s="max"===o?e.x:n.range()[1],l=e.y,u=e.y):(i=r[t-1].x,s=e.x,l=e.y,u=e.y);return Object(Fe.jsxs)(d.Fragment,{children:[Object(Fe.jsx)("line",{className:Object(st.a)(c.lineBase,c.line),x1:i,x2:s,y1:l,y2:u}),Object(Fe.jsx)("line",{className:Object(st.a)(c.lineBase,c.hatch),transform:lt(0,5),x1:i,x2:s,y1:l,y2:u})]},a)}))}),y_lines:Object(Fe.jsx)("g",{children:Object(xe.a)(l).sort((function(e,t){return"max"===s?e.y-t.y:t.y-e.y})).map((function(e,t,n){var a="".concat(e.x,"-").concat(e.y),i=0,o=0,l=0,u=0;if(t===n.length-1)i=e.x,o=e.x,l="max"===s?e.y:r.range()[1],u="max"===s?r.range()[0]:e.y;else{var j=n[t+1];i=e.x,o=e.x,l=e.y,u=j.y}return Object(Fe.jsxs)(d.Fragment,{children:[Object(Fe.jsx)("line",{className:Object(st.a)(c.lineBase,c.line),x1:i,x2:o,y1:l,y2:u}),Object(Fe.jsx)("line",{className:Object(st.a)(c.lineBase,c.hatch),transform:lt(-5,0),x1:i,x2:o,y1:l,y2:u})]},a)}))})}}),[l,o,s,n,r,c]),j=u.x_lines,h=u.y_lines;return Object(Fe.jsxs)("g",{children:[Object(Fe.jsx)(mr,{}),j,h]})})),wr=Object(C.a)((function(e){var t=e.xScale,n=e.yScale,r=Be().exploreStore,c=r.hoveredPrediction,a=r.dataPoints,i=Object(_.b)().x((function(e){return t(e[0])})).y((function(e){return n(e[1])}));if(c)switch(c.intent){case"Cluster":var o=c.info.hull,s=void 0===o?[]:o;if(s.length>0)return Object(Fe.jsx)("g",{children:Object(Fe.jsx)("path",{d:"".concat(i(s)," Z")||!1,fill:"gray",opacity:"0.4",stroke:"black"})});break;case"Multivariate Optimization":var l=c.info.edges,d=void 0===l?[]:l,u=c.dimensions,j={sense:c.params.sense,frontier:a.filter((function(e){return d.includes(e.id)})).map((function(e){return[e[u[0]],e[u[1]]]}))};return Object(Fe.jsx)(yr,{info:j,xScale:t,yScale:n})}return Object(Fe.jsx)(Fe.Fragment,{})})),kr=Object(O.a)((function(){return Object(Ge.a)({root:function(e){return{width:e.dimension,height:e.dimension}}})})),Cr=Object(C.a)((function(e){var t=e.view,n=e.size,r=e.margin,c=void 0===r?0:r,a=e.xAxisLabel,i=e.yAxisLabel,o=e.brushType,s=e.points,l=e.freeformBrushHandler,u=e.aggregatePoints,j=e.showCategories,h=e.categoryMap,b=void 0===h?null:h,f=e.rectangularBrushHandler,p=e.selections,g=e._x_extents,O=void 0===g?null:g,x=e._y_extents,m=void 0===x?null:x,v=n-2*Object(Hn.a)().spacing(1)-2,y=v-2*c,w=kr({dimension:v}),k=ot(),C=Be().exploreStore,S=C.highlightMode,M=C.highlightPredicate,N=C.colorPredicate,A=C.showMatchesLegend,L=C.compareMode,E=Object(d.useMemo)((function(){return null!==O&&null!==m?{x_extents:O,y_extents:m}:0===s.length?{x_extents:[0,0],y_extents:[0,0]}:{x_extents:Object(_.a)(s.map((function(e){return e.x}))),y_extents:Object(_.a)(s.map((function(e){return e.y})))}}),[s,O,m]),z=E.x_extents,P=E.y_extents,W=hr(z,[0,y]),I=hr(P,[y,0]),B=Object(d.useCallback)((function(e,n,r){if(0!==e.length){var c=e.map((function(e){return"#mark".concat(e)})).join(","),a="Selection"===r;switch(n){case"Start":case"Brushing":Object(_.g)("#".concat(t.id)).selectAll(c).filter((function(){return Object(_.g)(this).classed(a?k.regularMark:k.unionMark)})).classed(k.intermittentHighlight,!0);break;case"End":Object(_.g)("#".concat(t.id)).selectAll(".marks").classed(k.intermittentHighlight,!1),l(e,t,r)}}}),[k,l,t]),T=Object(d.useCallback)((function(e,n,r,c){f(t,n,r,c)}),[f,t]);if(j&&!b)throw new Error("Categories not defined");return Object(Fe.jsxs)("svg",{className:w.root,id:t.id,children:[Object(Fe.jsx)("defs",{children:Object(Fe.jsx)("clipPath",{id:"clip",width:y,children:Object(Fe.jsx)("rect",{fill:"none",height:y,width:y})})}),Object(Fe.jsxs)("g",{transform:lt(c),children:[A&&Object(Fe.jsx)(Or,{offset:y-25}),Object(Fe.jsx)(pr,{bottom:y,brushes:t.brushes,data:s,disableBrush:"Rectangular"!==o,left:0,right:y,top:0,xScale:W,yScale:I,onBrushHandler:T}),"Rectangular"!==o&&"None"!==o&&Object(Fe.jsx)(ar,{bottom:y,brushSize:Se[o],data:s,left:0,right:y,top:0,xScale:W,yScale:I,onBrush:B}),Object(Fe.jsx)(sr,{label:"function"===typeof a?a(t.x):a,margin:c,scale:W,transform:lt(0,y),type:"bottom"}),Object(Fe.jsx)(sr,{label:"function"===typeof i?i(t.y):i,margin:c,scale:I,transform:lt(0),type:"left"}),Object(Fe.jsx)(xr,{brushSelections:{},datapoints:u,freeformSelections:[],highlightMode:S,highlightPredicate:function(){return!1},symbolMap:null,type:"Aggregate",xScale:W,yScale:I}),L?Object(Fe.jsx)(ur,{dataPoints:s,highlightMode:S,highlightPredicate:M,type:"Regular",xScale:W,yScale:I}):Object(Fe.jsx)(xr,{brushSelections:t.brushSelections,colorPredicate:N,datapoints:s,freeformSelections:p,highlightMode:S,highlightPredicate:M,symbolMap:j?b:null,xScale:W,yScale:I}),Object(Fe.jsx)(wr,{xScale:W,yScale:I})]})]})})),Sr=Object(O.a)((function(e){return Object(Ge.a)({root:function(){return{width:"100%",height:"100%",display:"grid",overflow:"hidden",gridTemplateRows:"min-content min-content auto",gridTemplateAreas:"'version' 'compare' 'vis'"}},chips:{gridArea:"version",display:"flex",justifyContent:"center",flexWrap:"wrap","& > *":{margin:e.spacing(.5)}},compare:{gridArea:"compare",display:"flex",justifyContent:"center",flexDirection:"row"},speedDial:{position:"absolute",bottom:e.spacing(2),left:e.spacing(2)},vis:{gridArea:"vis",display:"flex",gap:e.spacing(2),flexFlow:"column",overlfow:"auto",justifyContent:"center",alignItems:"center"},paperContainer:{height:"min-content"},paper:function(){return{position:"relative",display:"flex",justifyContent:"center",alignContent:"center",padding:e.spacing(1)}},visContainer:{overflow:"auto",padding:"1em"},closeIcon:{position:"absolute",left:0,top:0},sidePanel:{gridArea:"side",minWidth:"200px"}})})),Mr=Object(C.a)((function(){var e=Object(d.useState)(!1),t=Object(g.a)(e,2),n=t[0],r=t[1],c=Be(),a=c.projectStore,i=a.project,o=a.dataset_id,s=a.setDatasetId,l=c.exploreStore,u=l.state,j=u.scatterplots,h=u.freeformSelections,b=u.pcps,f=l.selectPointsFreeform,p=l.compareTarget,O=l.changes,x=O.updated,m=O.added,v=O.removed,y=l.setCompareTarget,w=l.brushType,k=l.compareData,C=l.showGlobalScale,S=l.setShowGlobalScale,L=l.dataPoints,E=l.aggregateDataPoints,z=l.unselectPointsFreeform,P=l.setHighlightMode,W=l.setHighlightPredicate,I=l.compareMode,B=l.switchCompareMode,T=l.removeScatterplot,F=l.handleBrushSelection,R=l.data,D=l.rangeMap,G=Object(Hn.a)(),H=j.length+1,J=Object(d.useContext)(bn)||{},V=J.showCategory,U=void 0!==V&&V,q=J.selectedCategoryColumn,$=void 0===q?null:q,X=J.categoryMap,Y=void 0===X?{}:X,Z=Object(d.useState)(!1),K=Object(g.a)(Z,2),Q=K[0],ee=K[1],te=ot(),ne=Sr({dimension:500,showCategory:U}),re=Object(d.useCallback)((function(e){if(!R)return"";var t=R.columnInfo[e];return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)("tspan",{fontWeight:"bold",children:t.short})," ",Object(Fe.jsx)("tspan",{children:"|"})," ",Object(Fe.jsx)("tspan",{children:t.fullname})," ",t.unit&&Object(Fe.jsxs)("tspan",{fontStyle:"italic",children:["(",t.unit,")"]})]})}),[R]);if(!i)return Object(Fe.jsx)("div",{children:"Something went wrong!"});if(!R)return Object(Fe.jsx)("div",{children:"Loading"});var ce=b.map((function(e){return Object(Fe.jsx)("div",{className:ne.paperContainer,children:Object(Fe.jsx)(Jn.a,{className:ne.paper,children:Object(Fe.jsx)(dr,{size:500-2*G.spacing(1),view:e})})},e.id)})),ae=j.map((function(e){var t=e.x,n=e.y,r=[],c=[];if(R){var a=I?k.data:L;c=(I?[]:E).map((function(e){var r=U&&$?e[$]:"-";return e.customCategoryAssignment&&(r=e.customCategoryAssignment),Object(A.a)({x:e[t],y:e[n],label:e[R.labelColumn],category:r},e)})),r=a.map((function(e){var r=U&&$?e[$]:"-";return e.customCategoryAssignment&&(r=e.customCategoryAssignment),Object(A.a)({x:e[t],y:e[n],label:e[R.labelColumn],category:r},e)}))}var i=D[t],o=D[n];return Object(Fe.jsx)("div",{className:ne.paperContainer,children:Object(Fe.jsxs)(Jn.a,{className:ne.paper,elevation:3,children:[H>1&&Object(Fe.jsx)(Ze.a,{className:ne.closeIcon,onClick:function(){return T(e.id)},children:Object(Fe.jsx)(Zn.a,{})}),Object(Fe.jsx)(Cr,{_x_extents:[i.min,i.max],_y_extents:[o.min,o.max],aggregatePoints:c,brushType:w,categoryMap:Y,freeformBrushHandler:function(e,t,n){"Selection"===n?f(e,t):z(e,t)},margin:60,points:r,rectangularBrushHandler:F,selections:h,showCategories:U,size:500-2*G.spacing(1),view:e,xAxisLabel:re,yAxisLabel:re})]})},e.id)}));return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsxs)("div",{className:ne.root,children:[Object(Fe.jsxs)("div",{className:ne.chips,children:[i.datasets.map((function(e){return Object(Fe.jsx)(Vn.a,{color:o===e.id?"primary":I&&p===e.id?"secondary":"default",disabled:I&&e.id===o,label:e.version,onClick:function(){I?y(e.id):s(e.id)}},e.id)})),Object(Fe.jsx)(M.a,{control:Object(Fe.jsx)(N.a,{onChange:function(){return B(!I)}}),label:"Compare"})]}),Object(Fe.jsx)("div",{className:ne.compare,children:I&&Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(pn,{label:"Added",path:Object(_.i)().type(_.o).size(100)()||"",onMouseEnter:function(){P(!0),W((function(e){return m.includes(e.id)}))},onMouseLeave:function(){P(!1),W(null)}}),Object(Fe.jsx)(pn,{label:"Removed",path:Object(_.i)().type(_.k).size(100)()||"",transform:"rotate(45)",onMouseEnter:function(){P(!0),W((function(e){return v.includes(e.id)}))},onMouseLeave:function(){P(!1),W(null)}}),Object(Fe.jsx)(pn,{label:"Updated",shape:Object(Fe.jsxs)("g",{transform:lt(5,10),children:[Object(Fe.jsx)("path",{className:te.movedLine,d:jr(0,15,0,0)}),Object(Fe.jsx)("circle",{className:te.movedPoint,r:"4"}),Object(Fe.jsx)("circle",{className:te.movedPoint,r:"4",transform:lt(15,0)})]}),width:"40",onMouseEnter:function(){P(!0),W((function(e){return x.includes(e.id)}))},onMouseLeave:function(){P(!1),W(null)}})]})}),Object(Fe.jsx)("div",{className:ne.visContainer,children:Object(Fe.jsxs)("div",{className:ne.vis,children:[ce,ae]})})]}),Object(Fe.jsxs)(Kn.a,{ariaLabel:"SpeedDial example",className:ne.speedDial,icon:Object(Fe.jsx)(Qn.a,{}),open:n,onClose:function(){return r(!1)},onOpen:function(){return r(!0)},children:[Object(Fe.jsx)(er.a,{icon:Object(Fe.jsx)(qn.a,{}),tooltipPlacement:"right",tooltipTitle:"Add",tooltipOpen:!0,onClick:function(){return ee(!0)}}),Object(Fe.jsx)(er.a,{icon:Object(Fe.jsx)(Xn.a,{}),tooltipPlacement:"right",tooltipTitle:C?"Fit":"Global",tooltipOpen:!0,onClick:function(){return S(!C)}})]}),Object(Fe.jsx)(nr,{show:Q,onClose:function(){return ee(!1)}})]})})),Nr=n(636),Ar=n(637),Lr=n(638),Er=n(639),zr=n(640),Pr=n(641),Wr=n(642),Ir=n(643),Br=Object(O.a)((function(e){return Object(Ge.a)({root:{minWidth:400,display:"grid",gridTemplateRows:"min-content min-content 1fr",overflow:"auto"},center:{margin:"0 auto"},list:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,padding:e.spacing(1)},card:{minWidth:400},margin:{margin:e.spacing(1)}})})),Tr=Object(C.a)((function(){var e=Br(),t=Be().exploreStore.workflow,n=Object(p.g)(),r=t||{},c=r.customWorkflows,a=void 0===c?{}:c,i=r.setCurrentWorkflow,o=Object(d.useMemo)((function(){return Object.values(a)}),[a]);return Object(Fe.jsxs)("div",{className:e.root,children:[Object(Fe.jsx)("div",{className:e.center,children:Object(Fe.jsx)(qe.a,{variant:"h4",children:"Workflows"})}),Object(Fe.jsx)("div",{className:e.list,children:o.map((function(t){return Object(Fe.jsxs)(Xt.a,{className:e.card,raised:!0,children:[Object(Fe.jsx)(Yt.a,{action:Object(Fe.jsxs)(Nr.a,{children:[Object(Fe.jsx)(un.a,{onClick:function(){n.push({pathname:"/explore",search:"?workflow=".concat(t.id)})},children:"Load"}),Object(Fe.jsx)(un.a,{onClick:function(){i&&i(t.id)},children:"Edit"})]}),title:t.name}),Object(Fe.jsx)(Ar.a,{}),Object(Fe.jsx)(Zt.a,{children:Object(Fe.jsx)(Lr.a,{align:"alternate",children:(t.order||[]).map((function(e,n){var r=t.graph.nodes[e];return Object(Fe.jsxs)(Er.a,{children:[Object(Fe.jsxs)(zr.a,{children:[Object(Fe.jsx)(Pr.a,{color:"primary"}),n!==t.order.length-1&&Object(Fe.jsx)(Wr.a,{})]}),Object(Fe.jsx)(Ir.a,{children:r.label})]},r.id)}))})})]},t.id)}))})]})})),Fr=n(561),_r=n(333),Rr=n.n(_r),Dr=n(332),Gr=n.n(Dr),Hr=n(644),Jr=Object(O.a)((function(e){return Object(Ge.a)({root:{minWidth:450,display:"grid",gridTemplateRows:"min-content min-content 1fr"},add:{margin:"0 auto"},margin:{margin:e.spacing(1)},icon:{margin:e.spacing(2)}})})),Vr=Object(C.a)((function(){var e=Jr(),t=Be().exploreStore.workflow,n=Object(d.useState)(""),r=Object(g.a)(n,2),c=r[0],a=r[1];if(!t)return Object(Fe.jsx)("div",{children:"Error"});var i=t.setCurrentWorkflow,o=t.currentWorkflow,s=t.setWorkflowName,l=t.removeFromWorkflow,u=t.isSyncing,j=t.toggleSync,h=(null===o||void 0===o?void 0:o.order)||[];return Object(Fe.jsxs)("div",{className:e.root,children:[Object(Fe.jsx)("div",{className:e.add,children:o?Object(Fe.jsxs)("div",{className:e.margin,children:[Object(Fe.jsxs)(un.a,{color:"primary",disabled:!o.name,variant:"contained",onClick:j,children:["Syncing"===u?"Stop":"Start"," Sync"]}),Object(Fe.jsxs)(Ze.a,{disableFocusRipple:!0,disableRipple:!0,children:["Not Syncing"===u&&Object(Fe.jsx)(Gr.a,{}),"Syncing"===u&&Object(Fe.jsx)(Rr.a,{})]})]}):Object(Fe.jsx)(un.a,{disabled:Boolean(o),onClick:function(){i()},children:"Create New Workflow"})}),o&&""===o.name&&Object(Fe.jsxs)("div",{className:e.add,children:[Object(Fe.jsx)(Fr.a,{placeholder:"Workflow Name",value:c,onChange:function(e){return a(e.target.value)}}),Object(Fe.jsx)(Ze.a,{disabled:""===c,onClick:function(){return s(c)},children:Object(Fe.jsx)(Mn.a,{})})]}),o&&""!==o.name&&Object(Fe.jsx)("div",{className:e.add,children:Object(Fe.jsx)(qe.a,{variant:"button",children:o.name})}),o&&o.graph&&Object(Fe.jsx)("div",{children:Object(Fe.jsx)(Lr.a,{children:h.map((function(e,t){var n,r=null===(n=o.graph)||void 0===n?void 0:n.nodes[e];return r?Object(Fe.jsxs)(Er.a,{children:[Object(Fe.jsx)(Hr.a,{children:Object(Fe.jsx)(Ze.a,{color:"secondary",size:"small",onClick:function(){return l(r.id)},children:Object(Fe.jsx)(Zn.a,{})})}),Object(Fe.jsxs)(zr.a,{children:[Object(Fe.jsx)(Pr.a,{color:"primary"}),t!==h.length-1&&Object(Fe.jsx)(Wr.a,{})]}),Object(Fe.jsx)(Ir.a,{children:r.label})]},r.id):null}))})}),!o&&Object(Fe.jsx)("div",{className:e.add,children:Object(Fe.jsx)(qe.a,{variant:"button",children:"No custom workflow to edit"})})]})})),Ur=Object(O.a)((function(e){return Object(Ge.a)({root:{minWidth:"500px",display:"grid",gridTemplateColumns:"min-content 1fr 1fr",margin:e.spacing(1),overflow:"hidden"}})})),qr=Object(C.a)((function(){var e=Ur();return Object(Fe.jsxs)("div",{className:e.root,children:[Object(Fe.jsx)("div",{children:Object(Fe.jsx)($t,{})}),Object(Fe.jsx)(Vr,{}),Object(Fe.jsx)(Tr,{})]})}));var $r=function(){var e=Object(d.useState)(null),t=Object(g.a)(e,2),n=t[0],r=t[1],c=Object(p.h)(),a=Object(p.g)(),i=new URLSearchParams(c.search).get("workflow");return Object(d.useEffect)((function(){var e=i||Date.now().toString();n!==e&&(r(e),a.replace({search:"?workflow=".concat(e)}))}),[i,n,a]),{history:a,location:c,workflowId:n}},Xr=Object(O.a)((function(e){var t={};return _.f.forEach((function(e){t[e]={fill:e}})),Object(Ge.a)(Object(A.a)({root:{display:"grid",gridTemplateColumns:"min-content 5fr 2fr 1fr",height:"100vh",width:"100vw",overflow:"hidden"},workflowButton:{position:"absolute",right:e.spacing(2),bottom:e.spacing(16),"z-index":1e5},subroot:{overflow:"hidden"},drawer:{overflow:"hidden"}},t))})),Yr=Object(C.a)((function(){var e=Xr(),t=Be(),n=t.projectStore.dataset_id,r=t.exploreStore,c=r.addScatterplot,a=r.addPCP,i=r.data,o=r.workflow,s=r.provenance,l=r.loadWorkflow,u=r.showCategories,j=r.selectedCategoryColumn,h=r.changeCategoryColumn,b=r.state.labels,f=Object(d.useState)(null),p=Object(g.a)(f,2),O=p[0],m=p[1],v=Object(d.useState)(null),y=Object(g.a)(v,2),w=y[0],k=y[1],C=Object(d.useState)(!1),S=Object(g.a)(C,2),M=S[0],N=S[1],A=$r().workflowId,L=localStorage.getItem("aggOpt");Object(d.useEffect)((function(){A&&(o?o.id!==A&&l(A):l(A))}),[A,l,o]),Object(d.useEffect)((function(){JSON.stringify(w)!==L&&L&&k(JSON.parse(L))}),[w,L]),Object(d.useEffect)((function(){if(!j&&i&&i.categoricalColumns.length>0){var e=localStorage.getItem("category-column");h(e&&i.categoricalColumns.includes(e)?e:i.categoricalColumns[0])}}),[j,h,i]);var E=Object(d.useMemo)((function(){var e;return j&&(null===i||void 0===i||null===(e=i.columnInfo[j])||void 0===e?void 0:e.options)||[]}),[i,j]),z=Object(d.useMemo)((function(){var t={};return Object.keys(b).forEach((function(n,r){t[n]=e[_.f[r]]})),t}),[b,e]),P=Object(d.useMemo)((function(){if(E.length>_.q.length-1)throw new Error("Cannot support more categorical values than ".concat(_.q.length-1));var e={Unassigned:_.q[0]};return E.forEach((function(t,n){e[t]=_.q[n+1]})),e}),[E]);return Object(d.useEffect)((function(){null!==i&&"Root"===s.current.label&&c()}),[c,i,s,a]),n?Object(Fe.jsx)(Fe.Fragment,{children:Object(Fe.jsx)("div",{className:e.root,children:Object(Fe.jsxs)(bn.Provider,{value:{showCategory:u,selectedCategoryColumn:j,categoryMap:P,labelMap:z,hoveredCategory:O,setHoveredCategory:m,aggregateOptions:w,setAggregateOptions:k},children:[Object(Fe.jsx)(Gn,{}),Object(Fe.jsx)("div",{className:e.subroot,children:Object(Fe.jsx)(Mr,{})}),Object(Fe.jsx)(ht,{}),Object(Fe.jsx)("div",{children:Object(Fe.jsx)($t,{})}),!M&&Object(Fe.jsx)(x.a,{className:e.workflowButton,onClick:function(){return N(!0)},children:Object(Fe.jsx)(Ve.a,{})}),Object(Fe.jsx)(He.a,{anchor:"right",className:e.drawer,open:M,onClose:function(){return N(!1)},children:Object(Fe.jsx)(qr,{})})]})})}):A?Object(Fe.jsx)("div",{children:"Loading"}):Object(Fe.jsx)("div",{children:"Please go to projects"})})),Zr=n(659),Kr=n(335),Qr=Object(O.a)((function(){return Object(Ge.a)({root:{height:"100vh",width:"100%",display:"flex",flexDirection:"column"}})}));var ec=Object(C.a)((function(){var e=Qr(),t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:56,n=Object(d.useMemo)((function(){if(!e)return{rows:[],columns:[]};var t=e.columnInfo,n=e.columns,r=e.values,c=e.labelColumn;return{rows:r,columns:[c].concat(Object(xe.a)(n.filter((function(e){return e!==c})))).filter((function(e){return!["id","iid"].includes(e)})).map((function(e){return{field:e,headerName:t[e].fullname,description:t[e].unit||"",flex:1}}))}}),[e]),r=n.rows,c=void 0===r?[]:r,a=n.columns;return{rows:c,columns:void 0===a?[]:a,headerHeight:t}}(Be().projectStore.data,56),n=t.rows,r=t.columns;return Object(Fe.jsx)("div",{className:e.root,children:n.length>0&&r.length>0&&Object(Fe.jsx)(Kr.a,{columns:r,headerHeight:56,rows:n,autoPageSize:!0,pagination:!0})})})),tc=n(345),nc=n(336),rc=n.n(nc),cc=n(338),ac=n.n(cc),ic=n(337),oc=n.n(ic),sc=n(339),lc=n.n(sc),dc=n(645),uc=n(670),jc=Object(C.a)((function(e){var t=e.projects,n=function(e){return Object(O.a)((function(t){return Object(Ge.a)({root:{display:"flex"},appbar:{width:"calc(100% - ".concat(e,"px)"),marginLeft:e},drawer:{width:e,flexShrink:0},drawerPaper:{width:e},toolbar:Object(A.a)(Object(A.a)({},t.mixins.toolbar),{},{display:"flex",alignItems:"center",justifyContent:"center"})})}))()}(240),r=Be(),c=r.exploreStore.changeCategoryColumn,a=r.projectStore,i=a.setCurrentProject,o=a.setDatasetId,s=a.project,l=a.dataset_id,d=Object(p.g)();return Object(Fe.jsxs)(He.a,{className:n.drawer,classes:{paper:n.drawerPaper},variant:"permanent",children:[Object(Fe.jsx)("div",{className:n.toolbar,children:Object(Fe.jsx)(qe.a,{variant:"h4",children:"Projects"})}),Object(Fe.jsx)(Ar.a,{}),Object(Fe.jsx)(dc.a,{defaultCollapseIcon:Object(Fe.jsx)(rc.a,{}),defaultEndIcon:Object(Fe.jsx)("div",{style:{width:24}}),defaultExpandIcon:Object(Fe.jsx)(kn.a,{}),expanded:s?[s.id.toString()]:[],selected:l||"",children:t.map((function(e){return Object(Fe.jsx)(bc,{labelIcon:oc.a,labelText:e.name,nodeId:e.id,onClick:function(){i(e.id),c(null)},children:e.datasets.map((function(e){return Object(Fe.jsx)(bc,{labelIcon:ac.a,labelText:e.version,launchHandler:function(){d.push("/explore")},nodeId:e.id,showLaunch:!0,onClick:function(){o(e.id)}},e.id)}))},e.id)}))})]})})),hc=Object(O.a)((function(e){return{root:{color:e.palette.text.secondary,"&:hover > $content":{backgroundColor:e.palette.action.hover},"&:focus > $content, &$selected > $content":{backgroundColor:"var(--tree-view-bg-color, ".concat(e.palette.grey[400],")"),color:"var(--tree-view-color)"},"&:focus > $content $label, &:hover > $content $label, &$selected > $content $label":{backgroundColor:"transparent"}},content:{color:e.palette.text.secondary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"$expanded > &":{fontWeight:e.typography.fontWeightRegular}},group:{marginLeft:0,"& $content":{paddingLeft:e.spacing(2)}},expanded:{},selected:{},label:{fontWeight:"inherit",color:"inherit"},labelRoot:{display:"flex",alignItems:"center",padding:e.spacing(.5,0)},labelIcon:{marginRight:e.spacing(1)},labelText:{fontWeight:"inherit",flexGrow:1}}}));function bc(e){var t=hc(),n=e.labelText,r=e.labelIcon,c=e.labelInfo,a=e.color,i=e.bgColor,o=e.nodeId,s=e.onClick,l=e.showLaunch,d=void 0!==l&&l,u=e.launchHandler,j=Object(tc.a)(e,["labelText","labelIcon","labelInfo","color","bgColor","nodeId","onClick","showLaunch","launchHandler"]),h={"--tree-view-color":a,"--tree-view-bg-color":i};return Object(Fe.jsx)(uc.a,Object(A.a)({classes:{root:t.root,content:t.content,expanded:t.expanded,selected:t.selected,group:t.group,label:t.label},label:Object(Fe.jsxs)("div",{className:t.labelRoot,children:[Object(Fe.jsx)(r,{className:t.labelIcon,color:"inherit"}),Object(Fe.jsx)(qe.a,{className:t.labelText,variant:"body2",children:n}),Object(Fe.jsx)(qe.a,{color:"inherit",variant:"caption",children:c}),d&&Object(Fe.jsx)(Ze.a,{size:"small",onClick:function(e){u&&u(e)},children:Object(Fe.jsx)(lc.a,{})})]}),nodeId:o,style:h,onClick:s},j))}var fc=function(e){var t=e.condition,n=e.children,r=e.else,c=void 0===r?null:r;return t?Object(Fe.jsx)(Fe.Fragment,{children:n}):"function"===typeof c?c():c},pc=Object(d.memo)(fc),gc=function(){var e=Object(I.a)(W.a.mark((function e(){var t,n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.get("".concat(vc,"/all"));case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oc=Object(O.a)((function(){return Object(Ge.a)({root:{display:"flex"},project:{height:"100vh",width:"100%",display:"flex",flexDirection:"column"}})})),xc=Object(C.a)((function(){var e=Oc(),t=Be().projectStore,n=t.project,r=t.dataset_id,c=t.projects,a=t.setProjects,i=Object(Zr.a)("projects",gc),o=i.isLoading,s=i.isError,l=i.error,u=i.data,j=void 0===u?[]:u;return Object(d.useEffect)((function(){o||j.length>0&&0===Object.values(c).length&&a(j)}),[o,j]),o?Object(Fe.jsx)("div",{children:"Loading Projects"}):s&&l?Object(Fe.jsx)("div",{children:l.message}):Object(Fe.jsxs)("div",{className:e.root,children:[Object(Fe.jsx)(jc,{projects:j}),Object(Fe.jsx)(pc,{condition:Boolean(n&&r),children:Object(Fe.jsx)(ec,{})})]})})),mc="https://reusing.sci.utah.edu",vc="".concat(mc,"/project"),yc="".concat(mc,"/data"),wc="".concat(mc,"/predict"),kc="".concat(mc,"/compute"),Cc=Object(r.a)({uri:"https://reusing.sci.utah.edu/graphql/"}),Sc=new c.a({link:Cc,cache:new a.a,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0}});l()(u.a,{trackAllPureComponents:!0,exclude:[/XGrid|RowCells|GridCell/]});var Mc=function(){return Object(Fe.jsx)(i.a,{client:Sc,children:Object(Fe.jsx)(Ie.Provider,{value:Te,children:Object(Fe.jsx)(b.a,{client:Te.query,children:Object(Fe.jsx)(o.a,{children:Object(Fe.jsx)(De,{children:Object(Fe.jsx)(f.a,{children:Object(Fe.jsxs)(p.d,{children:[Object(Fe.jsx)(p.a,{from:"/",to:"/project",exact:!0}),Object(Fe.jsx)(p.b,{component:xc,path:"/project",exact:!0}),Object(Fe.jsx)(p.b,{component:Yr,path:"/explore",exact:!0})]})})})})})})})};h.a.render(Object(Fe.jsx)(Mc,{}),document.getElementById("root"))}},[[548,1,2]]]);
//# sourceMappingURL=main.a237cc3e.chunk.js.map